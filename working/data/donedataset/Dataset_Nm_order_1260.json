{
    "Link_API": "https://api.stackexchange.com/2.3/questions/26258",
    "Title": "The Laplace transform of the first hitting time of Brownian motion",
    "Score": 23,
    "Category": "Chứng minh",
    "Tags": "measure-theory, probability-theory, stochastic-processes, martingales, brownian-motion",
    "Link": "https://math.stackexchange.com/questions/26258/the-laplace-transform-of-the-first-hitting-time-of-brownian-motion",
    "Content": "Let $B_t$ be the standard Brownian motion process, $a > 0$ , and let $H_a = \\inf \\{ t : B_t > a \\}$ be a stopping time. I want to show that the Laplace transform of $H_a$ is $$\\mathbb{E}[\\exp(-\\lambda H_a)] = \\exp (-\\sqrt{2\\lambda} \\, a)$$ by considering the martingale $$M_t = \\exp \\left(\\theta B_t -\\frac{1}{2}\\theta^2 t\\right)$$ There's an obvious argument to follow here: assuming the optional stopping theorem applies, we have $$1 = \\mathbb{E}[M_{H_a}] = \\mathbb{E} \\left[ \\exp \\left(\\theta a - \\frac{1}{2}\\theta^2 H_a\\right) \\right] = \\exp(\\sqrt{2\\lambda} \\, a) \\mathbb{E} \\left[ \\exp(-\\lambda H_a) \\right]$$ where $\\theta = \\sqrt{2\\lambda}$ . This is exactly what we wished to show. However, as far as I can tell, the hypotheses of the optional stopping theorem are not satisfied here. Here is the statement I have: If $(X_n)$ is a martingale and $T$ is an a.s. bounded stopping time, then $\\mathbb{E}[X_T] = \\mathbb{E}[X_0]$ . I think not all is lost yet. $M_t > 0$ for all $t$ , so the martingale convergence theorem applies, and $M_t \\to M_\\infty$ a.s. for some integrable random variable $M_\\infty$ . For each $t$ , $H_a \\wedge t = \\min \\{ H_a, t \\}$ is a bounded stopping time, so certainly $\\mathbb{E}[M_{H_a \\wedge t}] = \\mathbb{E}[M_0]$ . But, $$\\mathbb{E}[M_{H_a \\wedge t}] = \\mathbb{E}[M_{H_a} \\mathbf{1}_{\\{H_a \\le t\\}}] + \\mathbb{E}[M_t \\mathbf{1}_{\\{H_a > t\\}}]$$ and clearly what one wants to do is to take $t \\to \\infty$ on both sides. But here's where I get stuck: I'm sure I need a convergence theorem here in order to conclude that the equation remains valid in the limit. Now, $0 < M_{H_a} = \\exp \\left(\\theta a - \\frac{1}{2} \\theta^2 H_a \\right) \\le \\exp(\\theta a)$ , so the dominated convergence theorem applies, and so $$\\lim_{t \\to \\infty} \\mathbb{E}[M_{H_a} \\mathbf{1}_{\\{H_a \\le t\\}}] = \\mathbb{E}[M_{H_a} \\mathbf{1}_{\\{H_a < \\infty\\}}]$$ and I believe Fatou's lemma gives me that $$\\liminf_{t \\to \\infty} \\mathbb{E}[M_t \\mathbf{1}_{\\{H_a > t\\}}] \\ge \\mathbb{E}[M_{\\infty} \\mathbf{1}_{\\{H_a = \\infty\\}}]$$ but I think what I need is the equality $$\\lim_{t \\to \\infty} \\mathbb{E}[M_t \\mathbf{1}_{\\{H_a > t\\}}] = \\mathbb{E}[M_\\infty \\mathbf{1}_{\\{H_a = \\infty\\}}]$$ and as far as I can tell neither the monotone convergence theorem nor the dominated convergence theorem applies here. Is there anything I can do to rescue this line of thought?",
    "AcceptedAnswer": "Use the fact that $0\\leqslant M_t\\mathbf{1}_{\\{H_a>t\\}}\\leqslant\\exp\\left(\\theta a−\\frac12\\theta^2t\\right)$.",
    "llm_answer_create_structured_problem": "###BEGIN_OF_FORMAT###\nassumption: \n$B_t$ is a standard Brownian motion,\n$a > 0$,\n$H_a = \\inf \\{ t : B_t > a \\}$ is a stopping time,\n$M_t = \\exp \\left( \\theta B_t - \\frac{1}{2} \\theta^2 t \\right)$ is a martingale,\n$\\theta = \\sqrt{2\\lambda}$,\nthe optional stopping theorem applies to bounded stopping times $H_a \\wedge t$,\n$H_a$ is almost surely finite.\nproblem: \nShow that the Laplace transform of $H_a$ is $$\\mathbb{E}[\\exp(-\\lambda H_a)] = \\exp(-\\sqrt{2\\lambda} \\, a)$$ using the martingale $M_t$.\n###",
    "reasoning_create_structured_problem": "Okay, let me try to work through this problem step by step. So, the user wants to show that the Laplace transform of the first hitting time H_a of Brownian motion is exp(-sqrt(2λ)a) using the given martingale M_t. They mentioned using the optional stopping theorem (OST), but there's a concern about whether the hypotheses of OST are satisfied here.\n\nFirst, let me recall what the problem is asking. The stopping time H_a is the first time the Brownian motion B_t exceeds level a. The Laplace transform E[exp(-λH_a)] is supposed to be exp(-sqrt(2λ)a). The approach uses the martingale M_t = exp(θB_t - ½θ²t). The user set θ = sqrt(2λ) and applied OST to get 1 = E[M_{H_a}], which gives the desired result. But the issue is whether OST applies here because H_a isn't necessarily a bounded stopping time.\n\nThe user then considers using H_a ∧ t, which is a bounded stopping time, and applies OST to that. Then, they split the expectation into two parts: one where H_a ≤ t and one where H_a > t. Taking the limit as t approaches infinity, they want to see if the expectations converge appropriately.\n\nFor the first part, E[M_{H_a} 1_{H_a ≤ t}], they use dominated convergence theorem (DCT) because M_{H_a} is bounded by exp(θa). That seems valid because the integrand is dominated by an integrable function (since exp(θa) is a constant here). So that part converges to E[M_{H_a} 1_{H_a < ∞}].\n\nThe problem arises with the second term, E[M_t 1_{H_a > t}]. They mention using Fatou's lemma, which gives a liminf ≥ E[M_∞ 1_{H_a = ∞}], but they need equality. The user is stuck here because neither monotone convergence theorem (MCT) nor DCT seems applicable.\n\nLet me think: M_t is a martingale that converges a.s. to M_∞, which is integrable. But what is M_∞? Since B_t is a Brownian motion, which is recurrent, H_a is finite almost surely, right? So the event {H_a = ∞} has probability zero. If that's the case, then 1_{H_a > t} tends to 1_{H_a = ∞} which is zero a.s. Therefore, the term E[M_t 1_{H_a > t}] should go to zero as t→infty. But why?\n\nWait, if H_a is a.s. finite, then as t→infty, 1_{H_a > t} → 0 a.s. Then, M_t 1_{H_a > t} → 0 a.s. If we can apply DCT here, then lim E[M_t 1_{H_a > t}] = E[0] = 0. But why can we apply DCT?\n\nWhat's the integrability condition here? Since M_t is a martingale with E[M_t] = 1 for all t. But M_t = exp(θB_t - ½θ²t). Since B_t ~ N(0,t), then θB_t - ½θ²t has mean -½θ²t + θ*0 = -½θ²t and variance θ²t. So M_t is log-normal. However, when H_a > t, B_t hasn't reached a yet. So B_t ≤ a. Wait, no: H_a is the first time B_t exceeds a. So on {H_a > t}, B_t ≤ a for all s ≤ t, but B_t could still be anything up to that. Wait, but for the term M_t 1_{H_a > t}, we have that B_t hasn't exceeded a by time t. But how does that affect M_t?\n\nBut maybe instead of looking at B_t, since H_a > t, B_t could still be below a. However, M_t is exp(θB_t - ½θ²t). If θ is positive, then B_t could be negative or positive. But since H_a is the first hitting time of a, which is positive, so before H_a, B_t is less than or equal to a. Wait, actually, standard Brownian motion can go negative. So even if H_a is the first time B_t exceeds a, B_t can be anywhere below a before that. So on {H_a > t}, B_t is ≤ a? No, actually, no. Because H_a is the first time B_t exceeds a. So before time H_a, B_t hasn't exceeded a yet. So at time t < H_a, B_t ≤ a. Wait, but that's not necessarily true. Because Brownian motion can go above a and then come back down. Wait, no: H_a is the first time it exceeds a. So before H_a, B_t has not exceeded a yet. So at any t < H_a, B_t ≤ a. Therefore, on {H_a > t}, B_t ≤ a.\n\nBut B_t can still be any value ≤ a. So M_t = exp(θB_t - ½θ²t) on {H_a > t} is exp(θB_t - ½θ²t) where B_t ≤ a. So θB_t ≤ θa. Therefore, M_t ≤ exp(θa - ½θ²t). Since θ and a are constants, as t→infty, this tends to zero because -½θ²t dominates. So M_t on {H_a > t} is bounded by exp(θa - ½θ²t), which is decreasing exponentially. Therefore, M_t 1_{H_a > t} is bounded by exp(θa - ½θ²t), which is integrable (since it's a constant times exp(-½θ²t)) and tends to zero. So maybe we can use DCT here? Because |M_t 1_{H_a > t}| ≤ exp(θa - ½θ²t), which is dominated by exp(θa) for all t. But exp(θa) is integrable over the probability space? Wait, the measure is probability, so integrating a constant over the space would just multiply by the probability of {H_a > t}. Wait, no. The dominating function would need to be independent of t and integrable. But exp(θa) is a constant, so if we can bound |M_t 1_{H_a > t}| ≤ exp(θa), then yes, since exp(θa) is integrable (as it's a constant and the total measure is 1). But wait, M_t 1_{H_a > t} = exp(θB_t - ½θ²t) 1_{H_a > t}. Since B_t ≤ a on {H_a > t}, then θB_t ≤ θa, so exp(θB_t - ½θ²t) ≤ exp(θa - ½θ²t). But this is not bounded by a constant independent of t because as t increases, exp(-½θ²t) tends to zero. However, if we take the supremum over t of exp(θa - ½θ²t), that's exp(θa) * exp(-½θ²*0) = exp(θa). So perhaps we can use exp(θa) as the dominating function. Since exp(θa) is a constant, integrable over the probability space (since the integral is exp(θa)*P(H_a > t), but P(H_a > t) ≤1). Therefore, the entire expression is dominated by exp(θa), which is integrable. Hence, by DCT, since M_t 1_{H_a > t} →0 a.s. (because H_a is finite a.s. and M_t converges to M_∞, but on H_a = ∞, which is measure zero, but even without that, as t→infty, on {H_a > t}, which is going to zero measure), so M_t 1_{H_a > t} →0 a.s., and dominated by exp(θa), so DCT applies, and the limit is zero.\n\nTherefore, the second term tends to zero. Hence, combining both terms, we have 1 = E[M_{H_a} 1_{H_a < ∞}] + 0. But since H_a is a.s. finite (because Brownian motion is recurrent), 1_{H_a < ∞} =1 a.s. Therefore, E[M_{H_a}] =1, which gives the desired result.\n\nSo the key points here are:\n\n1. H_a is finite almost surely for a standard Brownian motion, which is recurrent.\n2. On {H_a > t}, B_t ≤ a, so M_t is bounded by exp(θa - ½θ²t), which tends to zero as t→infty.\n3. The term E[M_t 1_{H_a > t}] can be handled by DCT because it's dominated by exp(θa) which is integrable over the probability space.\n4. Hence, the limit of E[M_t 1_{H_a > t}] as t→infty is zero.\n\nTherefore, the user's approach can be rescued by noting that H_a is a.s. finite and applying DCT to the second term.",
    "Original_Problem": "assumption: \n$B_t$ is a standard Brownian motion,\n$a > 0$,\n$H_a = \\inf \\{ t : B_t > a \\}$ is a stopping time,\n$M_t = \\exp \\left( \\theta B_t - \\frac{1}{2} \\theta^2 t \\right)$ is a martingale,\n$\\theta = \\sqrt{2\\lambda}$,\nthe optional stopping theorem applies to bounded stopping times $H_a \\wedge t$,\n$H_a$ is almost surely finite.\nproblem: \nShow that the Laplace transform of $H_a$ is $$\\mathbb{E}[\\exp(-\\lambda H_a)] = \\exp(-\\sqrt{2\\lambda} \\, a)$$ using the martingale $M_t$.",
    "Original_Problem_with_numerical_assumption": "Assumption:\nAssumption 1: $B_t$ is a standard Brownian motion,\nAssumption 2: $a > 0$,\nAssumption 3: $H_a = \\inf \\{ t : B_t > a \\}$ is a stopping time,\nAssumption 4: $M_t = \\exp \\left( \\theta B_t - \\frac{1}{2} \\theta^2 t \\right)$ is a martingale,\nAssumption 5: $\\theta = \\sqrt{2\\lambda}$,\nAssumption 6: the optional stopping theorem applies to bounded stopping times $H_a \\wedge t$,\nAssumption 7: $H_a$ is almost surely finite.\nProblem: \nShow that the Laplace transform of $H_a$ is $$\\mathbb{E}[\\exp(-\\lambda H_a)] = \\exp(-\\sqrt{2\\lambda} \\, a)$$ using the martingale $M_t$.",
    "Proof_problem": "Yes",
    "Redundant_assumption": "$0\\leqslant M_t\\mathbf{1}_{\\{H_a>t\\}}\\leqslant\\exp\\left(\\theta a−\\frac12\\theta^2t\\right)$",
    "Problem_with_redundant_assumption": "Assumption:\nAssumption 1: $B_t$ is a standard Brownian motion,\nAssumption 2: $a > 0$,\nAssumption 3: $H_a = \\inf \\{ t : B_t > a \\}$ is a stopping time,\nAssumption 4: $M_t = \\exp \\left( \\theta B_t - \\frac{1}{2} \\theta^2 t \\right)$ is a martingale,\nAssumption 5: $\\theta = \\sqrt{2\\lambda}$,\nAssumption 6: the optional stopping theorem applies to bounded stopping times $H_a \\wedge t$,\nAssumption 7: $H_a$ is almost surely finite.\nAssumption 8: $0\\leqslant M_t\\mathbf{1}_{\\{H_a>t\\}}\\leqslant\\exp\\left(\\theta a−\\frac12\\theta^2t\\right)$\nProblem: \nShow that the Laplace transform of $H_a$ is $$\\mathbb{E}[\\exp(-\\lambda H_a)] = \\exp(-\\sqrt{2\\lambda} \\, a)$$ using the martingale $M_t$."
}