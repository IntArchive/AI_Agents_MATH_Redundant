{
    "Link_API": "https://api.stackexchange.com/2.3/questions/284288",
    "Title": "Problem of limit with binomial coefficients",
    "Score": 12,
    "Category": "Chứng minh",
    "Tags": "limits, binomial-coefficients, random-walk",
    "Link": "https://math.stackexchange.com/questions/284288/problem-of-limit-with-binomial-coefficients",
    "Content": "I thought that the following would made a nice exercise, but I am not sure how to evaluate its difficulty since I often miss elementary solutions. How about you try answering it? It would be great to have several proofs. Let $m$ be a positive integer and $p \\in (0,1)$. Prove that $\\displaystyle\n\\lim_{n\\to\\infty}\\underset{m\\mid k}{\\sum_{0 \\leq k \\leq n}} \\binom{n}{k}p^{k}(1-p)^{n-k} = \\frac{1}{m}$. I give two proofs of this limit below, but I am still interested in elementary proofs. Edit 1. As noted by @rlgordonma, the sum is $\\lim_{n \\rightarrow \\infty} \\sum_{\\ell = 0}^{\\lfloor \\frac{n}{m} \\rfloor} \\binom{n}{\\ell m} p^{\\ell m} (1-p)^{n - \\ell m} = \\frac{1}{m}$. Maybe it makes things clearer like that. Edit2. Thank you for your participation. I will now give two proofs of this limit (one of them being a reformulation of vonbrand's solution). In fact, I will prove a little more: $$\\forall r \\in \\{0,\\dots,m-1\\},\\qquad\\lim_{n\\to\\infty} \\sum_{\\substack{0 \\leq k \\leq n\\\\ k \\equiv r\\; [m]}} \\binom{n}{k}p^k(1-p)^k = \\frac{1}{m}$$ Step 1 (probabilistic interpretation). This step is not necessary, but I think it brings a better insight. Let $X_1,X_2,\\dots$ be a sequence of independent Bernoulli random variables with parameter $0 < p <1$, that is $P(X_i=1)=1-P(X_i=0)=p$. Then $S_n = X_1 + \\dots+ X_n$ is a Binomial random variable with parameters $(n,p)$, and the sum we are interested in is just:\n$$\\sum_{\\substack{0 \\leq k \\leq n\\\\ k \\equiv r\\; [m]}} \\binom{n}{k}p^k(1-p)^k = P(S_n \\equiv r\\;[m]).$$\nThe sequence $(S_n)$ is a random walk over $\\mathbb{Z}$ but since we are only interested in its residue modulo $m$ it will be better to see it as a random walk over $\\mathbb{Z}/m\\mathbb{Z}$ (with an abuse of notation, we will still write $S_n$ for this residue). Step 2 (limit behaviour of the random walk). Quick version, with Markov Chains The random walk $(S_n)$ is an irreducible (and aperiodic) Markov Chain over the finite state space $\\mathbb{Z}/m\\mathbb{Z}$ with transition matrix given by $Q(i,i)=1-p$ and $Q(i,i+1)=p$ for $i \\in \\mathbb{Z}/m\\mathbb{Z}$. It admits the uniform distribution as a stationnary distribution, hence it converges to this distribution. QED Step 2 (bis). Without Markov Chains The following result (inversion formula for the discrete Fourier transform) is a generalization of @vonbrand's trick: Note $S = \\{0,\\dots,m-1\\}$ and $\\omega=\\exp\\left(i2\\pi/m\\right)$. For every function $f \\colon S\\to \\mathbb{C}$ and every $x \\in S$,\n  $$ f(x) = \\sum_{k = 0}^{m-1} \\widehat{f}(k)\\,\\omega^{kx},\\qquad\\text{where}\\quad \\widehat{f}(k) = \\frac{1}{m}\\sum_{x=0}^{m-1}f(x)\\omega^{-kx}.\n$$ In particular, we have\n$$\nE(f(S_n)) = \\sum_{k=0}^{m-1}\\widehat{f}(k)\\,E\\left[\\omega^{k S_n}\\right] \n$$\nThe sequence $X_1,X_2,\\dots$ being i.i.d.,\n$$\nE\\left[\\omega^{k S_n}\\right] = \\left(E\\left[\\omega^{k X_1}\\right] \\right)^n = ((1-p)+p\\omega^k)^n \\xrightarrow[n\\to\\infty]{}\\begin{cases}1 & \\text{if } k=0\\\\0 & \\text{else}\\end{cases}\n$$\nHence, $\\lim_{n\\to\\infty} E[f(S_n)] = \\widehat{f}(0)$. Taking $f(x) = 1_{\\{x = r\\}}$ yields the result.",
    "AcceptedAnswer": "There is a nice trick to select just the terms divisible by $m$ in a series.\nLet $A(z) = \\sum_{k} a_n z^n$. Take now $\\omega$ as a primitive $m$-th root of 1, i.e., $\\omega = \\exp(2 \\pi i / m)$. It is easily checked that $1 + \\omega + \\omega^2 + \\ldots + \\omega^{m - 1} = 0$ and also $\\omega^m = 1$. Take now:\n$$\nA(z) + A(\\omega z) + \\ldots + A(\\omega^{m - 1} z) =\n\\sum_{n \\ge 0} a_n z^n (1 + \\omega^n + \\omega^{2 n} + \\ldots + \\omega^{(m - 1) n})\n$$\nBut by the above, if $m \\mid n$, the sum in parentesis is $m$, else it is 0, and only those terms survive. Applying this to the specific case (no convergence problems, the sum looks infinite but is really finite):\n$$\nS(z) = \\sum_{k \\ge 0} \\binom{n}{k} p^k (1 - p)^{n - k} z^k = (1 - p (z - 1))^n\n$$\nThe original sum is just:\n$$\nS_{n,m} = \\sum_{\\substack{k \\ge 0\\\\m \\mid n}} \\binom{n}{k} p^k (1 -p)^{n - k}\n    = \\frac{1}{m} \\sum_{0 \\le k < m} \\left(1 + p (\\omega^k - 1) \\right)^n\n$$\nIt looks plausible that the last sum is just 1, but I'm stumped here. Edit: Thanks to the comment by @Ju's, I saw the light: When $k = 0$, the term is just $1^n = 1$. Otherwise, by the triangle inequality we have:\n$$\n\\lvert 1 + p (\\omega^k - 1) \\rvert = \\lvert (1 - p) + p \\omega^k \\rvert\n< (1 - p) + p = 1\n$$\nThe inequality is strict, because $\\omega^k$ is not in the direction 1. Then:\n$$\n\\lim_{n \\rightarrow \\infty} \\sum_{0 \\le k < m} (1 + p (\\omega^k - 1))^n\n= 1 + \\lim_{n \\rightarrow \\infty} \\sum_{1 < k < m}(1 + p \\omega^k - 1))^n\n= 1\n$$ Edit: To select terms where $n \\equiv r \\mod{m}$ do as above, but go:\n$$\nA(z \\omega^{m - r}) + A(z \\omega^{m - r + 1}) + \\ldots + A(z^{r - 1})\n$$\nThe rest of the proof goes through just as before.",
    "llm_answer_create_structured_problem": "###BEGIN_OF_FORMAT###\nassumption: \n$m$ is a positive integer,\n$p$ is a real number in the interval $(0,1)$.\nproblem:\nProve that  \n$$\\lim_{n\\to\\infty} \\sum_{\\substack{0 \\leq k \\leq n \\\\ m \\mid k}} \\binom{n}{k} p^{k}(1-p)^{n-k} = \\frac{1}{m}.$$\n###",
    "reasoning_create_structured_problem": "Okay, let me try to format this problem according to the user's requirements. The original question is about proving a limit involving a sum of binomial coefficients where the index k is divisible by m. The user provided an example where assumptions were listed line by line, each addressing one property or condition applied to one object.\n\nFirst, I need to extract the key assumptions from the problem. The problem states that m is a positive integer and p is between 0 and 1. These are the main conditions. The problem also mentions the limit as n approaches infinity of the sum over k congruent to r modulo m, but the user wants the problem part to be the general case where the sum is over k divisible by m (i.e., r=0). However, looking at the original problem statement, the user initially wrote the sum for m dividing k, which corresponds to r=0, but later in the edits, they generalized it to any residue r. However, in the problem section of the example provided, the assumption included specific conditions (like n being divisible by 7) that were part of the problem's hypothesis. \n\nWait, in the example, the original problem had \"for every integer n\", but in the formatted problem, they added an assumption that \"n is divisible by 7\". But that seems contradictory. Wait, no—the example given by the user might have been a mistake, or perhaps the original problem had that assumption. Let me check the example again.\n\nIn the example, the original problem was to prove that A(n) is divisible by 91 for every integer n. The formatted problem under assumptions listed \"n is an integer, n is divisible by 7\". Wait, that seems conflicting because the original says \"for every integer n\", but the formatted problem adds an assumption that n is divisible by 7. That might be an error in the example. But perhaps the user intended that in some cases, they need to extract hidden assumptions. Wait, maybe the example is incorrect. Let me see: the original problem says \"for every integer n\", but in the formatted version, they have \"n is an integer\" (which is given) and \"n is divisible by 7\" (which is not stated in the original problem). That seems like a mistake. But maybe the user intended to show that even if the problem says \"for every integer n\", perhaps the formatted version includes the necessary assumptions. Hmm, this is confusing. But the user's instruction says to list all assumptions from the problem. So maybe in that example, the original problem actually had the condition that n is divisible by 7, but in the original problem statement provided, it's written as \"for every integer n\". Wait, there's a discrepancy here. Perhaps the example is illustrative but not accurate. Anyway, moving on.\n\nIn the current problem, the user starts by stating: Let m be a positive integer and p ∈ (0,1). So those are the key assumptions. The problem is to prove the limit equals 1/m. The edits mention that the sum can be written as the limit over n of the probability that S_n ≡ r mod m, and they generalize to any residue r. However, in the initial problem statement, the sum is over k divisible by m (i.e., r=0). Wait, the original problem's title is \"Problem of limit with binomial coefficients\", and the initial problem statement says: Prove that the limit as n→∞ of the sum over k where m divides k, from k=0 to n, of binomial(n,k) p^k (1-p)^{n-k} equals 1/m. Then in the edits, the user generalizes it to any residue r mod m. But the user's formatted problem example took the original problem's assumptions. So for the current problem, the original problem is about m being a positive integer, p in (0,1), and the sum over k divisible by m. The edits mention the generalization to any residue, but the main problem as stated in the title and initial question is for m dividing k. However, the user's own answer includes the generalization to any residue r, but the problem is still to prove the limit is 1/m for each residue. Wait, no, if you have m residues, each with limit 1/m, then the total over all residues would sum to 1. But the initial problem was specifically for the case where k is divisible by m (r=0). However, the user later says they proved for any r in {0,...,m-1}, so perhaps the problem as stated in the question is actually the general case. Wait, looking back: the original problem statement says: \"Prove that lim_{n→∞} sum_{0 ≤ k ≤ n, m | k} C(n,k) p^k (1-p)^{n−k} = 1/m\". Then in the edits, they rephrase it with floor(n/m) and mention that maybe that's clearer. Then in Edit2, they say they will prove more: for each r in 0,...,m−1, the limit of the sum over k ≡ r mod m is 1/m. So the original problem is a special case when r=0, but the user's own answer generalizes it. However, the problem as initially posed is for m | k, i.e., r=0. But in the problem statement, the user wrote \"Prove that [sum] = 1/m\", but in their own solution, they show that for each residue r, the limit is 1/m. Therefore, the problem to be formatted is either the original one (r=0) or the generalized one (any r). \n\nBut according to the user's instruction, we need to structure the problem as per the original question. The original question's problem is the case where m divides k, so r=0. However, the user's edit2 mentions that they proved the generalized version. But the problem statement in the title and initial question is about m dividing k. However, the problem as stated by the user in the initial problem is to prove that the limit is 1/m for the sum over k divisible by m. Therefore, the assumptions are m is a positive integer, p is in (0,1), and the problem is to prove the limit equals 1/m. The user's own answer generalizes to any residue, but the original problem is specific to m dividing k. However, in the problem's title and the initial statement, it's about m dividing k, but in the edit, they rephrase it with floor(n/m), which still corresponds to k being multiples of m. Therefore, the main assumptions are:\n\n- m is a positive integer.\n- p is a real number between 0 and 1 (exclusive).\n- The sum is over k such that m divides k (i.e., k ≡ 0 mod m).\n\nBut wait, the problem as stated in the initial problem is:\n\n\"Prove that lim_{n→∞} sum_{0 ≤ k ≤ n, m | k} binom(n,k) p^k (1-p)^{n−k} = 1/m\".\n\nSo the key assumptions here are:\n\n1. m is a positive integer.\n2. p is in the open interval (0,1).\n3. The limit is taken as n approaches infinity.\n4. The sum is over k from 0 to n where m divides k.\n\nBut according to the user's example, each assumption should be a single line addressing one property or condition applied to one object. So:\n\nAssumptions:\n- m is a positive integer.\n- p is a real number such that 0 < p < 1.\n- The limit is evaluated as n approaches infinity.\n- The summation is over all integers k between 0 and n inclusive such that m divides k.\n\nBut wait, in the example, the assumptions were about the variables in the problem. For instance, in the example, the assumptions were about n being an integer and divisible by 7. In the current problem, m and p are given parameters, and the limit is part of the problem statement. The summation condition (m divides k) is part of the problem's setup, not an assumption. Wait, perhaps the assumptions are the given conditions on the variables. The problem states m is a positive integer and p ∈ (0,1). The rest (limit as n→∞, summation over k divisible by m) are part of the problem's statement, not assumptions. So the assumptions here would be:\n\n- m is a positive integer.\n- p is a real number in the interval (0,1).\n\nThe rest are part of the problem statement. Therefore, the formatted problem should list these two assumptions and then state the problem as proving the limit equals 1/m.\n\nWait, but in the user's example, the original problem was to prove for every integer n, A(n) is divisible by 91. The formatted assumptions included \"n is an integer\" and \"n is divisible by 7\". However, the original problem didn't state that n is divisible by 7; it said \"for every integer n\". That seems like a mistake. Maybe the example is incorrect, but according to the user's instruction, we should extract the assumptions from the problem. Therefore, in the current problem, the assumptions are m is a positive integer and p is between 0 and 1. The problem is to prove the limit equals 1/m. The summation over k divisible by m is part of the problem's setup, not an assumption. So following the example's structure, even if the example seems to include conditions not explicitly stated, perhaps the user wants to list all given conditions as assumptions. In the current problem, the given conditions are m is a positive integer and p ∈ (0,1). The rest are part of the problem. So the formatted problem would be:\n\nAssumption:\nm is a positive integer,\np is a real number in the interval (0,1).\nProblem:\nProve that\n$$\n\\lim_{n\\to\\infty} \\sum_{\\substack{0 \\leq k \\leq n \\\\ m \\mid k}} \\binom{n}{k} p^{k} (1-p)^{n-k} = \\frac{1}{m}.\n$$\n\nBut the user's edit mentions that the sum can be generalized to any residue r mod m, and the problem becomes proving that for each r, the limit is 1/m. However, the original problem as stated in the title and initial question is specifically for m dividing k (r=0). The user then later generalizes it, but the main problem is the initial one. However, in the problem statement, the user wrote in Edit2 that they prove for each r in 0,...,m-1, the limit is 1/m. So perhaps the actual problem to format is the generalized version, as the user included that in their own solution. But the original question's title and initial problem statement is about m dividing k. However, the user's own answer includes the generalized version. So perhaps the problem should be stated for a general residue r. But how to determine this? The original problem says: \"Prove that lim_{n→∞} sum_{0 ≤k ≤n, m|k} ... =1/m\". But in the edits, the user says they proved for any r. So maybe the problem as intended by the user is the general case, but the initial statement was specific. The user's instruction is to structure the problem as per the given example. In the example, the original problem had a condition that n is an integer, and the formatted problem included that as an assumption. Similarly, here, the original problem states m is a positive integer and p ∈ (0,1), so those are the assumptions. The problem is to prove the limit equals 1/m for the sum over k ≡0 mod m. However, the user's own solution generalizes it to any residue, but the problem as initially stated is for the sum over m dividing k. Therefore, the formatted problem should reflect the original problem's statement, not the generalization. Hence, the correct formatted problem would be as follows.",
    "Original_Problem": "assumption: \n$m$ is a positive integer,\n$p$ is a real number in the interval $(0,1)$.\nproblem:\nProve that  \n$$\\lim_{n\\to\\infty} \\sum_{\\substack{0 \\leq k \\leq n \\\\ m \\mid k}} \\binom{n}{k} p^{k}(1-p)^{n-k} = \\frac{1}{m}.$$",
    "Original_Problem_with_numerical_assumption": "Assumption:\nAssumption 1: $m$ is a positive integer,\nAssumption 2: $p$ is a real number in the interval $(0,1)$.\nProblem:\nProve that  \n$$\\lim_{n\\to\\infty} \\sum_{\\substack{0 \\leq k \\leq n \\\\ m \\mid k}} \\binom{n}{k} p^{k}(1-p)^{n-k} = \\frac{1}{m}.$$",
    "Proof_problem": "Yes",
    "Redundant_assumption": "$$\nA(z) + A(\\omega z) + \\ldots + A(\\omega^{m - 1} z) =\n\\sum_{n \\ge 0} a_n z^n (1 + \\omega^n + \\omega^{2 n} + \\ldots + \\omega^{(m - 1) n})\n$$",
    "Problem_with_redundant_assumption": "Assumption:\nAssumption 1: $m$ is a positive integer,\nAssumption 2: $p$ is a real number in the interval $(0,1)$.\nAssumption 3: $$\nA(z) + A(\\omega z) + \\ldots + A(\\omega^{m - 1} z) =\n\\sum_{n \\ge 0} a_n z^n (1 + \\omega^n + \\omega^{2 n} + \\ldots + \\omega^{(m - 1) n})\n$$\nProblem:\nProve that  \n$$\\lim_{n\\to\\infty} \\sum_{\\substack{0 \\leq k \\leq n \\\\ m \\mid k}} \\binom{n}{k} p^{k}(1-p)^{n-k} = \\frac{1}{m}.$$"
}