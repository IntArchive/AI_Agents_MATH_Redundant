{
    "Link_API": "https://api.stackexchange.com/2.3/questions/1500829",
    "Title": "A disease spreading through a triangular population",
    "Score": 32,
    "Category": "Chứng minh",
    "Tags": "probability, combinatorics, graph-theory, asymptotics, expectation",
    "Link": "https://math.stackexchange.com/questions/1500829/a-disease-spreading-through-a-triangular-population",
    "Content": "I have run into this problem in my research, which I'm presenting under a different guise to avoid going into unnecessary background. Consider a population that is connected in a triangular manner, as shown in the figure below. The root node has a disease, which spreads downwards through the population as follows: With probability $p$ a diseased parent node infects only one of its two child nodes (chosen randomly); and with probability $1-p$ it infects both of them A child node becomes diseased if it is infected by one or two parent nodes I am interested in the asymptotic behavior of the expected number of diseased nodes at level $k$. Simulations show that the expected number of diseased nodes grows asymptotically linearly with the number of levels. Moreover, the slope of this relationship decreases approximately linearly with $p$ (obviously, when $p = 0$ the slope is $1$, as everyone gets diseased; when $p = 1$ the slope is $0$ as the number of diseased nodes remains at $1$ at every level). So the behavior seems to follow: $E(\\text{diseased nodes at level n})=(1 - p)n$, at least to a very good approximation.",
    "AcceptedAnswer": "In this answer I compute the generating function $f(z) = \\sum a_n z^n$ where $a_n$ is the expectation of infected nodes at level $n$ if there is a single infected node at level $0$, and use it to get the asymptotic behaviour for $a_n$. The main obstacle to doing this is to get the generating function of the cells given by $2$ neighbouring infected nodes $N_1$ and $N_2$.\nBy the inclusion exclusion principle this is as hard as getting the generating function of the cells infected by both cells.\nHowever, if you look carefully, there is a node $N_3$ that is the earliest common infected from $N_1$ and $N_2$ : a node is infected by both $N_1$ and $N_2$ if and only if it is infected by $N_3$. Before computing $f$, we need to get the probability law of the level at which $N_3$ appears. let $b_n$ be the probability that $N_3$ is at level $n$. If we look at the rightmost infected descendant of the left node at each level, its position moves right with probability $1-p/2$, and moves left with probability $p/2$. Somethiong similar can be said for the leftmost infected descendant of the right node, and so their difference is a biased random walk that moves by $-1$ with probability $(1-p/2)²$, moves by $+1$ with probability $(p/2)^2$ and doesn't move the rest of the time (which is $p-p^2/2$). Therefore, if we let $g(z) = \\sum b_n z^n$, we have $g(z) = z[(1-p/2)^2 + (p-p^2/2)g(z) + (p^2/4)g(z)^2]$. From this we get $$g(z) = p^{-2}((2 - p(2-p)z) - 2\\sqrt{1 - p(2-p)z}) \\\\ = (2-p)^2(z/4) + 2p(2-p)^3(z/4)^2 + 5p^2(2-p)^4(z/4)^3 + \\ldots \\\\ = \\sum_{n \\ge 1} C_np^{n-1}(2-p)^{n+1}(z/4)^n$$ where $C_n$ are the Catalan numbers. Now that we got $g$, we can focus on $f(z) = \\sum a_n z^n$. We have $f(z) = 1 + zf(z)(p + (1-p)(2-g(z)))$, and so $$f(z) = 1/(1-(2-p)z+(1-p)p^{-2}[2-p(2-p)z-2\\sqrt{1-p(2-p)z}]) \\\\\n= 1 + 2((2-p)z/2) + (3+p)((2-p)z/2)^2 + (4+3p+p^2)((2-p)z/2)^3 + \\ldots $$ Now the asymptotic behaviour of those coefficients depend on what kind of singularities $f$ has and where. After rationalising the denominator we have\n$$f(z) = \\frac{(2-2p+p^2) - p(2-p)z + 2(1-p)\\sqrt{1-p(2-p)z}}{(2-p)^2(1-z)^2} \\\\\n       = \\frac{4(1-p)^2}{(2-p)^2(1-z)^2} + \\frac{2p}{(2-p)(1-z)} + \n  \\frac{(-2+2p-p^2) + 2p(1-p)z + 2(1-p)\\sqrt{1-p(2-p)z^2}}{(2-p)^2(1-z)^2} $$ where that last fraction has a removable singularity at $z=1$. Computing the Taylor series for the first two terms is not difficult, and the third has a branch point at $z = 1/p(2-p)$, so the Cauchy integral formula implies that its coefficient are a $O((p(2-p))^n)$ : We get $a_n = \\frac{(1-p)^2}{(1-p/2)^2}(n+1) + \\frac p{1-p/2} + O((p(2-p))^n)$. We can go more in-depth and get more information by assigning an indeterminate $x$ for the horizontal axis and using generating functions in two variables.\nPut the origin of the top row at the position of the original infected node, and put the origin of the next level at the left descendant of the previous origin. Let $g(x,z) = \\sum b_{n,k}x^kz^n$ where $b_{n,k}$ is the probability that $N_3$ appears at the node $k$ at level $n$ ; and $f(x,z) = \\sum a_{n,k}x^kz^n$ where $a_{n,k}$ is the probability that the node $k$ at level $n$ is infected. (we get the old $f$ and $g$ by doing the partial evaluation $x=1$). Now this is only a matter of refining everything said above. We have the equations $$g = z[(1-p/2)^2\\frac{1+x}2 + (p-p^2/2)g\\frac{1+x}2 + (p^2/4)g^2] \\\\\nf = 1 + zf(p\\frac{1+x}2 + (1-p)((1+x)-g))\n$$ We eventually get $ f = \\frac{(8-8p+4p^2) - 2p(2-p)(1+x)z  + 2(1-p)\\sqrt{16 - 8p(2-p)(1+x)z + (p(2-p)(1-x)z)^2}}\n {(2-p)^2(2 - (2-p+px)z)(2 - (2x+p-px)z)} = t_1+t_2+t_3$ where $ t_1 = \\frac{16(1-p)^2}{(2-p)^2(2 - (2-p+px)z)(2 - (2x+p-px)z)}$ $ t_2 = \\frac{2p}{2-p}\\left(\\frac 1 {2 - (2-p+px)z} + \\frac 1 {2 - (2x+p-px)z}\\right)$ $ t_3 = \\frac{-8+8p-4p^2 + 2(2-p)pz(1+x) + 2(1-p)\\sqrt{16 - 8p(2-p)(1+x)z + (p(2-p)(1-x)z)^2}}{(2-p)^2(2 - (2-p+px)z)(2 - (2x+p-px)z)} $ and once again, the singularity along the two curves in $t_3$'s denominator are removable in this branch of the square root. $t_1$'s and $t_2$'s constributions have the same asymptotic behaviour around the edges of the triangle, while in the middle, $t_1$'s terms should quickly become more dominant. $t_1 = \\frac {4(1-p)}{(2-p)^2(1-x)} \\left(\\frac{2-p+px}{2-(2-p+px)z}-\\frac{2x+p-px}{2-(2x+p-px)z}\\right)\n=  \\frac {4(1-p)}{(2-p)^2(1-x)} \\left(\\sum_{n \\ge 0} ((\\frac{2-p+px}2)^{n+1} - (\\frac{2x+p-px}2)^{n+1}) z^n \\right)\n$ The coefficients of $((2-p+px)/2)^{n+1}$ are the distribution a random walk looking like the left border of the infected population, and after dividing by $1-x$, we obtain the probabilities that we are to the right of that random walk. After substracting the two terms, it turns out that the coefficients of $t_1$ are $\\frac{4(1-p)}{(2-p)^2}$ times the probability to be between the left and right borders of the infected population, if those borders were two (dependant, because they mustn't cross each other) random walks, one with mean $p/2$ the other with mean $1-p/2$ and both with variance $p(2-p)/4$. Thus those coefficients converge to a rectangular shape of height $\\frac{4(1-p)}{(2-p)^2}$, with borders shaped like the error function at positions $pn/2$ and $(1-p)n/2$ and with width $O(\\sqrt{np(2-p)})$. The $t_2$ term is $\\frac p{2-p}$ times the position of those random walks, so it adds two small gaussian shapes of height $O(\\sqrt{p/n(2-p)^3})$ and width $O(\\sqrt {np(2-p)})$ on top of those transitions (note that when $p=1$, $t_1=0$ and this is the dominant term instead)",
    "llm_answer_create_structured_problem": "###BEGIN_OF_FORMAT###\nAssumption: \nThe population is structured as a triangular hierarchy where each parent node has two child nodes.\nThe root node is initially diseased.\nA diseased parent node infects one randomly chosen child node with probability $p$.\nA diseased parent node infects both child nodes with probability $1 - p$.\nA child node becomes diseased if infected by at least one parent node.\nThe analysis focuses on the asymptotic behavior as the level number $k$ approaches infinity.\nProblem:\nProve that the expected number of diseased nodes at level $n$ grows asymptotically as $E(n) = (1 - p)n$.\n###",
    "reasoning_create_structured_problem": "Okay, let me try to figure out how to structure this problem according to the given format. The user wants me to act as a math professor and format the problem from Math Stack Exchange into the specified Assumption and Problem sections. \n\nFirst, I need to read the original question carefully. The problem is about a disease spreading through a triangular population. The root node is diseased, and it spreads downwards. The spreading has two probabilities: with probability p, a diseased parent infects only one child (randomly chosen), and with probability 1-p, it infects both. A child becomes diseased if infected by one or both parents. The user is interested in the asymptotic expected number of diseased nodes at level k. They observed through simulations that the expected number grows linearly with the number of levels, with the slope decreasing linearly as p increases. Their conjecture is E(diseased nodes at level n) ≈ (1 - p)n.\n\nNow, I need to extract the assumptions. Each assumption should be a single property or condition applied to one object. Let's list them:\n\n1. The population is connected in a triangular manner. (This is about the structure of the population.)\n2. The root node is initially diseased. (Initial condition.)\n3. A diseased parent node infects one child with probability p. (Infection rule part 1.)\n4. A diseased parent node infects both children with probability 1 - p. (Infection rule part 2.)\n5. A child node becomes diseased if infected by one or two parent nodes. (Condition for a child to become diseased.)\n6. The expected number of diseased nodes at level k is considered. (Focus on expectation.)\n\nWait, the problem mentions asymptotic behavior, so maybe there's an assumption about k being large (asymptotic). But the original problem statement doesn't explicitly state that as an assumption; it's part of what they're asking. However, in the example provided, the assumption included conditions on n (like n is divisible by 7). Here, the user mentions asymptotic behavior, so perhaps we need to include that the analysis is for large k (level approaching infinity). But the original problem states \"asymptotic behavior of the expected number of diseased nodes at level k.\" So maybe that's part of the problem statement rather than an assumption.\n\nLooking at the example again: the original problem had an assumption that n is an integer and divisible by 7, even though the problem statement only said \"for every integer n\". The user restructured it to include n being divisible by 7 as an assumption. Wait, no, in the example, the original problem was to prove for every integer n, but the formatted problem had an assumption that n is an integer and n is divisible by 7. Wait, that seems incorrect. Wait, the original problem said \"for every integer n\", but the formatted assumption includes \"n is divisible by 7\". That seems like a mistake. Wait, the original problem says \"Prove that for every integer n, the number A(n) = ... is divisible by 91.\" But 91 is 7*13. So perhaps the formatted example's assumption is wrong. Wait, maybe the user made a mistake in the example. Because the original problem doesn't state that n is divisible by 7; the user added that as an assumption. That might be an error in the example. But regardless, I need to follow the instruction here.\n\nIn the current problem, the user from Math Stack Exchange didn't state any specific constraints on p or k, but they observed that when p=0, slope is 1, and when p=1, slope is 0. So perhaps p is between 0 and 1. That's an assumption. Also, the structure is a triangular population, which I assume is a binary tree where each node has two children, forming a triangle. So each level k has k+1 nodes? Or maybe it's structured differently. The problem mentions \"connected in a triangular manner\", but the exact structure might be important. However, the user says to filter unrelated information, so perhaps the key points are the infection probabilities and the initial condition.\n\nSo possible assumptions:\n\n- The population is structured as a triangular hierarchy with each parent node connected to two child nodes.\n- The root node is initially diseased.\n- Each diseased parent node infects one child with probability p and both children with probability 1 - p.\n- Infection by either one or both parents results in the child becoming diseased.\n- The analysis considers the expected number of diseased nodes at level k as k approaches infinity.\n\nBut the problem is to show that the expected number grows asymptotically linearly with slope (1 - p). So the problem part would be to prove that E(diseased nodes at level n) = (1 - p)n asymptotically.\n\nNow, to structure this into the Assumption and Problem sections, each assumption on a separate line. Let me list them:\n\nAssumption:\nThe population is structured as a triangular hierarchy where each parent node has two child nodes.\nThe root node is initially diseased.\nEach diseased parent node infects one randomly chosen child node with probability p.\nEach diseased parent node infects both child nodes with probability 1 - p.\nA child node becomes diseased if infected by at least one parent node.\nThe analysis focuses on the asymptotic expected number of diseased nodes as the level number k approaches infinity.\n\nProblem:\nProve that the expected number of diseased nodes at level n grows asymptotically as E(n) = (1 - p)n.\n\nBut wait, the original problem mentions \"the slope of this relationship decreases approximately linearly with p\". So the problem is to confirm that the slope is indeed (1 - p), which their simulations suggest. Therefore, the problem is to prove that asymptotically, E(n) ~ (1 - p) n.\n\nI need to ensure each assumption is one line, each addressing one property. Let me check:\n\n1. The population is structured as a triangular hierarchy (each node has two children, forming levels).\n2. The root node is initially diseased.\n3. A diseased parent node infects one child node with probability p.\n4. A diseased parent node infects both child nodes with probability 1 - p.\n5. A child node becomes diseased if infected by at least one parent node.\n6. The analysis considers the asymptotic behavior as the level number k approaches infinity.\n\nThat seems to cover all assumptions. The problem is to prove the expected number of diseased nodes at level n is asymptotically (1 - p) n.",
    "Original_Problem": "Assumption: \nThe population is structured as a triangular hierarchy where each parent node has two child nodes.\nThe root node is initially diseased.\nA diseased parent node infects one randomly chosen child node with probability $p$.\nA diseased parent node infects both child nodes with probability $1 - p$.\nA child node becomes diseased if infected by at least one parent node.\nThe analysis focuses on the asymptotic behavior as the level number $k$ approaches infinity.\nProblem:\nProve that the expected number of diseased nodes at level $n$ grows asymptotically as $E(n) = (1 - p)n$.",
    "Original_Problem_with_numerical_assumption": "Assumption:\nAssumption 1: The population is structured as a triangular hierarchy where each parent node has two child nodes.\nAssumption 2: The root node is initially diseased.\nAssumption 3: A diseased parent node infects one randomly chosen child node with probability $p$.\nAssumption 4: A diseased parent node infects both child nodes with probability $1 - p$.\nAssumption 5: A child node becomes diseased if infected by at least one parent node.\nAssumption 6: The analysis focuses on the asymptotic behavior as the level number $k$ approaches infinity.\nProblem:\nProve that the expected number of diseased nodes at level $n$ grows asymptotically as $E(n) = (1 - p)n$.",
    "Proof_problem": "Yes",
    "Redundant_assumption": "$$f(z) = 1/(1-(2-p)z+(1-p)p^{-2}[2-p(2-p)z-2\\sqrt{1-p(2-p)z}]) \\\\\n= 1 + 2((2-p)z/2) + (3+p)((2-p)z/2)^2 + (4+3p+p^2)((2-p)z/2)^3 + \\ldots $$",
    "Problem_with_redundant_assumption": "Assumption:\nAssumption 1: The population is structured as a triangular hierarchy where each parent node has two child nodes.\nAssumption 2: The root node is initially diseased.\nAssumption 3: A diseased parent node infects one randomly chosen child node with probability $p$.\nAssumption 4: A diseased parent node infects both child nodes with probability $1 - p$.\nAssumption 5: A child node becomes diseased if infected by at least one parent node.\nAssumption 6: The analysis focuses on the asymptotic behavior as the level number $k$ approaches infinity.\nAssumption 7: $$f(z) = 1/(1-(2-p)z+(1-p)p^{-2}[2-p(2-p)z-2\\sqrt{1-p(2-p)z}]) \\\\\n= 1 + 2((2-p)z/2) + (3+p)((2-p)z/2)^2 + (4+3p+p^2)((2-p)z/2)^3 + \\ldots $$\nProblem:\nProve that the expected number of diseased nodes at level $n$ grows asymptotically as $E(n) = (1 - p)n$."
}