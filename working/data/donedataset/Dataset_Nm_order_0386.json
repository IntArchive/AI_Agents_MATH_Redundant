{
    "Link_API": "https://api.stackexchange.com/2.3/questions/51469",
    "Title": "Prime dividing the binomial coefficients",
    "Score": 38,
    "Category": "Chứng minh",
    "Tags": "elementary-number-theory, prime-numbers, binomial-coefficients",
    "Link": "https://math.stackexchange.com/questions/51469/prime-dividing-the-binomial-coefficients",
    "Content": "It is quite easy to show that for every prime $p$ and $0<i<p$ we have that $p$ divides the binomial coefficient $\\large p\\choose i$; one simply notes that in $\\large \\frac{p!}{i!(p-i)!}$ the numerator is divisible by $p$ whereas the denominator is not (since it is a product of numbers smaller than $p$ and $p$ is prime). My problem is with generalizing this argument for $q=p^n$. I'm looking for the most elegant and simple way to prove that $p$ still divides $\\large q\\choose i$.",
    "AcceptedAnswer": "Let $v_p(n)$ denotes the exponent of the largest power of $p$ which divides $n$. We'll show that $v_p\\left({p^n \\choose i}\\right) = n-v_p(i)$. In particular, this is positive unless $i=0$ or $i=p^n$. It's easy to see that for any $n$, $$v_p(n!)=\\sum_{k=1}^\\infty \\left\\lfloor \\frac{n}{p^k}\\right\\rfloor.$$ We need an expression for $v_p(q!)-v_p(i!)-v_p((q-i)!)$, where $q=p^n$. Notice that $v_p(q!) = \\frac{p^n-1}{p-1}$ by the above formula (which just becomes a geometric series with finitely many terms). Notice also that for any $x \\in \\mathbb{R}$, $\\lfloor -x \\rfloor + \\lfloor x \\rfloor =\\begin{cases} 0 && \\text{if } x \\in \\mathbb{Z} \\\\ -1 && \\text{otherwise.}\\end{cases}$ Therefore, $$\\begin{align}v_p((q-i)!)+v_p(i!) &= \\sum_{k=1}^n \\left\\lfloor\\frac{p^n-i}{p^k}\\right\\rfloor + \\left\\lfloor\\frac{i}{p^k}\\right\\rfloor \\\\ &=\\sum_{k=1}^n \\left(p^{n-k} + \\left\\lfloor\\frac{-i}{p^k}\\right\\rfloor + \\left\\lfloor\\frac{i}{p^k}\\right\\rfloor\\right) \\\\&=\\frac{p^n-1}{p-1}-(n-v_p(i)).\\end{align}$$ Hence we have $v_p\\left({p^n \\choose i}\\right) = n-v_p(i)$. Edit (Dec. 6 2011): for fun, yesterday I asked myself how badly the equality $v_p\\left({n \\choose m}\\right) = v_p(n)-v_p(m)$ fails for general $n$ and $m$. So I used Mathematica to create the following image. The triangle consists of the first 256 rows of Pascal's triangle, colored using the following rule: the greener a points is, the bigger the difference $v_2\\left({n \\choose m}\\right) - v_2(n) +v_2(m)$. A little experimentation shows that any other choice of prime generates a similar image. To create this image, I used the p-adic arithmetic package and the following code: p = 2; \nuntil = 256; t = Table[Table[{RGBColor[0, PadicOrder[Binomial[n, m]/(n/m), p]/Log[p, until], 0], Rectangle[{until/2 - 1/2 - n/2 + m, n}]}, {m, 1, n}], {n, 1, until}];\nGraphics[t]",
    "llm_answer_create_structured_problem": "###BEGIN_OF_FORMAT###\nAssumption: \n$p$ is a prime number,\n$q$ is a power of $p$ (i.e., $q = p^n$ for some integer $n \\geq 1$),\n$i$ is an integer satisfying $0 < i < q$.\nProblem: \nProve that $p$ divides the binomial coefficient $\\dbinom{q}{i}$.  \n###END_OF_FORMAT###\n\n**Answer:**  \nThe simplest proof uses the **freshman's dream**: For a prime $p$, $(a + b)^p \\equiv a^p + b^p \\pmod{p}$. By induction:  \n1. Base case ($n=1$): For $q = p$, $\\dbinom{p}{i} \\equiv 0 \\pmod{p}$ for $0 < i < p$ (classic result).  \n2. Inductive step: Assume $(1 + x)^{p^k} \\equiv 1 + x^{p^k} \\pmod{p}$. Then,  \n   $$(1 + x)^{p^{k+1}} = \\left[(1 + x)^{p^k}\\right]^p \\equiv \\left(1 + x^{p^k}\\right)^p \\equiv 1 + x^{p^{k+1}} \\pmod{p}.$$  \nThus, $(1 + x)^{q} \\equiv 1 + x^q \\pmod{p}$, meaning all coefficients $\\dbinom{q}{i}$ ($0 < i < q$) are divisible by $p$.  \n\nThis elegantly generalizes the divisibility property to prime powers.",
    "reasoning_create_structured_problem": "Okay, let's tackle this problem. The user wants to prove that for a prime power q = p^n and 0 < i < q, the binomial coefficient C(q, i) is divisible by p. \n\nFirst, I need to recall the original argument for primes. When p is prime and 0 < i < p, the binomial coefficient C(p, i) has a numerator p! and denominator i!(p-i)!. Since p is prime, the denominator can't have p as a factor, so p divides the numerator but not the denominator, hence p divides C(p, i). \n\nNow, generalizing this to q = p^n. The challenge here is that q is a prime power, not necessarily prime. So the same approach might not work directly. Let me think. The binomial coefficient C(q, i) is q! / (i! (q - i)! ). Since q = p^n, the numerator is (p^n)! and the denominator is i! (p^n - i)!.\n\nThe key idea in the prime case was that p divides the numerator but not the denominator. For q = p^n, we need to check the exponent of p in the numerator and denominator. If the exponent of p in the numerator minus the exponent in the denominator is at least 1, then p divides the binomial coefficient.\n\nSo, Legendre's formula comes to mind. It tells us that the exponent of a prime p in m! is given by sum_{k=1}^∞ floor(m/p^k). Applying this to the numerator (p^n)! and the denominator i! (p^n - i)!.\n\nLet me denote v_p(m!) as the exponent of p in m!. Then, the exponent in the binomial coefficient is v_p((p^n)!) - v_p(i!) - v_p((p^n - i)!).\n\nWe need to show that this difference is at least 1. \n\nNow, using Legendre's formula for m = p^n, the exponent v_p(p^n!) = floor(p^n/p) + floor(p^n/p^2) + ... + floor(p^n/p^n) + ... But since p^n/p^k = p^{n - k}, so each term floor(p^n/p^k) = p^{n - k} for k ≤ n. So summing from k=1 to n: p^{n-1} + p^{n-2} + ... + p^0 = (p^n - 1)/(p - 1). \n\nSimilarly, for any i between 0 and p^n, v_p(i!) + v_p((p^n - i)! ). Let's take an arbitrary i. When we add i and (p^n - i), their sum is p^n. But how does that affect the sum of their exponents? \n\nWait, in the case where i is between 0 and p, we can see that the exponents in the denominator would be small, but when i is larger, especially multiples of p, the exponents in the denominator might be higher. However, the key is that when adding v_p(i!) and v_p((p^n - i)! ), this sum is less than v_p(p^n! ). \n\nAlternatively, perhaps using Lucas' theorem, which states that the binomial coefficient C(p^n, i) modulo p can be found by looking at the base-p expansions of i and p^n - i. Since p^n in base p is 1 followed by n zeros, and i in base p is some combination of digits a_0 + a_1 p + ... + a_{n-1} p^{n-1}, where each a_j < p. Then, Lucas' theorem says that C(p^n, i) ≡ product of C(1, a_j) for each digit. But since i is between 0 and p^n, and in base p, the digits of p^n are 1 followed by zeros, the digits of i must all be 0 except possibly the first digit. Wait, no: i can have digits up to p-1 in any position. Wait, actually, Lucas' theorem would say that if we write i in base p as i = i_0 + i_1 p + ... + i_{n-1} p^{n-1}, then C(p^n, i) ≡ C(1,0) * C(0, i_1) * ... * C(0, i_{n-1}) ). But since p^n in base p is 1 followed by n zeros, the digits of p^n are (1, 0, 0, ..., 0). So when computing C(p^n, i), each digit of i must be less than or equal to the corresponding digit in p^n, which is 1 in the first digit and 0 elsewhere. So, if i has any digit other than the first one non-zero, then C(0, i_j) would be zero when i_j > 0. Hence, unless i is 0 or p^n, which are excluded (since 0 < i < q = p^n), then C(p^n, i) ≡ 0 mod p. Therefore, p divides C(q, i). \n\nBut this uses Lucas' theorem, which might be considered advanced. The user asked for the most elegant and simple way. Maybe there's a more elementary approach.\n\nGoing back to the exponent of p in the binomial coefficient. Let's compute v_p(C(q, i)) = v_p(q!) - v_p(i!) - v_p((q - i)! ). As q = p^n, then v_p(q!) = (p^n - 1)/(p - 1). For v_p(i!) + v_p((q - i)! ), let's consider the sum. \n\nIf we can show that v_p(i!) + v_p((q - i)! ) < v_p(q! ), then the difference would be at least 1. But how?\n\nAlternatively, consider that i and q - i add up to q. Let’s consider their base-p expansions. Let’s write i in base p as i = a_0 + a_1 p + ... + a_{n-1} p^{n-1}, where 0 ≤ a_j ≤ p-1. Similarly, q - i = p^n - i = (p^n - a_0) - a_1 p - ... - a_{n-1} p^{n-1}. But this might involve borrowing in the digits. For example, if a_0 > 0, then p^n - i would start with (p - a_0) in the units place, then (p - 1 - a_1) in the p's place, etc., because p^n is 1 followed by zeros in base p. \n\nThis seems complicated. Alternatively, using the formula for the exponent of p in m!: v_p(m!) = (m - s_p(m))/(p - 1), where s_p(m) is the sum of digits of m in base p. \n\nSo, v_p(q!) = (p^n - 1)/(p - 1) because s_p(p^n) = 1 (since it's 1 followed by zeros). Then, v_p(i!) + v_p((q - i)! ) = [i - s_p(i) + (q - i) - s_p(q - i)] / (p - 1) ) = [q - s_p(i) - s_p(q - i)] / (p - 1). \n\nThus, the exponent of p in C(q, i) is [ (p^n - 1) - (q - s_p(i) - s_p(q - i)) ] / (p - 1) ) = [ (q - 1) - q + s_p(i) + s_p(q - i) ] / (p - 1) ) = [ s_p(i) + s_p(q - i) - 1 ] / (p - 1).\n\nBut since q = p^n, when you add i and q - i, the sum is q. In base p, adding i and q - i would have digits that sum to p or p-1 in each digit. However, since q is 1 followed by zeros, when adding i and q - i, the digits must sum to p-1 in each digit except for the highest one, where it sums to 1. Wait, but this might depend on the exact digits. Let me think.\n\nIf i is written in base p as a_0 + a_1 p + ... + a_{n-1} p^{n-1}, then q - i = (p^n - i). In base p, q is 1 followed by n zeros. Subtracting i from q, each digit of q - i would be (p - a_j - 1) for j < n, and the leading digit becomes 0. Wait, no. Let's take an example: q = p^2 = p^2, i = a p + b. Then q - i = p^2 - a p - b = (p^2 - a p - b). In base p, this would be (p - a -1) in the p's place and (p - b) in the units place, but if b=0, then it's (p - a -1) p + 0. Hmm, maybe not. Let's take p=3, n=2, so q=9. If i=5, which is 1*3 + 2, then q - i = 4, which is 1*3 +1. So digits of i are (2,1) in base 3, and q - i digits are (1,1). The sum of digits s_p(i)=2+1=3, s_p(q - i)=1+1=2. Sum is 5. For q=9, s_p(q)=1. Then according to the previous formula, [s_p(i)+s_p(q -i) -1]/(p-1) = (3+2-1)/(2)=4/2=2. So v_p(C(9,5))=2, which is correct since C(9,5)=126, which is divisible by 3^2=9. So in this case, the exponent is 2. \n\nBut the problem only asks to prove that p divides C(q,i), i.e., that the exponent is at least 1. So we need to show that s_p(i) + s_p(q - i) - 1 ≥ p - 1. Wait, no. Wait, the formula was [s_p(i) + s_p(q - i) -1]/(p -1). We need this to be ≥1. So s_p(i) + s_p(q - i) -1 ≥ p -1 → s_p(i) + s_p(q - i) ≥ p. \n\nBut in the example above, s_p(i) + s_p(q -i) =5, which is ≥3 (since p=3). So 5 ≥3 holds. So in general, can we show that for q = p^n and 0 < i < q, s_p(i) + s_p(q -i) ≥ p?\n\nWait, let's see. If we take i=1, then q -i = p^n -1. In base p, p^n -1 is (p-1)(p^{n-1} + p^{n-2} + ... +1), so its digit sum is (p-1)*n. So s_p(i) =1, s_p(q -i)=n(p-1). Then sum is 1 + n(p-1). Since n ≥1 and p≥2, this sum is ≥1 +1*(2-1)=2 ≥p=2. For p=2, n=1: sum is1+1=2=p. For p=2, n=2: sum is1+2=3>2. So works. For i=1 in p=3, n=1: sum is1 +2=3= p. So holds. For i=1 in general, s_p(i) + s_p(q -i) =1 + (p-1)*n. Since n ≥1, this is ≥1 + (p-1)*1 =p. So equality holds when n=1. For n>1, it's greater than p. \n\nAnother example: take i = p^{n-1}. Then q -i = p^n -p^{n-1} = p^{n-1}(p-1). In base p, this is (p-1) followed by (n-1) zeros. So s_p(i) =1, s_p(q -i)=p-1. Sum is1 + (p-1)=p. So again, the sum is exactly p. \n\nIn general, for any i between 0 and q=p^n, s_p(i) + s_p(q -i) ≥ p. Because when you add i and q -i, you get q. In base p, the addition of i and q -i would involve carries. Specifically, in each digit except the highest one (which is 1 in q), the digits of i and q -i must add up to p-1 or p. If they add up to p-1, there's no carry. If they add up to p or more, there would be a carry. However, since q is p^n, which in base p has a 1 followed by zeros, adding i and q -i must result in digits that sum to p in the lower digits if there's a carry, but since q is 1 followed by zeros, the addition would only carry into the n-th digit. But this might complicate. \n\nAlternatively, using the fact that for any two numbers a and b such that a + b = p^n, their digit sums in base p satisfy s_p(a) + s_p(b) = (p-1)*n +1 - t, where t is the number of carries in the addition. Wait, I'm not sure. Maybe there's a formula for digit sums of a and b when a + b = p^n. \n\nAlternatively, consider that when you write i in base p, then q -i = p^n -i. When you subtract i from p^n in base p, each digit of q -i is (p - digit of i) -1 for the lower digits and then borrows. Wait, this is similar to how in base 10, 1000 - 123 = 877. So in base p, subtracting i from p^n would result in digits (p - i_j -1) for the first n-1 digits, and the nth digit becomes 0. But maybe the digit sum of q -i is (p-1)*(n) - s_p(i) +1. Wait, let's test with the example where p=3, n=2, i=5 (which is 12 in base 3). Then q -i =9-5=4, which is 11 in base 3. s_p(q -i)=1+1=2. s_p(i)=1+2=3. (p-1)*n=2*2=4. So 4 -3 +1=2, which matches. So formula: s_p(q -i) = (p-1)*n - s_p(i) +1. Therefore, s_p(i) + s_p(q -i) = s_p(i) + (p-1)*n -s_p(i) +1 = (p-1)*n +1. \n\nWait, this seems promising. If this formula holds, then s_p(i) + s_p(q -i) = (p-1)*n +1. Then [s_p(i) + s_p(q -i) -1]/(p-1) = ((p-1)*n +1 -1)/(p-1) )= n. Therefore, v_p(C(q,i))=n. Wait, but this contradicts the earlier example where p=3, n=2, i=5, where v_p(C(9,5))=2, which equals n=2. Similarly, when p=2, n=3, q=8, i=1: C(8,1)=8, which has v_p=3, which equals n=3. Wait, this seems to hold. So according to this, the exponent of p in C(q,i) is always n, hence divisible by p. But this can't be true because, for example, take p=3, n=2, q=9, i=3. Then C(9,3)=84. 84 divided by 3 is 28, so v_p=1, not n=2. Hmm, contradiction. So the formula must be wrong.\n\nWait, where did I go wrong? Let's check the example with i=3 (which is 10 in base 3). Then q -i =6 (which is 20 in base 3). s_p(i)=1+0=1, s_p(q -i)=2+0=2. Sum is 3. (p-1)*n +1=2*2 +1=5. But 3≠5. So my previous assumption was incorrect. Therefore, the formula s_p(q -i) = (p-1)*n - s_p(i) +1 is not correct.\n\nSo back to the drawing board. Maybe there's another way to approach this.\n\nConsider Lucas' theorem again. For q = p^n, and 0 < i < q, write i in base p. Since q in base p is 1 followed by n zeros, the digits of i must be 0 in the p^n place. But since i < p^n, its base-p expansion has at most n digits. Let’s write i = i_0 + i_1 p + ... + i_{n-1} p^{n-1}, where 0 ≤ i_j ≤ p-1. Then q - i = (p^n - i) = (p^n - i_0 - i_1 p - ... - i_{n-1} p^{n-1}). In base p, this is (p - i_0) + (p -1 - i_1) p + ... + (p -1 - i_{n-1}) p^{n-1} minus some adjustment if there's borrowing. Wait, this is getting complicated. Let's take an example: p=3, n=2, i=5 (which is 12 in base 3). q=9=100 in base 3. q -i=4=11 in base 3. So digits of i are [2,1], digits of q -i are [1,1]. s_p(i)=2+1=3, s_p(q -i)=1+1=2. Sum is 5. (p-1)*n=2*2=4. 5>4. Another example: i=3 (10 in base 3), q -i=6 (20 in base 3). s_p(i)=1, s_p(q -i)=2. Sum=3= (p-1)*n=2*2=4. No, 3<4. Wait, this contradicts the previous assertion. So perhaps there's no general formula.\n\nBut according to Lucas' theorem, C(q, i) ≡ product over digits C(0, i_j), since q in base p is 1 followed by zeros. Wait, Lucas' theorem says that if we have numbers m and n written in base p as m = m_0 + m_1 p + ... + m_k p^k and n = n_0 + n_1 p + ... + n_k p^k, then C(m,n) ≡ product C(m_j, n_j) mod p. In our case, m = q = p^n, which in base p is 1 followed by n zeros. So m_j =1 for j=0 and m_j=0 for j≥1. Wait, no: p^n in base p is 1 followed by n zeros, so the digits are m_0=0, m_1=0,..., m_{n}=1. Wait, indexing might be off. Let me correct: p^n is written as 1 followed by n zeros, so the digits are m_n=1, m_{n-1}=0, ..., m_0=0. So when applying Lucas' theorem, the binomial coefficient C(p^n, i) mod p is the product of C(m_j, i_j), where i_j are the digits of i in base p. Since m_j=0 for all j <n, and m_n=1. So if i has any non-zero digit beyond the nth position, but since i < p^n, its digits are up to n-1. So the digits of i are i_0, i_1, ..., i_{n-1}. The digits of p^n are 1 followed by n zeros, which means in Lucas' theorem, we need to consider the digits of i up to the nth place. But the nth digit of i is 0 (since i < p^n). So the binomial coefficient C(p^n, i) ≡ C(1,0) * product_{j=0}^{n-1} C(0, i_j). Since C(0, i_j) is 0 if i_j >0, and 1 if i_j=0. But since 0 < i < p^n, at least one digit i_j for j <n is non-zero. Hence, the product will be zero mod p. Therefore, C(p^n, i) ≡0 mod p. Hence, p divides C(q, i). \n\nThis uses Lucas' theorem, which might be considered elegant. The user asked for the most elegant and simple way. If Lucas' theorem is allowed, then this is a straightforward proof. However, if Lucas' theorem is considered too advanced, then maybe an alternative approach using Legendre's formula and digit sums would be needed, but that might be more involved. \n\nAlternatively, using induction on n. For n=1, it's the base case, which holds as explained earlier. Assume true for n=k, that C(p^k, i) is divisible by p for 0 < i < p^k. Now consider n=k+1. How to relate C(p^{k+1}, i) to C(p^k, j)? Maybe using generating functions or combinatorial identities. But I'm not sure. \n\nAnother approach: expand (1 + x)^{p^n} mod p. By the freshman's dream, (1 + x)^{p} ≡1 + x^p mod p. Then iterating this, (1 + x)^{p^n} ≡1 + x^{p^n} mod p. Therefore, all coefficients except for 1 and x^{p^n} are divisible by p. Hence, C(p^n, i) ≡0 mod p for 0 <i <p^n. This is a simple and elegant proof using the freshman's dream. \n\nThis seems to be the simplest way. Let me elaborate. The freshman's dream states that (a + b)^p ≡a^p + b^p mod p. Applying this recursively, (1 + x)^{p^n} = ((1 + x)^p)^{p^{n-1}}} ≡(1 + x^p)^{p^{n-1}}} mod p. Then applying it again, ≡ (1 + x^{p^{n}} ) mod p. Hence, the expansion of (1 + x)^{p^n} mod p has only two non-zero terms: 1 and x^{p^n}. Therefore, all coefficients C(p^n, i) for 0 <i <p^n are divisible by p. \n\nThis is indeed a simple and elegant proof, using induction and the freshman's dream. This is likely the answer the user is looking for.",
    "Original_Problem": "Assumption: \n$p$ is a prime number,\n$q$ is a power of $p$ (i.e., $q = p^n$ for some integer $n \\geq 1$),\n$i$ is an integer satisfying $0 < i < q$.\nProblem: \nProve that $p$ divides the binomial coefficient $\\dbinom{q}{i}$.",
    "Original_Problem_with_numerical_assumption": "Assumption:\nAssumption 1: $p$ is a prime number,\nAssumption 2: $q$ is a power of $p$ (i.e., $q = p^n$ for some integer $n \\geq 1$),\nAssumption 3: $i$ is an integer satisfying $0 < i < q$.\nProblem: \nProve that $p$ divides the binomial coefficient $\\dbinom{q}{i}$.",
    "Proof_problem": "Yes",
    "Redundant_assumption": "$$\\begin{align}v_p((q-i)!)+v_p(i!) &= \\sum_{k=1}^n \\left\\lfloor\\frac{p^n-i}{p^k}\\right\\rfloor + \\left\\lfloor\\frac{i}{p^k}\\right\\rfloor \\\\ &=\\sum_{k=1}^n \\left(p^{n-k} + \\left\\lfloor\\frac{-i}{p^k}\\right\\rfloor + \\left\\lfloor\\frac{i}{p^k}\\right\\rfloor\\right) \\\\&=\\frac{p^n-1}{p-1}-(n-v_p(i)).\\end{align}$$",
    "Problem_with_redundant_assumption": "Assumption:\nAssumption 1: $p$ is a prime number,\nAssumption 2: $q$ is a power of $p$ (i.e., $q = p^n$ for some integer $n \\geq 1$),\nAssumption 3: $i$ is an integer satisfying $0 < i < q$.\nAssumption 4: $$\\begin{align}v_p((q-i)!)+v_p(i!) &= \\sum_{k=1}^n \\left\\lfloor\\frac{p^n-i}{p^k}\\right\\rfloor + \\left\\lfloor\\frac{i}{p^k}\\right\\rfloor \\\\ &=\\sum_{k=1}^n \\left(p^{n-k} + \\left\\lfloor\\frac{-i}{p^k}\\right\\rfloor + \\left\\lfloor\\frac{i}{p^k}\\right\\rfloor\\right) \\\\&=\\frac{p^n-1}{p-1}-(n-v_p(i)).\\end{align}$$\nProblem: \nProve that $p$ divides the binomial coefficient $\\dbinom{q}{i}$."
}