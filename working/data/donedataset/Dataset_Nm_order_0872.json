{
    "Link_API": "https://api.stackexchange.com/2.3/questions/2887978",
    "Title": "Binomial Coefficients involving Prime Powers Minus 1",
    "Score": 26,
    "Category": "Chứng minh",
    "Tags": "number-theory, reference-request, summation, prime-numbers, binomial-coefficients",
    "Link": "https://math.stackexchange.com/questions/2887978/binomial-coefficients-involving-prime-powers-minus-1",
    "Content": "I would like to show the following is true;  Let $p\\in\\mathbb{P}, \\alpha,n\\in\\mathbb{N}$.  Then $$p^\\alpha\\mid\\sum_{k=1}^{n-1}\\binom{(p^\\alpha-1)n}{(p^\\alpha -1)k}.$$ I've never worked with prime powers inside binomial coefficients.  I was hoping to see if there are any theorems, papers, or other research materials that deal with these types of objects.  The reason for the belief is due to a Mathematica calculation that I ran that suggests this holds so long as the binomial coefficient involves multiples of $m=p^\\alpha-1$. Here is the calculation. The green rows represent the values of $m$ from 2 to 30 that support the divisibility claim.  These numbers in order are $$2,3,4,6,7,8,10,12,15,16,18,22,24,26,28,30$$ and these numbers, when entered into OEIS.org return that these numbers are prime powers minus one.  (i ran the calculation again from $m=31..50$ to ensure this was the correct sequence, as for $m=1$ to $30$ yield a similar sequence...but i verified that $44$ is not a value of $m$ that produces divisibility).  I know that this does not constitute a proof, and in NT, 40 is so small a number to test.  But I reran the calculation for $n$ up to $100$ and $m$ up to $100$ and it still seems to hold.  If this is true, it must be due to the nature of $p^{\\alpha}-1$ as apposed to $p^{\\alpha}\\cdot k-1$, where $k$ is some other integer. I know that $p^\\alpha-1=(p-1)(p^{\\alpha-1}+p^{\\alpha-2}+...+p+1)$ but I can't see how this helps.  Are there properties of cyclotomic polynomials that help? EDIT: This question is directly related.  Thank you.",
    "AcceptedAnswer": "The claim is true. Summary: we show by induction it is enough to prove\nthe congruence for $A_m$ for $m = 1,\\ldots, k$ where $N+1 = p^k$,\nand then we prove that by showing (in this particular case) that the\nbinomial coefficients are all divisible by $p^k$ (which doesn't hold in general). Let\n$$A_m =  \\sum_{j=0}^{m} \\binom{Nm}{Nj}.$$\nThe claim to be proven is $A_m \\equiv 2 \\mod N+1$ if $N + 1 = p^k$ is a prime power. Note that $$(1 + x)^{Nm} = \\sum_{j=0}^{Nm} \\binom{Nm}{j} x^j,$$ if one lets $\\zeta$ denote a primitive $N$th root of unity, then $$ \\sum_{i=0}^{N-1} (1 + \\zeta^i)^{Nm} = \\sum_{j=0}^{Nm} \\binom{Nm}{j} \\sum_{i=0}^{N-1} \\zeta^{ji}$$\n$$ = \\sum_{j=0}^{Nm} \\binom{Nm}{j} \\begin{cases}\nN, & j \\equiv 0 \\mod N \\\\\n0, & j \\not\\equiv 0 \\mod N. \\end{cases}$$\n$$ = N \\sum_{j=0}^{m} \\binom{Nm}{Nj}.$$\nSo if, for $m \\ge 1$,\n$$B_m =  \\sum_{i=0}^{N-1} (1 + \\zeta^i)^{Nm} =  \\sum_{\\zeta^i \\ne -1} (1 + \\zeta^i)^{Nm},$$\nthen the congruence $A_m \\equiv 2 \\mod (N+1)$ is equivalent to the congruence $B_m \\equiv - 2 \\mod (N+1)$. The roots of unity are all distinct modulo $p$, so there is a unique $\\zeta^i \\equiv -1 \\mod p$. If $p$ is odd, then $N$ is even, and it is $\\zeta^{i} = -1$, and $(1 + \\zeta^i) = 0$. If $p = 2$, then $N$ is odd, and it is $\\zeta^i = 1$ and $(1 + \\zeta^i) = 2$. In the latter case, for $m \\ge 1$, the term $(1 + \\zeta^i)^N$ is equal to $2^N$ which is certainly trivial modulo $2^k = N+1$ because $2^N \\ge N+1 = 2^k$.\nHence we have $$B_m =  \\sum_{\\zeta^i \\ne -1} (1 + \\zeta^i)^{Nm}  \\equiv  \\sum_{\\zeta^i \\not\\equiv -1} (1 + \\zeta^i)^{Nm} \\mod p^k.$$ The polynomial $X^N - 1$ is separable over $\\mathbf{F}_p$. \nMoreover, its roots over this field are precisely the units of $\\mathbf{F}_q$, since the\nunits in that field are cyclic of order $q -  1 = N$.\nHence the extension cut\nout by the roots of unity $\\zeta^i$ over $\\mathbf{Q}_p$ is just the fraction field of the Witt\nvectors $W(\\mathbf{F}_q)$. All of this is just to say (if you don't know algebraic\nnumber theory) that it makes sense to talk of congruences for these algebraic\nintegers modulo powers of $p$, and that we also have (assuming $\\zeta^i \\not\\equiv -1 \\mod p$):\n$$(1 + \\zeta^i)^N \\equiv 1 \\mod p$$\nHence it also follows that\n$$((1 + \\zeta^i)^{N} - 1)^k \\equiv 0 \\mod p^k$$\nBut then, for any non-negative integer $r$, we have:\n$$\\sum_{\\zeta^i \\not\\equiv -1} ((1 + \\zeta^i)^{N} - 1)^k (1 + \\zeta^i)^{Nr} \\equiv 0 \\mod p^k,$$\nor, expanding out:\n$$ \\sum_{r=0}^{k} B_{n+ r}  (-1)^r \\binom{k}{r}  \\equiv 0 \\mod p^k,$$\nand thus we obtain the $k$-term recurrence \n$$B_{n+k} (-1)^{k-1} = \\sum_{r=0}^{k-1} B_{n+r} (-1)^r \\binom{k}{r} \\mod p^k$$\nSuppose that $B_m \\equiv -2 \\mod p^k$ for $m = 1, \\ldots, k$.\nThen, by induction, we get $B_m \\equiv -2 \\mod p^k$ for all $m$, simply\nby applying the recurrence above and using the identity\n$$\\sum (-1)^r \\binom{k}{r} = 0.$$\nSo we just need to prove the first few values of $A_m \\equiv 2 \\mod p^k$.\nBut now we can look at the actual binomial coefficients themselves. Suppose that $N+1 = p^k$. We claim that, in the range $a+b \\le k$ and $a,b > 0$, we have\n$$\\binom{N(a+b)}{Nb} \\equiv 0 \\mod p^k.$$\nOnce we know this, it follows that $A_m \\equiv 2 \\mod p^k$\nfor $m \\le k$ and we are done by induction. In fact, since trivially $k \\le p^k$, we are done by the following stronger claim. Claim Suppose that $a + b  \\le p^k$ and  $N + 1 = p^k$. Then the $p$-adic valuation of\n$$\\binom{N(a+b)}{Nb}$$\nfor $a,b \\ge 1$ is exactly $k$. Proof The $p$-adic valuation of the binomial coefficient  is precisely\nthe number of times one has to carry the one when adding $Na$ and $Nb$.\nFor a number $0 \\le m-1 < p^k$ (which includes $a-1$, $b-1$, and $c = a+b-1$, we may\nwrite\n$$m - 1 = (m_{k-1}, m_{k-2}, \\ldots, m_0)$$\nin base $p$, and we may also write\n$$p^k - m = (p^k - 1) - (m - 1) = (m'_{k-1}, m'_{k-2}, \\ldots, m'_0).$$\nSince\n$$m-1 + (p^k - m) = p^k - 1,$$\nwe have, for all $i = 0,1,\\ldots,k-1$, that\n$$m_i + m'_i = p - 1.$$\nWe now find that $aN$,  $bN$, and $cN$ have $p$-adic expansions as follows\n$$aN = (a_{k-1}, a_{k-2}, \\ldots, a_0,a'_{k-1}, \\ldots, a'_0),$$\n$$bN = (b_{k-1}, b_{k-2}, \\ldots, b_0,b'_{k-1}, \\ldots, b'_0),$$\n$$cN = (c_{k-1}, c_{k-2}, \\ldots, c_0,c'_{k-1}, \\ldots, c'_0),$$\nAs noted before, we have\n$$a_i + a'_i = p-1,  \\  b_i + b'_i = p-1, c_i + c'_i = p -1.$$\nHence\n$$(a_i + b_i) + (a'_i + b'_i) = (c_i + c'_i) + p - 1,$$\nor\n$$(a_i + b_i - c_i) + (a'_i + b'_i - c'_i) = p - 1.$$ Now $$a_i + b_i = c_i + \n\\begin{cases} p & \\text{carry required} \\\\\n0 & \\text{no carry required}\\end{cases} \\\n+ \\begin{cases} -1 & \\text{carry required in $i-1$ slot} \\\\\n0 & \\text{no carry required in $i-1$ slot} \\end{cases}$$\nand the same with $a'_i$, $b'_i$, and $c'_i$. There is a unique way of writing $p-1$ as a sum of exactly two terms in the set $\\{p,0,-1,0\\}$.\nIt follows that in the pair of slots $(i,i+k)$, either exactly one of\nthe pairs coming from the $m_i$-coefficient and the $m'_i$ coefficient requires \"carrying the one,\"\n(It also follows that exactly one of the pairs $m_{i-1}$ and $m'_{i-1}$ (which might be $m'_k$ if $i = 0$) also requires carrying the one, although this is the same statement for $i-1$ instead of $i$. This is why the sum is $p-1$ and not $p$.) But since exactly one of the pair coming\nfrom the $m_i$-coefficient and the $m'_i$ coefficient requires \"carrying the one,\"\nexactly half the terms have this property,\nand we are done. Additional : A weaker version of the induction argument is as follows.\nBy the analog of Fermat's Little Theorem and Euler's Theorem in $W(\\mathbf{F}_q)$ ($q = p^k$), one has the identity \n$$\\gamma^{N p^{k-1}} = \\gamma^{(q-1)p^{k-1}} \\equiv 1 \\mod p^k$$\n for any $\\gamma \\in W(\\mathbf{F}_q)^{\\times}$, that is, any $\\gamma \\not\\equiv 0 \\mod p$. It follows that $$\\begin{aligned}\nB_{m + p^{k-1}} = & \\ \\sum_{\\zeta^i \\not\\equiv - 1} (1 + \\zeta^i)^{mN + N p^{k-1}}\\\\\n \\equiv & \\  \\sum_{\\zeta^i \\not\\equiv - 1} (1 + \\zeta^i)^{mN} \\mod p^k\\\\\n = & \\ B_m \\mod p^k, \\end{aligned}$$\nand so by induction it suffices to show that $B_m \\equiv -2 \\mod p^k$ for $m = 1, \\ldots, p^{k-1}$ rather than $m = 1, \\ldots, k$. Since the second step actually proves the congruence $B_m \\equiv -2 \\mod p^k$ for $m = 1, \\ldots, p^k$, this also suffices, and one might find this version of the inductive step slightly easier.",
    "llm_answer_create_structured_problem": "###BEGIN_OF_FORMAT###\nAssumption: \n$p$ is a prime number,\n$\\alpha$ is a natural number,\n$n$ is a natural number.\nProblem: \nShow that $$p^\\alpha \\mid \\sum_{k=1}^{n-1}\\binom{(p^\\alpha-1)n}{(p^\\alpha -1)k}.$$\n###",
    "reasoning_create_structured_problem": "Alright, let me try to parse this problem and structure it according to the required format. The user wants me to act as a bilingual math professor, filter the irrelevant information from the Math Stack Exchange question, and present the problem with clear assumptions and the problem statement. \n\nFirst, looking at the original question: the user is trying to show that for a prime number p, natural numbers α and n, the sum of certain binomial coefficients is divisible by p^α. Specifically, the binomial coefficients are of the form binomial((p^α -1)n, (p^α -1)k) summed from k=1 to n-1. \n\nThe question mentions some computational verification using Mathematica, references to OEIS sequences, and thoughts about cyclotomic polynomials. However, these are part of the user's exploration and not part of the actual problem's assumptions or statement. The core assumptions are that p is a prime, α and n are natural numbers. The problem is to prove the divisibility of the sum by p^α.\n\nI need to list each assumption line by line, each addressing one property of a single object. So, the assumptions would be:\n- p is a prime number (given p ∈ ℙ)\n- α is a natural number (α ∈ ℕ)\n- n is a natural number (n ∈ ℕ)\n\nThe problem statement is to show that p^α divides the sum from k=1 to n-1 of the binomial coefficients as given.\n\nThe user's discussion about OEIS, Mathematica calculations, and cyclotomic polynomials are additional context but not part of the problem's formal assumptions. The key elements are p being prime, α and n being natural numbers, and the divisibility of the sum by p^α. \n\nI should make sure that each assumption is separate. So, three separate lines for p, α, and n. The problem is then the divisibility statement.",
    "Original_Problem": "Assumption: \n$p$ is a prime number,\n$\\alpha$ is a natural number,\n$n$ is a natural number.\nProblem: \nShow that $$p^\\alpha \\mid \\sum_{k=1}^{n-1}\\binom{(p^\\alpha-1)n}{(p^\\alpha -1)k}.$$",
    "Original_Problem_with_numerical_assumption": "Assumption:\nAssumption 1: $p$ is a prime number,\nAssumption 2: $\\alpha$ is a natural number,\nAssumption 3: $n$ is a natural number.\nProblem: \nShow that $$p^\\alpha \\mid \\sum_{k=1}^{n-1}\\binom{(p^\\alpha-1)n}{(p^\\alpha -1)k}.$$",
    "Proof_problem": "Yes",
    "Redundant_assumption": "$$ \\sum_{r=0}^{k} B_{n+ r}  (-1)^r \\binom{k}{r}  \\equiv 0 \\mod p^k,$$",
    "Problem_with_redundant_assumption": "Assumption:\nAssumption 1: $p$ is a prime number,\nAssumption 2: $\\alpha$ is a natural number,\nAssumption 3: $n$ is a natural number.\nAssumption 4: $$ \\sum_{r=0}^{k} B_{n+ r}  (-1)^r \\binom{k}{r}  \\equiv 0 \\mod p^k,$$\nProblem: \nShow that $$p^\\alpha \\mid \\sum_{k=1}^{n-1}\\binom{(p^\\alpha-1)n}{(p^\\alpha -1)k}.$$"
}