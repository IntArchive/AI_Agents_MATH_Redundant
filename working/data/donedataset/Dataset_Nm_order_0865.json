{
    "Link_API": "https://api.stackexchange.com/2.3/questions/589344",
    "Title": "On prime factors of $n^2+1$",
    "Score": 26,
    "Category": "Chứng minh",
    "Tags": "number-theory, reference-request, prime-numbers, analytic-number-theory",
    "Link": "https://math.stackexchange.com/questions/589344/on-prime-factors-of-n21",
    "Content": "It is a well-known conjecture that there are infinitely many primes of the form $n^2+1$. However, there are weaker results that one can prove. For example, There are infinitely many positive integers $n$ such that $n^2+1$ has\n  a prime divisor greater than $2n+\\sqrt{2n}$. This was Problem N6 in IMO 2008 Shortlist. See solution here (in page 50). It is remarked there that by tools of analytic number theory (using distribution of prime numbers of the form $4k+1$ somehow), one can show something considerably stronger, namely: Theorem. There are infinitely many positive integers $n$ such that $n^2+1$ has\n  a prime divisor greater than $n\\log(n)$. I would appreciate if someone gave a proof of the Theorem or provide a reference where it is proved.",
    "AcceptedAnswer": "In this answer I will prove that for any $\\epsilon>0$, there are infinitely many primes $p$ with $p>(1-\\epsilon)n\\log n$ and $p\\mid n^2+1$. The idea is to bound the product $$H(N)=\\prod_{n\\leq N}(n^{2}+1)$$ in two different ways, and is similar in spirit to Erdős' proof of Chebyshev's inequalities${}^{**}$. Lower bound: Notice that $$H(N)\\geq\\prod_{n\\leq N}n^{2}=(N!)^{2}\\geq N^{2N}/e^{2N-2},$$ and so $$\\log(H(N))\\geq2N\\log N-(2N-2). \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ (1)$$ Upper bound: This is the meat of the argument. Lets assume that $H(N)$  has no prime divisor greater than a parameter $w$ which is chosen so that $w>N$. Our end goal is to show that $w$ cannot be too small, as this implies that $n^2+1$ will have large prime divisors for some $n$. Writing $H(N)$ as a product of primes, we have $$H(N)=\\prod_{p\\leq w}p^{\\alpha_{p}}$$ for some coefficients $\\alpha_{p}$. Each prime $p>x$ can divide $n^{2}+1$ for at most two different values of $n$, and so we see that $\\alpha_{p}\\leq2$ in this case. For $p\\leq x$, if $p\\mid n^{2}+1$, then $n^{2}\\equiv-1\\text{ mod }p$. This congruence can only be solved when $p\\equiv1\\text{ mod }4$, and in that case there will be at most $2\\lceil N/p\\rceil$  values of $n$ for which $p\\mid n^{2}+1$. Similarly, if $p^{k}\\mid n^{2}+1$, then $n^{2}\\equiv-1\\text{ mod }p^{k}$, and there are at most $\\gcd(\\phi(p^{k}),2)=2$ solutions to this congruence, and hence at most $2\\lceil N/p^{k}\\rceil$  values of $n$ for which $p^{k}\\mid n^{2}+1$. Putting this all together, we find that for $p\\leq N$, and $$p\\equiv1\\text{ mod }4 ,\\alpha_{p}\\leq2\\left\\lceil\\frac{N}{p}\\right\\rceil+2\\left\\lceil\\frac{N}{p^{2}}\\right\\rceil+2\\left\\lceil\\frac{N}{p^{3}}\\right\\rceil+\\cdots+2\\left\\lceil\\frac{N}{p^{k}}\\right\\rceil$$ where $k=\\left\\lceil\\log_{p}N\\right\\rceil.$ Using the upper bound $\\left\\lceil x\\right\\rceil\\leq x+1,$ we obtain  $$\\alpha_{p}\\leq\\frac{2N}{p-1}+2\\left(\\log_{p}(N)+1\\right)$$ since $1+\\frac{1}{p}+\\frac{1}{p^{2}}+\\cdots+\\frac{1}{p^{k}}\\leq\\frac{1}{1-1/p}.$ Thus, $$H(N)\\leq\\prod_{\\begin{array}{c}\np\\leq N\\\\\np\\equiv1\\text{ mod }4\n\\end{array}}p^{\\frac{2N}{p-1}+2\\log_{p}(N)+2}\\prod_{\\begin{array}{c}\nN<p\\leq w\\\\\np\\equiv1\\text{ mod }4\n\\end{array}}p^{2},$$ and so, noting that $p^{\\log_{p}(N)}=N,$ we have $$H(N)\\leq\\prod_{\\begin{array}{c}\np\\leq N\\\\\np\\equiv1\\text{ mod }4\n\\end{array}}N^{2}\\prod_{\\begin{array}{c}\np\\leq N\\\\\np\\equiv1\\text{ mod }4\n\\end{array}}p^{\\frac{2N}{p-1}}\\prod_{\\begin{array}{c}\np\\leq w\\\\\np\\equiv1\\text{ mod }4\n\\end{array}}p^{2}.$$ Taking the logarithm it follows that $$\\log H(N)\\leq2\\pi(N;4,1)\\log N+2N\\sum_{\\begin{array}{c}\np\\leq N\\\\\np\\equiv1\\text{ mod }4\n\\end{array}}\\frac{\\log p}{p-1}+2\\theta(w;4,1).$$ By using the prime number theorem for arithmetic progressions, we have the asymptotics $\\sum_{p\\leq N,\\ p\\equiv1\\ (4)}\\frac{\\log p}{p-1}\\sim\\frac{1}{2}\\log N$, $\\theta(w;4,1)\\sim w/2$  and $\\pi(N;4,1)\\log N\\sim N/2$, and so $$\\log H(N)\\lesssim N\\log N+w.\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ (2)$$ Combining equations $(1)$ and $(2)$ together, it follows that $$2N\\log N-(2N-2)\\leq\\log H(N)\\lesssim N\\log N+w,$$ and hence for $N>N_0(\\epsilon)$ we must have $$(1-\\epsilon)N\\log N\\leq w.$$ Since $w$ cannot be taken to smaller, this implies that for any $\\epsilon>0$, we can take $N$ large enough so that there exists $p>(1-\\epsilon)N\\log N$ such that $p\\mid H(N)$. It follows that for any $\\epsilon>0$, there are infinitely many  primes $p$ such that $$p>(1-\\epsilon) n\\log n \\text{ and } p\\mid n^{2}+1.$$ ${}^{**}$  See these three answers for more details on proving Chebyshevs estimates in a similar fashion: Chebyshev: Proof $\\prod \\limits_{p \\leq 2k}{\\;} p > 2^k$ , Are there any Combinatoric proofs of Bertrand's postulate? and How to prove Chebyshev's result: $\\sum_{p\\leq n} \\frac{\\log p}{p} \\sim\\log n $ as $n\\to\\infty$? For a similar question and solution, see this answer: Squares in $(\\operatorname{rad}(1)^2+1)\\cdot(\\operatorname{rad}(2)^2+1)\\ldots(\\operatorname{rad}(n)^2+1)$",
    "llm_answer_create_structured_problem": "###BEGIN_OF_FORMAT###\nAssumption: \n$n$ is a positive integer,\nThere are infinitely many positive integers $n$,\n$n^2 + 1$ has at least one prime divisor,\nA prime divisor of $n^2 + 1$ is greater than $n \\log(n)$.\nProblem:\nProve that there are infinitely many positive integers $n$ such that $n^2 + 1$ has a prime divisor greater than $n \\log(n)$.\n###",
    "reasoning_create_structured_problem": "Okay, let me try to tackle this problem. So the user wants me to structure the given Math Stack Exchange question into the specified format. The example provided shows that the assumptions should list each condition applied to one object, and then the problem statement.\n\nLooking at the original problem from the user: the title is \"On prime factors of n² + 1\". The question mentions a theorem that needs to be proven: There are infinitely many positive integers n such that n² +1 has a prime divisor greater than n log n. The user is asking for a proof or a reference.\n\nFirst, I need to extract the assumptions. The problem is about positive integers n and the prime factors of n² +1. The theorem states there are infinitely many such n where a prime divisor of n² +1 is greater than n log n.\n\nSo the assumptions would be:\n\n- n is a positive integer.\n- There are infinitely many such n.\n- The prime divisor in question is of the form that divides n² +1.\n- The prime divisor is greater than n log n.\n\nWait, but the problem is to prove that such n exist infinitely. So the actual assumption is the existence, but the problem is to show that. Wait, no. The assumptions are the conditions given in the problem. Let me re-express.\n\nIn the example, the assumption included that n is an integer and n is divisible by 7. Here, the theorem is that there are infinitely many n (positive integers) such that n² +1 has a prime divisor exceeding n log n. So the problem is to prove that statement. The assumptions would be the conditions given. However, since the theorem is a statement, maybe the assumptions are the premises of the theorem. Wait, but in the example, the original problem had an assumption that n is an integer, and the user added another assumption (n divisible by 7) in their formatted problem. Wait, no, in the example, the original problem was to prove for every integer n, the number A(n) is divisible by 91. But the formatted problem changed the assumption to n being an integer and n divisible by 7, leading to the problem as stated. Wait, perhaps the example might have been modified. Let me check again.\n\nOriginal example problem: Prove that for every integer n, A(n) is divisible by 91.\n\nFormatted problem's assumptions: n is an integer, n is divisible by 7. Then the problem is to prove divisibility by 91. Wait, but in the original problem, it was for every integer n, but the formatted problem adds an assumption that n is divisible by 7. So perhaps the user made a mistake here, but in any case, the example shows that the assumptions are the given conditions in the problem, each as a separate line.\n\nIn the current problem, the theorem is: There are infinitely many positive integers n such that n² +1 has a prime divisor greater than n log n. So the assumptions here are:\n\n1. n is a positive integer.\n2. There exist infinitely many such n.\n3. The prime divisor in question is of n² +1.\n4. The prime divisor is greater than n log n.\n\nWait, but actually, the problem is to prove that such n exist infinitely. So perhaps the assumptions are the given conditions of the theorem. But the theorem itself is the statement. The problem is to prove that statement, so the assumptions would be the premises under which the theorem holds. However, since the theorem is stated as a general result, maybe the only assumption is that n is a positive integer, and the problem is to show that infinitely many such n exist with the prime divisor condition.\n\nWait, perhaps in the example, the user added an assumption (n divisible by 7) even though the original problem didn't have it, but maybe the example was illustrative. But perhaps in the current problem, the assumptions are the hypotheses of the theorem. Since the theorem is a standalone statement, maybe the only assumption is that n is a positive integer. However, the problem is to show that infinitely many such n exist where n² +1 has a prime divisor exceeding n log n. So perhaps the assumptions are just that n is a positive integer, and the problem is to prove the existence of infinitely many such n with the prime divisor condition.\n\nAlternatively, maybe the problem has no explicit assumptions beyond n being a positive integer. Because the theorem is asserting a property about n, so the assumption is n being a positive integer. Then the problem is to prove that infinitely many n (positive integers) satisfy that n² +1 has a prime divisor > n log n.\n\nSo structuring this:\n\nAssumption:\n- n is a positive integer.\n\nProblem:\nProve that there are infinitely many positive integers n such that n² +1 has a prime divisor greater than n log n.\n\nBut wait, in the example, the original problem was for every integer n, but the formatted problem added an assumption that n is divisible by 7. Maybe the user made a mistake, but in this case, the theorem as stated doesn't have additional assumptions beyond n being a positive integer. Therefore, the correct formatting would be:\n\nAssumption:\n- n is a positive integer.\n\nProblem:\nProve that there are infinitely many positive integers n such that n² +1 has a prime divisor greater than n log n.\n\nAlternatively, the problem might have more assumptions, but according to the theorem statement, it's a general statement. Therefore, the answer should follow that structure.",
    "Original_Problem": "Assumption: \n$n$ is a positive integer,\nThere are infinitely many positive integers $n$,\n$n^2 + 1$ has at least one prime divisor,\nA prime divisor of $n^2 + 1$ is greater than $n \\log(n)$.\nProblem:\nProve that there are infinitely many positive integers $n$ such that $n^2 + 1$ has a prime divisor greater than $n \\log(n)$.",
    "Original_Problem_with_numerical_assumption": "Assumption:\nAssumption 1: $n$ is a positive integer,\nAssumption 2: There are infinitely many positive integers $n$,\nAssumption 3: $n^2 + 1$ has at least one prime divisor,\nAssumption 4: A prime divisor of $n^2 + 1$ is greater than $n \\log(n)$.\nProblem:\nProve that there are infinitely many positive integers $n$ such that $n^2 + 1$ has a prime divisor greater than $n \\log(n)$.",
    "Proof_problem": "Yes",
    "Redundant_assumption": "$$H(N)\\geq\\prod_{n\\leq N}n^{2}=(N!)^{2}\\geq N^{2N}/e^{2N-2},$$",
    "Problem_with_redundant_assumption": "Assumption:\nAssumption 1: $n$ is a positive integer,\nAssumption 2: There are infinitely many positive integers $n$,\nAssumption 3: $n^2 + 1$ has at least one prime divisor,\nAssumption 4: A prime divisor of $n^2 + 1$ is greater than $n \\log(n)$.\nAssumption 5: $$H(N)\\geq\\prod_{n\\leq N}n^{2}=(N!)^{2}\\geq N^{2N}/e^{2N-2},$$\nProblem:\nProve that there are infinitely many positive integers $n$ such that $n^2 + 1$ has a prime divisor greater than $n \\log(n)$."
}