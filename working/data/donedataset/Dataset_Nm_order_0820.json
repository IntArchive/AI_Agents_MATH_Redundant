{
    "Link_API": "https://api.stackexchange.com/2.3/questions/1447296",
    "Title": "How does Stirling&#39;s approximation imply for the binomial coefficient $\\binom{n}{k}\\approx \\frac{n^k}{k!}$?",
    "Score": 27,
    "Category": "Chứng minh",
    "Tags": "binomial-coefficients, approximation",
    "Link": "https://math.stackexchange.com/questions/1447296/how-does-stirlings-approximation-imply-for-the-binomial-coefficient-binomn",
    "Content": "In this proof , it is assumed that, for $k \\ll n$ , ${n \\choose k} \\approx \\frac{n^k}{k!}$ , given Stirling's approximation. How does Stirling's Approximation, in either form $\\ln n! \\approx n\\ln{n} -n + (\\ln(n))$ or $n! \\approx \\sqrt{2\\pi n} (\\frac{n}{e})^n$ , give this result?",
    "AcceptedAnswer": "Although certainly not the most efficient approach, we can use Stirling's Formula to arrive at the asymptotic expression for $\\binom{n}{k}$ .  We have $$\\frac{\\sqrt{2\\pi n}(n/e)^n}{k!\\sqrt{2\\pi(n-k)}((n-k)/e)^{n-k}}=(1-k/n)^{k-1/2}\\frac{e^{-k}}{k!(1-k/n)^{n}}n^k \\tag 1$$ Note that the first term on the right-hand side of $(1)$ tends to $1$ as $n\\to \\infty$ .  Note also that the denominator of the middle term on the right-hand side goes to $k!e^{-k}$ .  Therefore the middle term also tends to $1/k!$ .  We are left with $n^k/k!$ as expected. Note that the notation $k\\ll n$ is nebulous (See THIS note's discussion on asymptotics of the binomial coefficient).  Herein, we have tacitly assumed that $k$ is fixed and that $k=o(\\sqrt n)$ .",
    "llm_answer_create_structured_problem": "###BEGIN_OF_FORMAT###\nassumption: \n$k$ is much smaller than $n$ ($k \\ll n$),\nStirling's approximation is applicable for $n!$, $k!$, and $(n - k)!$,\nThe terms involving square roots and lower-order terms in Stirling's approximation are negligible.\nproblem: \nShow that for $k \\ll n$, the binomial coefficient satisfies $$\\binom{n}{k} \\approx \\frac{n^k}{k!}$$ using Stirling's approximation.\n###",
    "reasoning_create_structured_problem": "Okay, let's tackle this problem step by step. The user wants to understand how Stirling's approximation leads to the approximation of the binomial coefficient as n choose k ≈ n^k / k! when k is much smaller than n. \n\nFirst, I need to recall Stirling's approximation. There are a couple of forms mentioned: one involving the logarithm, ln n! ≈ n ln n - n + (ln n)/2, and another multiplicative form with the square root term. The question is how either of these can be used to derive the binomial coefficient approximation.\n\nSo, the binomial coefficient is n! / (k! (n - k)!). If k is much smaller than n, then n - k ≈ n, but I need to see how that plays into the factorials. Let's write out the binomial coefficient using factorials:\n\nC(n, k) = n! / [k! (n - k)!]\n\nUsing Stirling's approximation for n!, (n - k)!, and k! might get complicated, but maybe there's a simpler way when k is small compared to n. Let's try expanding each factorial using Stirling's formula.\n\nStarting with the multiplicative form:\nn! ≈ √(2πn) (n/e)^n\nSimilarly, (n - k)! ≈ √(2π(n - k)) ((n - k)/e)^{n - k}\nAnd k! ≈ √(2πk) (k/e)^k\n\nSubstituting these into the binomial coefficient:\nC(n, k) ≈ [√(2πn) (n/e)^n] / [√(2πk) (k/e)^k * √(2π(n - k)) ((n - k)/e)^{n - k}]\n\nSimplifying the denominators:\nThe denominator becomes √(2πk) * √(2π(n - k)) * (k^k / e^k) * ((n - k)^{n - k} / e^{n - k})\n\nCombining terms in the denominator:\n√(2πk * 2π(n - k)) = √{(2π)^2 k(n - k)} = 2π√[k(n - k)]\nThe e terms in the denominator: e^k * e^{n - k} = e^n\nThe numerator has √(2πn) and (n/e)^n.\n\nSo putting it all together:\nC(n, k) ≈ [√(2πn) (n^n / e^n)] / [2π√(k(n - k)) * (k^k (n - k)^{n - k}) / e^n)]\n\nSimplify e^n cancels out:\n[√(2πn) n^n] / [2π√(k(n - k)) * k^k (n - k)^{n - k}]\n\nBreak this down:\n√(2πn) / (2π√(k(n - k))) ) * n^n / (k^k (n - k)^{n - k})\n\nSimplify the square roots:\n√(2πn) / (2π√(k(n - k))) ) = √(n) / [√(2π) √(k(n - k))]\n\nBut this seems messy. Maybe there's a better approach. Since k is much smaller than n, we can approximate (n - k) ≈ n. Let's see if that helps.\n\nFirst, look at (n - k)! ≈ n! / n^k when k is small? Wait, that might not be directly applicable. Alternatively, use the approximation for ln(n - k)! ≈ (n - k) ln(n - k) - (n - k) + (1/2) ln(2π(n - k))\n\nBut since k is much smaller than n, n - k ≈ n, so maybe expand ln(n - k) around n. Let me consider the logarithm of the binomial coefficient.\n\nln C(n, k) = ln n! - ln k! - ln (n - k)!\n\nUsing Stirling's approximation for each term:\n\nln n! ≈ n ln n - n + (1/2) ln(2πn)\nln k! ≈ k ln k - k + (1/2) ln(2πk)\nln(n - k)! ≈ (n - k) ln(n - k) - (n - k) + (1/2) ln(2π(n - k))\n\nSubtracting these:\nln C(n, k) ≈ [n ln n - n + (1/2) ln(2πn)] - [k ln k - k + (1/2) ln(2πk)] - [(n - k) ln(n - k) - (n - k) + (1/2) ln(2π(n - k))]\n\nSimplify term by term:\n\nFirst, the linear terms in n and k:\n-n - (-k) - (-(n - k)) = -n + k + n - k = 0\n\nNow the logarithmic terms:\nn ln n - (n - k) ln(n - k) - k ln k\n\nPlus the 1/2 ln terms:\n(1/2)[ln(2πn) - ln(2πk) - ln(2π(n - k))] = (1/2)[ln(n) - ln(k) - ln(n - k) + ln(2π) - ln(2π) - ln(2π))] Wait, no, let's compute it step by step:\n\nThe 1/2 terms:\n(1/2) ln(2πn) - (1/2) ln(2πk) - (1/2) ln(2π(n - k)) = (1/2)[ln(2πn) - ln(2πk) - ln(2π(n - k))]\n\n= (1/2)[ ln(n) - ln(k) - ln(n - k) ) + ln(2π) - ln(2π) - ln(2π) ) ]\n\nWait, actually, expanding each logarithm:\n\nln(2πn) = ln(2π) + ln n\nSimilarly for the others. So:\n\n= (1/2)[ (ln(2π) + ln n) - (ln(2π) + ln k) - (ln(2π) + ln(n - k)) ) ]\n\n= (1/2)[ ln n - ln k - ln(n - k) - ln(2π) ]\n\nSo combining all terms, the ln C(n,k) becomes:\n\nn ln n - (n - k) ln(n - k) - k ln k + (1/2)[ ln n - ln k - ln(n - k) - ln(2π) ]\n\nBut when k is much smaller than n, we can approximate (n - k) ≈ n. Let's expand ln(n - k) around n:\n\nln(n - k) = ln n + ln(1 - k/n) ≈ ln n - k/n - (k^2)/(2n^2) - ... \n\nBut if k is much smaller than n, terms like k/n are negligible, so maybe we can take ln(n - k) ≈ ln n - k/n. But let's see:\n\nLet me expand (n - k) ln(n - k) ≈ (n - k)(ln n - k/n) = (n - k) ln n - (n - k)(k/n)\n\n≈ n ln n - k ln n - k + (k^2)/n\n\nSimilarly, the term n ln n - (n - k) ln(n - k) ≈ n ln n - [n ln n - k ln n - k + (k^2)/n] = k ln n + k - (k^2)/n\n\nThen the term -k ln k remains.\n\nSo putting together:\n\nln C(n, k) ≈ [k ln n + k - (k^2)/n] - k ln k + (1/2)[ ln n - ln k - ln(n - k) - ln(2π) ]\n\nBut since k is small compared to n, (k^2)/n is negligible, so we can ignore that term. Also, ln(n - k) ≈ ln n, so ln n - ln(n - k) ≈ 0. Therefore, the 1/2 term simplifies to:\n\n(1/2)[ ln n - ln k - ln n - ln(2π) ] = (1/2)[ - ln k - ln(2π) ] = - (1/2)(ln k + ln(2π))\n\nPutting all together:\n\nln C(n, k) ≈ k ln n + k - k ln k - (1/2)(ln k + ln(2π))\n\nBut wait, the term k - (1/2)(ln k + ln(2π))... But if k is fixed and n is large, the dominant terms are k ln n - k ln k + k. Because ln n is large, but ln k is constant. The other terms are lower order.\n\nSo approximating:\n\nln C(n, k) ≈ k ln n - k ln k + k\n\nWhich is equal to ln(n^k / k!) + k. Wait, because ln(n^k / k!) = k ln n - ln k! ≈ k ln n - (k ln k - k) ) [using Stirling for k! ≈ k ln k - k]. So ln(n^k / k!) ≈ k ln n - (k ln k - k) = k ln n - k ln k + k. Which matches the leading terms here.\n\nTherefore, exponentiating both sides:\n\nC(n, k) ≈ e^{k ln n - k ln k + k} = e^{k ln(n/k) + k} = (n/k)^k e^k = n^k / k^k * e^k\n\nWait, but that's not exactly n^k / k! Let's see. Because if we have Stirling's approximation for k! ≈ sqrt(2πk) (k/e)^k, then k! ≈ sqrt(2πk) k^k e^{-k}, so 1/k! ≈ e^{k} / (sqrt(2πk) k^k). So n^k / k! ≈ n^k e^{k} / (sqrt(2πk) k^k). \n\nBut according to our previous approximation, we have C(n, k) ≈ n^k / k^k * e^k. But this is missing the sqrt(2πk) term. However, if in the approximation, when k is small compared to n, the sqrt terms might be considered negligible compared to the exponential and polynomial terms. Especially if k is fixed and n is large, the leading term is n^k / k!, so the approximation C(n, k) ≈ n^k / k! becomes valid when the other factors (like sqrt(2πk)) are neglected. \n\nAlternatively, the user's question mentions that the approximation is given by Stirling's approximation, but the example shows C(n, k) ≈ n^k / k!. So maybe under the assumption that k is small compared to n, the sqrt terms in Stirling's formula become negligible. For example, when n is very large and k is fixed, the term sqrt(2πn) / sqrt(2π(n - k)) approximates to sqrt(n/(n - k)) ≈ 1 + k/(2n), which approaches 1 as n becomes large. Similarly, the sqrt(2πk) is a constant if k is fixed. So the ratio of the sqrt terms would be sqrt(n) / (sqrt(k) sqrt(n - k)) ) ≈ sqrt(n/(k(n - k))) ≈ 1 / sqrt(k n). But since k is fixed and n is large, this term tends to zero. Wait, but that would mean the approximation tends to zero, which contradicts. Hmm, maybe I messed up here.\n\nWait, let's go back to the original substitution using the multiplicative Stirling's formula:\n\nC(n, k) ≈ [sqrt(2πn) (n/e)^n] / [sqrt(2πk) (k/e)^k * sqrt(2π(n - k)) ((n - k)/e)^{n - k}]\n\n= [sqrt(2πn) / (sqrt(2πk) sqrt(2π(n - k))) ] * [n^n / (k^k (n - k)^{n - k})] * [e^{n} / (e^{k} e^{n - k})]\n\nSimplifying the exponents: e^{n} / (e^{k + n - k}) ) = e^{n} / e^{n} = 1.\n\nSo we have:\n\nC(n, k) ≈ [sqrt(n) / (sqrt(k) sqrt(n - k)) sqrt(2π)) ] * [n^n / (k^k (n - k)^{n - k})]\n\nNow, if k is much smaller than n, then n - k ≈ n, so (n - k)^{n - k} ≈ n^{n - k} e^{-k} (using the approximation (1 - k/n)^n ≈ e^{-k} when k is small compared to n). Wait, maybe that's a different approach. Let's try to approximate (n - k)^{n - k}:\n\nTake logarithm: (n - k) ln(n - k) = (n - k)(ln n + ln(1 - k/n)) ≈ (n - k)(ln n - k/n) ≈ n ln n - k ln n - k + k^2 /n\n\nBut again, if k is much smaller than n, the term k^2 /n is negligible. So:\n\n(n - k)^{n - k} ≈ e^{n ln n - k ln n -k} = n^{n} n^{-k} e^{-k} = n^{n -k} e^{-k}\n\nTherefore, substituting back into the expression for C(n, k):\n\nC(n, k) ≈ [sqrt(n) / (sqrt(k) sqrt(n - k)) sqrt(2π)) ] * [n^n / (k^k * n^{n -k} e^{-k})]\n\nSimplify numerator and denominator:\n\nn^n / (k^k * n^{n -k} e^{-k}) = n^k e^{k} / k^k\n\nTherefore, C(n, k) ≈ [sqrt(n) / (sqrt(k) sqrt(n - k)) sqrt(2π)) ] * (n^k e^{k} / k^k )\n\nAgain, if k is much smaller than n, sqrt(n - k) ≈ sqrt(n), so sqrt(n)/sqrt(n - k) ≈ sqrt(n)/sqrt(n) = 1. Then, the term becomes:\n\n[1 / (sqrt(k) sqrt(2π)) ] * (n^k e^{k} / k^k )\n\nSo:\n\nC(n, k) ≈ (n^k / k^k) * (e^k / sqrt(2πk))\n\nBut using Stirling's approximation for k!:\n\nk! ≈ sqrt(2πk) (k/e)^k → 1/k! ≈ e^k / (sqrt(2πk) k^k )\n\nTherefore, (n^k / k^k) * (e^k / sqrt(2πk)) ) ≈ n^k / k! \n\nHence, the approximation C(n, k) ≈ n^k / k! comes from retaining the dominant terms when k is small compared to n, and the factors involving sqrt(2πk) and similar terms become negligible or cancel out. Specifically, the ratio between the Stirling approximation and the simple n^k /k! is sqrt(n)/(sqrt(n -k) sqrt(2π)), which for k ≪ n becomes approximately 1/sqrt(2πk), but if k is fixed and n approaches infinity, this term becomes negligible compared to the polynomial/exponential terms, so it can be omitted in the leading approximation.\n\nTherefore, the conclusion is that when k is much smaller than n, the binomial coefficient can be approximated by n^k /k! using Stirling's approximation, with the other terms being lower order and thus negligible in this limit.",
    "Original_Problem": "assumption: \n$k$ is much smaller than $n$ ($k \\ll n$),\nStirling's approximation is applicable for $n!$, $k!$, and $(n - k)!$,\nThe terms involving square roots and lower-order terms in Stirling's approximation are negligible.\nproblem: \nShow that for $k \\ll n$, the binomial coefficient satisfies $$\\binom{n}{k} \\approx \\frac{n^k}{k!}$$ using Stirling's approximation.",
    "Original_Problem_with_numerical_assumption": "Assumption:\nAssumption 1: $k$ is much smaller than $n$ ($k \\ll n$),\nAssumption 2: Stirling's approximation is applicable for $n!$, $k!$, and $(n - k)!$,\nAssumption 3: The terms involving square roots and lower-order terms in Stirling's approximation are negligible.\nProblem: \nShow that for $k \\ll n$, the binomial coefficient satisfies $$\\binom{n}{k} \\approx \\frac{n^k}{k!}$$ using Stirling's approximation.",
    "Proof_problem": "Yes",
    "Redundant_assumption": "$$\\frac{\\sqrt{2\\pi n}(n/e)^n}{k!\\sqrt{2\\pi(n-k)}((n-k)/e)^{n-k}}=(1-k/n)^{k-1/2}\\frac{e^{-k}}{k!(1-k/n)^{n}}n^k \\tag 1$$",
    "Problem_with_redundant_assumption": "Assumption:\nAssumption 1: $k$ is much smaller than $n$ ($k \\ll n$),\nAssumption 2: Stirling's approximation is applicable for $n!$, $k!$, and $(n - k)!$,\nAssumption 3: The terms involving square roots and lower-order terms in Stirling's approximation are negligible.\nAssumption 4: $$\\frac{\\sqrt{2\\pi n}(n/e)^n}{k!\\sqrt{2\\pi(n-k)}((n-k)/e)^{n-k}}=(1-k/n)^{k-1/2}\\frac{e^{-k}}{k!(1-k/n)^{n}}n^k \\tag 1$$\nProblem: \nShow that for $k \\ll n$, the binomial coefficient satisfies $$\\binom{n}{k} \\approx \\frac{n^k}{k!}$$ using Stirling's approximation."
}