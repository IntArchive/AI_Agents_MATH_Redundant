{
    "Link_API": "https://api.stackexchange.com/2.3/questions/631289",
    "Title": "Dual of a rational convex polyhedral cone",
    "Score": 12,
    "Category": "Chứng minh",
    "Tags": "convex-analysis, toric-geometry",
    "Link": "https://math.stackexchange.com/questions/631289/dual-of-a-rational-convex-polyhedral-cone",
    "Content": "A rational convex polyehedral cone $\\sigma\\subseteq\\mathbb R^n$ is a set of the form\n$$ \\sigma=\\operatorname{Cone}(u_1,\\dots,u_k) := \\left\\{ \\sum_{i=1}^k r_i u_i \\,\\Bigg|\\, r_i\\ge 0\\right\\}\\subseteq\\mathbb R^n,$$\nwhere all $u_i\\in\\mathbb Z^n$. I'm interested in what is really involved in proving the following statements: $\\sigma^\\vee = \\{ v\\in \\mathbb R^n \\,|\\, \\langle u,v\\rangle \\ge 0 \\,\\forall u\\in\\sigma\\}$ is a rational convex polyhedral cone. $\\sigma^{\\vee \\vee} = \\sigma$. I've seen proofs for both statements in the general (not necessarily rational) case using first the Hahn-Banach theoreom to proof the second statement and then use this to proof the first. Do we really need to involve functional analysis for the proof (in finite dimensions and only for rational cones) or is it possible to somehow construct normal vectors of the facets of the cone that will generate the dual cone using only tools from convex/polyhedral geometry? An elementary proof of this, not involving functional analysis, would allow a more 'down to earth' approach to start toric geometry, since these statements are needed to start working with affine toric varieties given from rational convex polyhedral cones $\\sigma$ as $\\operatorname{Spec}(\\mathbb C[\\sigma^\\vee\\cap\\mathbb Z^n])$.",
    "AcceptedAnswer": "Indeed, all except perhaps property (2) can be proved without functional analysis.  It leads to a completely deterministic algorithm to compute a basis for the dual cone (not a very good algorithm though as its complexity\nis exponential in the initial basis size). In the sequel RCP is shorthand for “rational convex polyhedral\ncone”. Nearly everything reduces to the iteration of the following lemma: Fundamental lemma. Let $\\sigma={\\sf Cone}(u_1,\\ldots,u_k)$ be a RPC cone. Let\n$w\\in{{\\mathbb Z}^d}$, and $\\sigma_w=\\lbrace x\\in\\sigma \\,|\\, \\langle x,w\\rangle\\  \\geq 0\\rbrace$. Then\n$\\sigma_w$ is again a RPC cone. In fact, a completely explicit generating set can be\nfound, as follows. Let $$\n\\begin{array}{lcl}\nI_{-} &=& \\big\\lbrace i \\ \\big|\\ \\langle u_i,w\\rangle \\ < 0 \\big\\rbrace \\\\\nI_{0} &=& \\big\\lbrace i \\ \\big|\\ \\langle u_i,w\\rangle \\ = 0 \\big\\rbrace \\\\ \nI_{+} &=& \\big\\lbrace i \\ \\big|\\ \\langle u_i,w\\rangle \\ < 0 \\big\\rbrace \\\\\n\\end{array}\n$$ Then $\\sigma_w={\\sf Cone}({\\cal F})$ where $$\n{\\cal F}=\\big\\lbrace u_i\\ \\big|\\ i \\in I_0 \\cup I_{+}\\big\\rbrace \\cup\n\\big\\lbrace \\langle u_j,w\\rangle u_i-\\langle u_i,w\\rangle u_j\\ \\big| \\ i \\in I_{-}, j\\in I_{+}\\big\\rbrace\n$$ To show this fundamental lemma we need another : Lemma 1. Let $n,m \\geq 1$ be two integers. Let $x_1,x_2,\\ldots,x_n$\nand $y_1,y_2,y_3, \\ldots ,y_m$ be nonnegative numbers. Then the\nfollowing are equivalent : (i) $x_1+x_2+ \\ldots +x_n \\geq y_1+\\ldots +y_m$ (ii) There exists nonnegative numbers $\\xi_k(1\\leq k\\leq n)$ and \n$t_{ij}(1\\leq i \\leq n,1\\leq j \\leq n)$ such that\n$x_i=\\xi_i+\\sum_{j}t_{ij}$ for every $i$ and \n$y_j=\\sum_{i}t_{ij}$ for every $j$. Proof of lemma 1. The direction (ii)$\\Rightarrow$(i) is easy because\nunder the hypothesis of (ii) we have $$\n\\big(\\sum_{i} x_i\\big)-\\big(\\sum_{j} y_j\\big)=\n\\big(\\sum_{i} \\xi_i\\big) \\geq 0\n$$ Conversely, we are going to show (i)$\\Rightarrow$(ii) by induction on\n$N=n+m$.\nThe base case $N=2$ is easy : we have $x_1\\geq y_1$ and need just take \n$\\xi_1=0,t_{11}=y_1$. Now suppose the property is true at level $N$ ; we are going to show it still\nholds at level $N+1$. So suppose \n$x_1+x_2+ \\ldots +x_n \\geq y_1+\\ldots +y_m$ for some nonnegative\nnumbers $x_1,x_2,\\ldots,x_{n},y_1,y_2,\\ldots,y_m$, with $n+m=N+1$. There are two cases. Case 1. $x_n \\geq y_m$. Then we can write $x_n=y_m+X_n$ where \n$X_n$ is nonnegative. We then have an inequality with one\nvariable less : $x_1+x_2+\\ldots+x_{n-1}+X_n \\geq\ny_1+y_2+\\ldots +y_{m-1}$ and we can apply the induction hypothesis. Case 2. $y_m \\geq x_n$. Then we can write $y_m=x_n+Y_m$ where \n$Y_m$ is nonnegative. We then have an inequality with one\nvariable less : $x_1+x_2+\\ldots+x_{n-1} \\geq\ny_1+y_2+\\ldots +y_{m-1}+Y_m$ and we can apply the induction hypothesis. This concludes the proof of lemma 1. Proof of fundamental lemma from lemma 1. Let $\\tau={\\sf Cone}({\\cal F})$.\nAs all vectors in $\\cal F$ are nonnegative linear combinations\nof the $u_i$, whose scalar product with\n$w$ is nonnegative, we have ${\\cal F} \\subseteq \\sigma_w$ and hence\n$\\tau \\subseteq \\sigma_w$. Conversely, let $v\\in\\sigma_w$. Let us put\n$n=|I_+|,m=|I_{-}|,p=I_{0}$. Reordering the $u_i$ if necessary,\nwe may assume without loss that \n$I_+=[1,n],I_-=[n+1,n+m],I_0=[n+m,d]$. Then, there are nonnegative coefficients\n$a_1,a_2,\\ldots, a_n,b_1,b_2,\\ldots, b_m,c_1,c_2, \\ldots, c_p$ such that $$\nv=\\sum_{i=1}^{n} a_iu_i-\n\\sum_{j=1}^{m} b_ju_{n+j}+\n\\sum_{k=1}^{p} c_ku_{n+m+k} \\tag{1}\n$$ Then, the condition $\\langle v,w\\rangle \\geq 0$ can be expressed as $$\n\\sum_{i=1}^{n} a_i\\langle u_i,w\\rangle-\n\\sum_{j=1}^{m} b_j\\langle u_{n+j},w\\rangle \\geq 0 \\tag{2}\n$$ Or, if we put $x_i=a_i\\langle u_i,w\\rangle$ and $y_j=b_j\\langle u_{n+j},w\\rangle $, $$\n\\sum_{i=1}^{n} x_i-\n\\sum_{j=1}^{m} y_j \\geq 0 \\tag{3}\n$$ This is the hypothesis of (i) in lemma 1, so let \n$\\xi_k(1\\leq k\\leq n)$ and $t_{ij}(1\\leq i \\leq n,1\\leq j \\leq n)$\nas in (ii) of this lemma. We then have $$\n\\begin{array}{lcl}\na_i&=&\\frac{\\xi_i+\\sum_{j}t_{ij}}{\\langle u_i,w\\rangle } (1\\leq i\\leq n),\\\\\nb_j&=&\\frac{\\xi_i+\\sum_{i}t_{ij}}{\\langle u_{n+j},w\\rangle } (1\\leq j\\leq m)\n\\end{array} \\tag{4}\n$$ If we put $z_i=\\frac{\\xi_i}{\\langle u_i,w\\rangle }$ and\n$s_{ij}=\\frac{t_{ij}}{\\langle u_i,w\\rangle\\,|\\langle u_{n+j},w\\rangle|}$, we then have $$\nv=\\sum_{i=1}^n z_i u_i\n+\\sum_{i=1}^n \\sum_{j=1}^m \ns_{ij}(\\langle u_{n+j},w\\rangle u_i-\\langle u_i,w\\rangle u_{n+j})+\n\\sum_{k=1}^{p} c_ku_k \\tag{5}\n$$ which is plainly an element of $\\tau$. This concludes the proof\nof the fundamental lemma. Proof of property (1) from fundamental lemma Notice that\n ${\\cal C}_0={\\mathbb R}^d$ is itself a  RCP cone (it can be written as ${\\sf Cone}(e_1,-e_1,e_2,-e_2,\n\\ldots ,e_d,-e_d)$ where $(e_1,e_2,\\ldots ,e_d)$) is the canonical\nbasis of ${\\mathbb R}^d$). Then, let $$\n{\\cal C}_i=\\lbrace v\\in {\\mathbb R}^d \\ | \\ \n\\langle v,u_j\\rangle \\ \\geq 0 \\ (1\\leq j \\leq i)\\rbrace \n$$ Iterating the fundamental lemma, we see successively that ${\\cal C}_0,\n{\\cal C}_1,\\ldots,$ are all RCP cones. In the end ${\\sigma}^\\vee={\\cal C}_k$\nis a RCP cone.",
    "llm_answer_create_structured_problem": "###BEGIN_OF_FORMAT###\nAssumption: \nσ is a convex polyhedral cone in $\\mathbb{R}^n$,\nσ is generated by a finite set of vectors $u_1, u_2, \\dots, u_k$,\nEach generator $u_i$ belongs to $\\mathbb{Z}^n$.\nProblem:\nProve that:  \n1. The dual cone $\\sigma^\\vee = \\{ v\\in \\mathbb{R}^n \\,|\\, \\langle u,v\\rangle \\ge 0 \\,\\forall u\\in\\sigma \\}$ is a rational convex polyhedral cone.  \n2. $\\sigma^{\\vee \\vee} = \\sigma$.\n###END_OF_FORMAT###",
    "reasoning_create_structured_problem": "Alright, let's tackle this problem. The user wants me to structure the given Math Stack Exchange question into the specified format. First, I need to identify the assumptions and the problem statement.\n\nLooking at the original question: The user is dealing with a rational convex polyhedral cone σ in ℝⁿ, defined as the cone generated by vectors u_i in ℤⁿ. They want to prove two things: that the dual cone σ∨ is also a rational convex polyhedral cone, and that σ∨∨ equals σ. They mention that existing proofs use Hahn-Banach theorem but are asking if there's a more elementary approach without functional analysis.\n\nSo, the assumptions here would be the properties of σ. Each assumption should be a single property applied to one object. The problem is the two statements they need to prove.\n\nBreaking down the assumptions:\n1. σ is a rational convex polyhedral cone in ℝⁿ. (This is given in the problem statement.)\n2. σ is generated by vectors u₁, ..., u_k, each in ℤⁿ. (Since it's rational, the generators must be integer vectors.)\n3. The dual cone σ∨ is defined as {v ∈ ℝⁿ | ⟨u, v⟩ ≥ 0 for all u ∈ σ}. (This is part of the problem's context.)\n4. The bidual cone σ∨∨ is considered. (Again, part of what needs to be proven.)\n\nBut wait, the problem is about proving properties of σ∨ and σ∨∨, so the assumptions should be the conditions given for σ. The fact that σ is generated by integer vectors is crucial here. So each assumption should be a separate line, each addressing one property.\n\nTherefore, the assumptions would be:\n- σ is a convex polyhedral cone in ℝⁿ.\n- σ is generated by vectors u₁, u₂, ..., u_k.\n- Each u_i is an element of ℤⁿ.\n- The dual cone σ∨ is defined as {v ∈ ℝⁿ | ⟨u, v⟩ ≥ 0 for all u ∈ σ}.\n\nBut wait, the problem is to prove σ∨ is rational convex polyhedral and σ∨∨=σ. So the assumptions are the conditions on σ. The definition of σ∨ is part of the problem statement, not an assumption. Let me adjust:\n\nAssumptions:\n- σ is a convex polyhedral cone in ℝⁿ.\n- σ is rational, i.e., generated by vectors u₁, ..., u_k where each u_i ∈ ℤⁿ.\n\nProblem: Prove that σ∨ is a rational convex polyhedral cone and σ∨∨ = σ.\n\nBut the original problem mentions \"statements: 1. σ∨ is a rational convex polyhedral cone. 2. σ∨∨ = σ.\" So the problem includes both parts. The user wants to know if these can be proven without functional analysis, using convex/polyhedral geometry tools.\n\nTherefore, the formatted problem should list the assumptions about σ being a rational convex polyhedral cone (i.e., generated by integer vectors), and the problem is to prove the two statements about the dual and bidual cones.\n\nSo, each assumption line by line:\n- σ is a convex polyhedral cone in ℝⁿ.\n- σ is rational (all generators u₁, ..., u_k are in ℤⁿ).\nPossibly also that the dual is defined as {v ∈ ℝⁿ | ⟨u, v⟩ ≥ 0 ∀u ∈ σ}, but that's part of the problem's definitions, not an assumption.\n\nWait, the problem states \"A rational convex polyehedral cone σ⊆ℝⁿ is a set of the form Cone(u₁,...,u_k) where u_i ∈ ℤⁿ.\" So the assumptions from the problem are that σ is a rational convex polyhedral cone, which by definition means it's generated by integer vectors. So the key assumptions are that σ is generated by integer vectors, making it rational, and that it's a convex polyhedral cone.\n\nTherefore, structured as:\n\nAssumption:\nσ is a convex polyhedral cone in ℝⁿ,\nσ is generated by vectors u₁, u₂, ..., u_k,\nEach u_i is an element of ℤⁿ.\n\nProblem:\nProve that:\n1. σ∨ = {v ∈ ℝⁿ | ⟨u, v⟩ ≥ 0 for all u ∈ σ} is a rational convex polyhedral cone.\n2. σ∨∨ = σ.\n\nBut the user wants each assumption to address only one property applied to one object. So each line is one property. So splitting \"σ is generated by vectors u₁, ..., u_k\" and \"Each u_i ∈ ℤⁿ\" into separate lines.\n\nSo:\n\nAssumption:\nσ is a convex polyhedral cone in ℝⁿ,\nσ is generated by vectors u₁, u₂, ..., u_k,\nEach u_i is an element of ℤⁿ.\n\nProblem:\nProve that σ∨ is a rational convex polyhedral cone and σ∨∨ = σ.\n\nAlternatively, the problem could be split into two parts, but the original question lists both statements as part of the problem. The example given in the user's instruction has the problem as a single statement, so perhaps keeping both as part of the problem.\n\nYes, this seems correct. The assumptions are the properties of σ, and the problem is the two statements to prove.",
    "Original_Problem": "Assumption: \nσ is a convex polyhedral cone in $\\mathbb{R}^n$,\nσ is generated by a finite set of vectors $u_1, u_2, \\dots, u_k$,\nEach generator $u_i$ belongs to $\\mathbb{Z}^n$.\nProblem:\nProve that:  \n1. The dual cone $\\sigma^\\vee = \\{ v\\in \\mathbb{R}^n \\,|\\, \\langle u,v\\rangle \\ge 0 \\,\\forall u\\in\\sigma \\}$ is a rational convex polyhedral cone.  \n2. $\\sigma^{\\vee \\vee} = \\sigma$.",
    "Original_Problem_with_numerical_assumption": "Assumption:\nAssumption 1: σ is a convex polyhedral cone in $\\mathbb{R}^n$,\nAssumption 2: σ is generated by a finite set of vectors $u_1, u_2, \\dots, u_k$,\nAssumption 3: Each generator $u_i$ belongs to $\\mathbb{Z}^n$.\nProblem:\nProve that:  \n1. The dual cone $\\sigma^\\vee = \\{ v\\in \\mathbb{R}^n \\,|\\, \\langle u,v\\rangle \\ge 0 \\,\\forall u\\in\\sigma \\}$ is a rational convex polyhedral cone.  \n2. $\\sigma^{\\vee \\vee} = \\sigma$.",
    "Proof_problem": "Yes",
    "Redundant_assumption": "$$\n\\begin{array}{lcl}\na_i&=&\\frac{\\xi_i+\\sum_{j}t_{ij}}{\\langle u_i,w\\rangle } (1\\leq i\\leq n),\\\\\nb_j&=&\\frac{\\xi_i+\\sum_{i}t_{ij}}{\\langle u_{n+j},w\\rangle } (1\\leq j\\leq m)\n\\end{array} \\tag{4}\n$$",
    "Problem_with_redundant_assumption": "Assumption:\nAssumption 1: σ is a convex polyhedral cone in $\\mathbb{R}^n$,\nAssumption 2: σ is generated by a finite set of vectors $u_1, u_2, \\dots, u_k$,\nAssumption 3: Each generator $u_i$ belongs to $\\mathbb{Z}^n$.\nAssumption 4: $$\n\\begin{array}{lcl}\na_i&=&\\frac{\\xi_i+\\sum_{j}t_{ij}}{\\langle u_i,w\\rangle } (1\\leq i\\leq n),\\\\\nb_j&=&\\frac{\\xi_i+\\sum_{i}t_{ij}}{\\langle u_{n+j},w\\rangle } (1\\leq j\\leq m)\n\\end{array} \\tag{4}\n$$\nProblem:\nProve that:  \n1. The dual cone $\\sigma^\\vee = \\{ v\\in \\mathbb{R}^n \\,|\\, \\langle u,v\\rangle \\ge 0 \\,\\forall u\\in\\sigma \\}$ is a rational convex polyhedral cone.  \n2. $\\sigma^{\\vee \\vee} = \\sigma$."
}