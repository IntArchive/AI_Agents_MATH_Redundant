{
    "Link_API": "https://api.stackexchange.com/2.3/questions/737892",
    "Title": "Coefficient of $n$th cyclotomic polynomial equals $-\\mu(n)$",
    "Score": 19,
    "Category": "Chứng minh",
    "Tags": "abstract-algebra, number-theory, polynomials, cyclotomic-polynomials, mobius-function",
    "Link": "https://math.stackexchange.com/questions/737892/coefficient-of-nth-cyclotomic-polynomial-equals-mun",
    "Content": "For a polynomial $f=X^n+a_1X^{n-1}+\\ldots+a_n \\in \\mathbb{Q}[X]$ we define $\\varphi(f):=a_1 \\in \\mathbb{Q}$. Now I want to show that for the $n$th cyclotomic polynomial $\\Phi_n$ it holds that $$\\varphi(\\Phi_n)=-\\mu(n)$$\nwhere $\\mu(n)$ is the Möbius function. What I know is that $\\displaystyle\\Phi_n=\\prod_{d|n} (X^{\\frac{n}{d}}-1)^{\\mu(d)}$.",
    "AcceptedAnswer": "Note that the Möbius function $\\mu(n)$ can be defined as the unique arithmetic function $f$ that fulfills\n$$ \\forall n\\in\\mathbb{N}: \\sum_{d\\mid n} f(d) =\n\\begin{cases}1 & \\text{for $n=1$}\\\\ 0 &\\text{for $n>1$}\\end{cases}\\tag{1}$$ Now define\n$$g(d) = \\left[\\Phi_d(X)\\right]_{-1}$$\nwhere $[\\cdot]_{-1}$ is the next-to-leading coefficient.\nIt follows that\n$$\\sum_{d\\mid n} g(d) = \\sum_{d\\mid n}\\left[\\Phi_d(X)\\right]_{-1}\n= \\left[\\prod_{d\\mid n} \\Phi_d(X)\\right]_{-1}\n= \\left[X^n-1\\right]_{-1}\n= \\begin{cases}\n-1 & \\text{for $n=1$}\\\\ 0 &\\text{for $n>1$}\n\\end{cases}$$\nAnd by the above definition of $\\mu(n)$ you can conclude $g(n)=-\\mu(n)$,\nwhich implies $\\left[\\Phi_n(X)\\right]_{-1}=-\\mu(n)$. Update: For monic univariate polynomials $f_1,f_2$ of degree at least $1$\nwe have\n$$\\left[f_1(X)\\,f_2(X)\\right]_{-1} = \\left[f_1(X)\\right]_{-1}+\\left[f_2(X)\\right]_{-1}$$\nbecause the coefficient in question is the negative sum of the roots\nof $f_1$ and $f_2$ (with multiplicity).\nEven without considering roots,\nthis follows from looking at how the product expands. Update: Proof that $\\mu$ is the unique arithmetic function with property $(1)$: For $n=1$ we obtain $f(1)=1=\\mu(1)$.\nFor $n>1$, let $n=p_1^{e_1}\\cdots p_r^{e_r}$ where $p_1,\\ldots,p_r$\nare pairwise distinct primes and $e_1,\\ldots,e_r$ are positive integers.\nThen\n$$\\begin{align}\n\\sum_{d\\mid n} \\mu(d) &= \\sum_{j_1=0}^{e_1}\\cdots\\sum_{j_r=0}^{e_r}\n\\mu(p_1^{j_1}\\cdots p_r^{j_r}) = \\sum_{j_1=0}^{e_1}\\cdots\\sum_{j_r=0}^{e_r}\n\\begin{cases} 0 & \\text{if any $j_i>1$}\\\\\n(-1)^{j_1+\\cdots+j_r} & \\text{otherwise}\\end{cases}\\\\\n&= \\left(\\sum_{j_1=0}^{1}(-1)^{j_1}\\right)\\cdots\n\\left(\\sum_{j_r=0}^{1}(-1)^{j_r}\\right) = 0\n\\end{align}$$\nThus $\\mu$ has property $(1)$. Now for uniqueness:\nLet $\\mu_1,\\mu_2$ be arithmetic functions with property $(1)$.\nThen necessarily $\\sum_{d\\mid n}\\mu_1(d)=\\sum_{d\\mid n}\\mu_2(d)$\nfor all positive integers $n$.\nSuppose $\\mu_1\\neq \\mu_2$, then there exists a minimal positive integer $m$\nsuch that $\\mu_1(m)\\neq \\mu_2(m)$. But then\n$\\sum_{d\\mid m}\\mu_1(d)\\neq\\sum_{d\\mid m}\\mu_2(d)$ which contradicts the\nhypothesis. (All $d<m$ do not make any difference since $m$ is minimal\nin that respect, but $d=m$ does make a difference.)\nThe only remaining possibility is $\\mu_1=\\mu_2$.",
    "llm_answer_create_structured_problem": "###BEGIN_OF_FORMAT###\nAssumption: \n$\\Phi_n$ is the $n$th cyclotomic polynomial,\n$\\varphi(f)$ denotes the coefficient of $X^{\\deg(f)-1}$ in the polynomial $f$,\n$\\mu(n)$ is the Möbius function,\n$\\Phi_n$ is expressed as $\\prod_{d|n} (X^{n/d} - 1)^{\\mu(d)}$.\nProblem: \nShow that $$\\varphi(\\Phi_n) = -\\mu(n).$$\n###END_OF_FORMAT###",
    "reasoning_create_structured_problem": "Okay, let's tackle this problem step by step. The goal is to show that the coefficient of \\( X^{n-1} \\) in the \\( n \\)-th cyclotomic polynomial \\( \\Phi_n \\) is equal to \\( -\\mu(n) \\), where \\( \\mu \\) is the Möbius function. \n\nFirst, I need to recall the definition of cyclotomic polynomials. The \\( n \\)-th cyclotomic polynomial is given by \\( \\Phi_n(X) = \\prod_{\\substack{1 \\leq k \\leq n \\\\ \\gcd(k,n) = 1}} (X - e^{2\\pi i k/n}) \\). But the problem mentions another formula: \\( \\Phi_n = \\prod_{d|n} (X^{n/d} - 1)^{\\mu(d)} \\). That seems like the Möbius inversion formula applied to cyclotomic polynomials. Maybe this product formula will be more useful here.\n\nThe problem defines \\( \\varphi(f) \\) as the coefficient of \\( X^{n-1} \\) in the polynomial \\( f \\), which is \\( a_1 \\) if \\( f = X^n + a_1 X^{n-1} + \\ldots + a_n \\). So, we need to find \\( \\varphi(\\Phi_n) = a_1 \\) and show it's equal to \\( -\\mu(n) \\).\n\nLet me consider the product formula for \\( \\Phi_n \\). Since \\( \\Phi_n \\) is a product of terms of the form \\( (X^{n/d} - 1)^{\\mu(d)} \\), each term in the product is a polynomial. The exponents \\( \\mu(d) \\) can be -1, 0, or 1 because the Möbius function takes these values. If \\( \\mu(d) = 0 \\), that term is just 1, so it doesn't contribute to the product. Therefore, the product is effectively over divisors \\( d \\) of \\( n \\) where \\( \\mu(d) \\neq 0 \\), i.e., \\( d \\) is square-free.\n\nNow, to find the coefficient \\( a_1 \\) of \\( X^{n-1} \\) in \\( \\Phi_n \\), I need to look at how such a term can arise when multiplying out all these factors. Each factor \\( (X^{n/d} - 1)^{\\mu(d)} \\) contributes some terms, but since we are dealing with a product, the coefficient \\( a_1 \\) will come from the sum of the coefficients of \\( X^{n-1} \\) in each individual factor, multiplied by 1 from all other factors (since when expanding the product, the linear term comes from choosing the linear term from one factor and the constant term from all others). However, this might not be straightforward because the exponents \\( \\mu(d) \\) can be negative. Wait, but \\( \\mu(d) \\) here is either -1, 0, or 1. So when \\( \\mu(d) = 1 \\), the term is \\( (X^{n/d} - 1) \\), and when \\( \\mu(d) = -1 \\), it's \\( 1/(X^{n/d} - 1) \\). But cyclotomic polynomials are polynomials with integer coefficients, so maybe the formula is written using the multiplicative inverse in the sense of generating functions, but in reality, it's a product over divisors with exponents given by Möbius function. Wait, maybe the formula is written as \\( \\Phi_n(X) = \\prod_{d | n} (X^d - 1)^{\\mu(n/d)} \\). Let me check. The standard formula is \\( \\Phi_n(X) = \\prod_{d | n} (X^{d} - 1)^{\\mu(n/d)} \\). So perhaps the user had a typo, writing \\( n/d \\) instead of \\( d \\). But regardless, I need to use the formula provided in the problem, which is \\( \\Phi_n = \\prod_{d|n} (X^{n/d} - 1)^{\\mu(d)} \\). Wait, maybe they are equivalent. Let me see: if we substitute \\( d' = n/d \\), then when \\( d | n \\), \\( d' | n \\), and then \\( \\mu(d) = \\mu(n/d') \\). But unless \\( n/d' \\) is square-free, which would depend on \\( d' \\). Hmm, this might complicate things. Maybe the original formula in the problem is correct. Let me proceed with the formula given.\n\nAssuming \\( \\Phi_n = \\prod_{d | n} (X^{n/d} - 1)^{\\mu(d)} \\). Let's note that each term \\( (X^{n/d} - 1) \\) is a polynomial of degree \\( n/d \\). The exponents \\( \\mu(d) \\) can be -1, 0, or 1, but when \\( \\mu(d) = 0 \\), that term is 1. So effectively, the product is over square-free divisors \\( d \\) of \\( n \\), where \\( \\mu(d) \\neq 0 \\).\n\nNow, to compute the coefficient \\( a_1 \\), which is the coefficient of \\( X^{n-1} \\), we need to consider how such a term can arise when multiplying all the factors. Let's recall that when multiplying polynomials, the coefficient of \\( X^{k} \\) is the sum over all combinations of exponents from each factor such that their degrees add up to \\( k \\). However, in our case, the problem is about the coefficient of \\( X^{n-1} \\), which is just one degree less than the total degree of \\( \\Phi_n \\). The degree of \\( \\Phi_n \\) is \\( \\phi(n) \\), Euler's totient function. Wait, but if \\( \\Phi_n \\) is given by that product formula, maybe we can compute its degree. Let's check:\n\nThe degree of \\( \\Phi_n \\) would be the sum over \\( d | n \\) of \\( \\mu(d) \\cdot \\frac{n}{d} \\). But actually, the standard formula for the degree of \\( \\Phi_n \\) is \\( \\phi(n) \\), so we must have \\( \\sum_{d | n} \\mu(d) \\cdot \\frac{n}{d} = \\phi(n) \\). Which is indeed a known identity. For example, Möbius inversion formula gives \\( \\phi(n) = \\sum_{d | n} \\mu(d) \\cdot \\frac{n}{d} \\). So that checks out.\n\nBut back to the coefficient \\( a_1 \\). The leading term of \\( \\Phi_n \\) is \\( X^{\\phi(n)} \\), so the term \\( a_1 \\) is the coefficient of \\( X^{\\phi(n) - 1} \\). Wait, but the problem defines \\( \\varphi(f) = a_1 \\) where \\( f = X^n + a_1 X^{n-1} + \\ldots \\). Wait, but here \\( \\Phi_n \\) is of degree \\( \\phi(n) \\), so the problem must be that \\( \\varphi(f) \\) is the coefficient of \\( X^{\\deg(f) - 1} \\). So if \\( \\Phi_n \\) is of degree \\( \\phi(n) \\), then \\( \\varphi(\\Phi_n) \\) is the coefficient of \\( X^{\\phi(n) - 1} \\). But the problem states \\( \\varphi(\\Phi_n) = -\\mu(n) \\). So how do we get that?\n\nAlternatively, maybe the problem is considering \\( \\Phi_n \\) as a monic polynomial of degree \\( \\phi(n) \\), so \\( \\Phi_n = X^{\\phi(n)} + a_1 X^{\\phi(n)-1} + \\ldots + a_{\\phi(n)} \\). Then \\( \\varphi(\\Phi_n) = a_1 \\), which is the coefficient of \\( X^{\\phi(n)-1} \\). The problem claims that this coefficient is \\( -\\mu(n) \\).\n\nSo, to compute \\( a_1 \\), which is the sum of the roots of \\( \\Phi_n \\) multiplied by -1. Because for a monic polynomial \\( f(X) = X^m + a_1 X^{m-1} + \\ldots + a_m \\), the coefficient \\( a_1 \\) is equal to \\( - \\) (sum of the roots). Therefore, if we can compute the sum of the roots of \\( \\Phi_n \\), then \\( \\varphi(\\Phi_n) = a_1 = - \\) (sum of roots).\n\nBut the roots of \\( \\Phi_n \\) are the primitive \\( n \\)-th roots of unity. Let me denote them as \\( \\zeta_n^k \\) where \\( 1 \\leq k \\leq n \\) and \\( \\gcd(k, n) = 1 \\). Therefore, the sum of the roots is \\( \\sum_{\\substack{1 \\leq k \\leq n \\\\ \\gcd(k,n)=1}} \\zeta_n^k \\). So, the coefficient \\( a_1 \\) is equal to the negative of this sum.\n\nTherefore, we need to show that \\( \\sum_{\\substack{1 \\leq k \\leq n \\\\ \\gcd(k,n)=1}} \\zeta_n^k = \\mu(n) \\). If that's the case, then \\( a_1 = -\\mu(n) \\). So, is it true that the sum of primitive \\( n \\)-th roots of unity is \\( \\mu(n) \\)?\n\nYes, I recall that the Möbius function appears in the sum of primitive roots. Specifically, the sum of the primitive \\( n \\)-th roots of unity is \\( \\mu(n) \\). Let me verify that. For example, when \\( n = 1 \\), the sum is 1, and \\( \\mu(1) = 1 \\). For \\( n = 2 \\), the primitive 2nd roots are -1, sum is -1, and \\( \\mu(2) = -1 \\). For \\( n = 3 \\), primitive 3rd roots are \\( e^{2\\pi i /3} \\) and \\( e^{4\\pi i /3} \\), sum is -1, and \\( \\mu(3) = -1 \\). For \\( n = 4 \\), primitive 4th roots are \\( i \\) and \\( -i \\), sum is 0, and \\( \\mu(4) = 0 \\). Similarly, for \\( n = 6 \\), primitive 6th roots are \\( e^{2\\pi i \\cdot 1/6} \\) and \\( e^{2\\pi i \\cdot 5/6} \\), their sum is \\( e^{\\pi i /3} + e^{5\\pi i /3} = 2 \\cos(\\pi/3) = 1 \\), but wait, \\( \\mu(6) = 1 \\). Wait, but wait, \\( \\cos(\\pi/3) = 0.5 \\), so 2 * 0.5 = 1. So yes, sum is 1, and \\( \\mu(6) = 1 \\). So this seems to hold.\n\nTherefore, the sum of primitive \\( n \\)-th roots of unity is indeed \\( \\mu(n) \\). Therefore, the coefficient \\( a_1 = - \\mu(n) \\). Hence, proved.\n\nAlternatively, if we want to approach this using the product formula given in the problem: \\( \\Phi_n = \\prod_{d | n} (X^{n/d} - 1)^{\\mu(d)} \\). Then, expanding this product, the coefficient \\( a_1 \\) can be found by considering the linear terms in the expansion. Since each factor is either \\( (X^{n/d} - 1) \\), \\( 1/(X^{n/d} - 1) \\), or 1 (if \\( \\mu(d) = 0 \\)).\n\nBut dealing with multiplicative inverses complicates things. However, since cyclotomic polynomials are known to have integer coefficients, the formula must hold in a way that when expanded, the negative exponents would cancel out appropriately. But this might be a more involved approach.\n\nAlternatively, take the logarithm derivative or use generating functions, but perhaps that's overcomplicating.\n\nAlternatively, use induction on the number of prime factors of \\( n \\). But given the time, the first approach using the sum of roots seems the most straightforward.\n\nTherefore, the key steps are:\n\n1. Recognize that the coefficient \\( a_1 \\) in the cyclotomic polynomial \\( \\Phi_n \\) is equal to the negative sum of its roots.\n2. The roots of \\( \\Phi_n \\) are the primitive \\( n \\)-th roots of unity.\n3. The sum of all primitive \\( n \\)-th roots of unity is equal to the Möbius function \\( \\mu(n) \\).\n4. Therefore, \\( a_1 = -\\mu(n) \\).\n\nThis completes the proof.",
    "Original_Problem": "Assumption: \n$\\Phi_n$ is the $n$th cyclotomic polynomial,\n$\\varphi(f)$ denotes the coefficient of $X^{\\deg(f)-1}$ in the polynomial $f$,\n$\\mu(n)$ is the Möbius function,\n$\\Phi_n$ is expressed as $\\prod_{d|n} (X^{n/d} - 1)^{\\mu(d)}$.\nProblem: \nShow that $$\\varphi(\\Phi_n) = -\\mu(n).$$",
    "Original_Problem_with_numerical_assumption": "Assumption:\nAssumption 1: $\\Phi_n$ is the $n$th cyclotomic polynomial,\nAssumption 2: $\\varphi(f)$ denotes the coefficient of $X^{\\deg(f)-1}$ in the polynomial $f$,\nAssumption 3: $\\mu(n)$ is the Möbius function,\nAssumption 4: $\\Phi_n$ is expressed as $\\prod_{d|n} (X^{n/d} - 1)^{\\mu(d)}$.\nProblem: \nShow that $$\\varphi(\\Phi_n) = -\\mu(n).$$",
    "Proof_problem": "Yes",
    "Redundant_assumption": "$$\\left[f_1(X)\\,f_2(X)\\right]_{-1} = \\left[f_1(X)\\right]_{-1}+\\left[f_2(X)\\right]_{-1}$$",
    "Problem_with_redundant_assumption": "Assumption:\nAssumption 1: $\\Phi_n$ is the $n$th cyclotomic polynomial,\nAssumption 2: $\\varphi(f)$ denotes the coefficient of $X^{\\deg(f)-1}$ in the polynomial $f$,\nAssumption 3: $\\mu(n)$ is the Möbius function,\nAssumption 4: $\\Phi_n$ is expressed as $\\prod_{d|n} (X^{n/d} - 1)^{\\mu(d)}$.\nAssumption 5: $$\\left[f_1(X)\\,f_2(X)\\right]_{-1} = \\left[f_1(X)\\right]_{-1}+\\left[f_2(X)\\right]_{-1}$$\nProblem: \nShow that $$\\varphi(\\Phi_n) = -\\mu(n).$$"
}