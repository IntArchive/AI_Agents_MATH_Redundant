{
    "Link_API": "https://api.stackexchange.com/2.3/questions/78237",
    "Title": "Expected number of runs in a sequence of coin flips",
    "Score": 12,
    "Category": "Chứng minh",
    "Tags": "probability, discrete-mathematics",
    "Link": "https://math.stackexchange.com/questions/78237/expected-number-of-runs-in-a-sequence-of-coin-flips",
    "Content": "A coin with heads probability $p$ is flipped $n$ times. A \"run\" is a maximal sequence of consecutive flips that are all the same. For example, the sequence HTHHHTTH with $n=8$ has five runs, namely H, T, HHH, TT,H. Show that the expected number of runs is \n$$1+2(n-1)p(1-p).$$ I have tried to use some generating function on this but calculus got pretty messy and didn't work.",
    "AcceptedAnswer": "I'd use indicator random variables. For $1\\leq j\\leq n-1$, let $Z_j$ take the value $1$ if the $j$th and $j+1$st coin tosses are different, and take the value $0$ otherwise.  Then the number of runs is $R=1+\\sum_{j=1}^{n-1}Z_j$ and its expected value is \n$$\\mathbb{E}(R)=1+ \\sum_{j=1}^{n-1}\\, \\mathbb{E}(Z_j)=1+(n-1) 2p(1-p).$$\nI will leave the calculation $\\mathbb{E}(Z_j)=2p(1-p)$ as an exercise!",
    "llm_answer_create_structured_problem": "###BEGIN_OF_FORMAT###\nAssumption: \nThe coin is flipped $n$ times,\nEach flip has probability $p$ of resulting in heads,\nEach flip is independent,\nA run is defined as a maximal sequence of consecutive flips with the same outcome.\nProblem:\nShow that the expected number of runs is  \n$$1+2(n-1)p(1-p).$$\n###",
    "reasoning_create_structured_problem": "Okay, let's see. The user wants me to act as a math professor and structure the given problem into the specified format. The example provided shows that assumptions should list each condition applied to one object. The original problem is about the expected number of runs in a sequence of coin flips.\n\nFirst, I need to read the problem carefully. The question states: A coin with heads probability p is flipped n times. A run is a maximal sequence of consecutive flips that are all the same. For example, HTHHHTTH has five runs. The task is to show that the expected number of runs is 1 + 2(n-1)p(1-p).\n\nNow, I need to list the assumptions. The example structured problem had assumptions like \"$n$ is an integer\" and \"$n$ is divisible by 7\". Here, the problem mentions a coin with heads probability p, flipped n times. So the assumptions would be:\n\n1. The coin is flipped n times. So, the number of flips is n.\n2. Each flip is independent, as it's a standard coin flip.\n3. The probability of getting heads on each flip is p. Therefore, the probability of tails is 1-p.\n4. A run is defined as a maximal sequence of consecutive identical flips. So, each time the outcome changes, a new run starts.\n\nWait, the original problem doesn't explicitly state independence, but in probability problems involving coins, it's usually assumed unless stated otherwise. However, to be thorough, should I include that as an assumption? The example included specific conditions, so maybe here the key assumptions are the number of flips, the probability p, and the definition of a run. But also, each flip is independent and identically distributed (i.i.d.). However, the problem doesn't mention i.i.d. explicitly, but it's standard. But the user wants each assumption to be about one property or condition applied to one object.\n\nSo breaking it down:\n\n- The coin has a probability p of landing heads on each flip.\n- The coin is flipped n times.\n- Each flip is independent of the others.\n- A run is a maximal sequence of consecutive flips that are all the same.\n\nBut wait, the original problem says \"a coin with heads probability p is flipped n times\". So the first assumption is that each flip has probability p of heads, and 1-p of tails. So the first assumption is about the probability of each flip. Then, the number of flips is n. Then, independence of flips. Then the definition of a run.\n\nBut maybe the problem doesn't explicitly mention independence, but in the context, it's necessary. So as a math professor, I need to list all necessary assumptions for the problem to be valid. So including independence is important here because without independence, the expectation calculation would be different.\n\nTherefore, the assumptions would be:\n\nAssumption:\nEach flip results in heads with probability $p$,\nEach flip is independent,\nThe total number of flips is $n$,\nA run is defined as a maximal sequence of consecutive identical outcomes.\n\nWait, but the problem mentions \"a coin with heads probability p\", so tails is 1-p. Maybe that's an assumption. So:\n\nAssumption:\nThe coin has probability $p$ of landing heads on each flip,\nThe coin has probability $1-p$ of landing tails on each flip,\nEach flip is independent of the others,\nThe total number of flips is $n$,\nA run is a maximal sequence of consecutive flips with the same outcome.\n\nBut the problem may not need to state the tails probability as a separate assumption, but perhaps it's implied. However, to be precise, since the runs depend on switching between heads and tails, the probability of tails is necessary. But maybe the first assumption can be phrased as: Each flip results in heads with probability $p$ and tails with probability $1-p$. But the user's example splits each assumption into one line per property. So maybe split into:\n\n- Each flip has probability $p$ of resulting in heads,\n- Each flip has probability $1-p$ of resulting in tails,\n- The flips are independent,\n- There are $n$ flips in total,\n- A run is a maximal sequence of consecutive flips with the same outcome.\n\nBut perhaps combining the first two as one assumption. Wait, the example had \"n is an integer\" and \"n is divisible by 7\" as separate. So if we have two different probabilities (heads and tails), maybe they should be separate. However, in the context, the coin's probability is p for heads, so tails is automatically 1-p. So maybe it's redundant to list both. Alternatively, the first assumption is the coin has probability p of heads, and the rest follows.\n\nBut perhaps to make it clear, we can list:\n\n- The probability of heads on each flip is $p$,\n- The probability of tails on each flip is $1-p$,\n- Each flip is independent,\n- The number of flips is $n$,\n- A run is a maximal sequence of consecutive flips with the same outcome.\n\nAlternatively, maybe just state the coin's probability and the independence, and number of flips. The definition of a run is part of the problem statement, but since the problem says \"a run is a maximal...\", maybe the assumption is that the problem defines a run in that way. So perhaps:\n\nAssumption:\nThe coin is flipped $n$ times,\nEach flip results in heads with probability $p$,\nEach flip is independent,\nA run is defined as a maximal sequence of consecutive flips with the same outcome.\n\nBut the problem statement includes the definition of a run. So in the original problem, that's part of the problem statement, but in our formatting, we need to list assumptions. So perhaps the definition of a run is a given condition and should be in assumptions.\n\nSo I think the correct assumptions are:\n\n- The coin is flipped $n$ times.\n- Each flip results in heads with probability $p$.\n- Each flip is independent of the others.\n- A run is defined as a maximal sequence of consecutive flips with the same outcome.\n\nThen the problem is to show that the expected number of runs is 1 + 2(n-1)p(1-p).\n\nWait, but in the example given by the user, the original problem included \"for every integer n\", and in the formatted problem, the assumption was \"n is an integer\", \"n is divisible by 7\". So the user split the assumptions into separate lines for each property.\n\nTherefore, following that example, for this problem, each assumption should be a separate line, each addressing one property or condition applied to one object.\n\nSo:\n\nAssumption:\nThe coin is flipped $n$ times,\nEach flip has probability $p$ of resulting in heads,\nEach flip is independent,\nA run is a maximal sequence of consecutive flips with the same outcome.\n\nBut wait, the example had two separate assumptions for n being integer and n divisible by 7. Here, we have \"the coin is flipped n times\" which implies n is the number of flips. The problem doesn't specify if n is a positive integer or any integer, but in context, it's a number of flips, so n is a positive integer. However, the original problem didn't state that explicitly. So should we include \"n is a positive integer\" as an assumption?\n\nBut maybe the problem is valid for any integer n ≥ 1. However, since the user's example didn't assume n is positive unless specified, perhaps in the original problem, n is given as the number of flips, which would be a positive integer. But the problem doesn't specify, so maybe we shouldn't assume unless it's given.\n\nBut the original problem says \"flipped n times\", so n is the number of flips. Therefore, the assumption is that n is the number of flips, which is a non-negative integer? Wait, n can be zero? The example with n=8 is given, so n is at least 1. But maybe the problem allows n=0. However, the expected runs when n=0 would be zero, but the formula 1 + 2(n-1)p(1-p) when n=0 gives 1 + 2(-1)p(1-p) which would be 1 - 2p(1-p). That doesn't make sense. So maybe n is at least 1. But the original problem doesn't specify, so perhaps the user expects to not include that unless stated.\n\nSo following the example, since the original problem didn't specify, we don't need to list \"n is a positive integer\" unless the problem mentions it. Since the problem just says \"flipped n times\", we take that as given. So the assumption is \"The coin is flipped n times\".\n\nTherefore, putting it all together:\n\nAssumption:\nThe coin is flipped $n$ times,\nEach flip has probability $p$ of resulting in heads,\nEach flip is independent,\nA run is defined as a maximal sequence of consecutive flips with the same outcome.\n\nProblem:\nShow that the expected number of runs is $$1+2(n-1)p(1-p).$$\n\nThat seems to capture the necessary assumptions. Each line is one condition applied to one object. The first line is about the number of flips, the second about the probability of each flip, third about independence, fourth the definition of a run.",
    "Original_Problem": "Assumption: \nThe coin is flipped $n$ times,\nEach flip has probability $p$ of resulting in heads,\nEach flip is independent,\nA run is defined as a maximal sequence of consecutive flips with the same outcome.\nProblem:\nShow that the expected number of runs is  \n$$1+2(n-1)p(1-p).$$",
    "Original_Problem_with_numerical_assumption": "Assumption:\nAssumption 1: The coin is flipped $n$ times,\nAssumption 2: Each flip has probability $p$ of resulting in heads,\nAssumption 3: Each flip is independent,\nAssumption 4: A run is defined as a maximal sequence of consecutive flips with the same outcome.\nProblem:\nShow that the expected number of runs is  \n$$1+2(n-1)p(1-p).$$",
    "Proof_problem": "Yes",
    "Redundant_assumption": "$$\\mathbb{E}(R)=1+ \\sum_{j=1}^{n-1}\\, \\mathbb{E}(Z_j)=1+(n-1) 2p(1-p).$$",
    "Problem_with_redundant_assumption": "Assumption:\nAssumption 1: The coin is flipped $n$ times,\nAssumption 2: Each flip has probability $p$ of resulting in heads,\nAssumption 3: Each flip is independent,\nAssumption 4: A run is defined as a maximal sequence of consecutive flips with the same outcome.\nAssumption 5: $$\\mathbb{E}(R)=1+ \\sum_{j=1}^{n-1}\\, \\mathbb{E}(Z_j)=1+(n-1) 2p(1-p).$$\nProblem:\nShow that the expected number of runs is  \n$$1+2(n-1)p(1-p).$$"
}