{
    "Link_API": "https://api.stackexchange.com/2.3/questions/4438010",
    "Title": "approximation of integral of $|\\cos x|^p$",
    "Score": 16,
    "Category": "Chứng minh",
    "Tags": "definite-integrals, numerical-methods, approximation, riemann-sum",
    "Link": "https://math.stackexchange.com/questions/4438010/approximation-of-integral-of-cos-xp",
    "Content": "Let $p\\in [1,2)$ . Let $$\n\\beta = \\frac{1}{2\\pi}\\int_0^{2\\pi} |\\cos x|^p\\, dx = \\frac{\\Gamma(\\frac{p+1}{2})}{\\sqrt{\\pi}\\Gamma(1+\\frac{p}{2})}.\n$$ Consider the following approximation to the integral definition of $\\beta$ : $$\nS_n = \\frac{1}{2n}\\sum_{k=0}^{2n-1} \\left| \\cos\\left(2\\pi \\cdot \\frac{k}{2n}\\right)\\right|^p.\n$$ We are interested in the asymptotics of the approximation error $$\n|S_n - \\beta|.\n$$ I have found empirically that $$\n|S_n - \\beta| \\leq \\frac{c_p}{n^{p+1}}\n$$ where $c_p$ is a constant that depends only on $p$ and $c_p\\to 0$ as $p\\to 2$ . But I have no idea at all how to prove this. (This bound is actually tight, that is, the correct order should be $1/n^{p+1}$ .) I tried to split the integral from $0$ to $2\\pi$ into $2n$ pieces and sum up the approximation errors in each piece, which only gives an error of $O(1/n^2)$ instead of $O(1/n^{p+1})$ . Can anyone shed some light on how to deal with the $p$ -th power or how $p$ enters the exponent in the approximation error? Edit: The following seems to be a proof, up to tiny boundary sloppiness that can be easily fixed. Assume that $n$ is even and so we replace $n$ with $2n$ . Note that $\\cos x$ is decreasing and positive on $[0,\\pi/2]$ . By symmetry, it suffices to bound \\begin{align*}\nE &:= \\frac{1}{2n}\\sum_{k=0}^{2n-1} \\left|\\cos\\frac{\\pi k}{2n}\\right|^p - \\frac{1}{\\pi}\\int_0^\\pi |\\cos x|^p dx\\\\\n&= \\frac{1}{2n}\\sum_{k=0}^{n-1} \\left(\\cos^p\\left(\\frac{\\pi k}{2n}\\right) + \\cos^p\\left(\\frac{\\pi (k+1)}{2n}\\right)\\right) - \\frac{1}{\\pi}\\sum_{k=0}^{n-1} 2\\int_{k\\pi/(2n)}^{(k+1)\\pi/(2n)} \\cos^p xdx  \\\\\n&= \\frac{1}{n}\\sum_{k=0}^{n-1}\\left[ \\frac{1}{2}\\left(\\cos^p\\left(\\frac{\\pi k}{2n}\\right) + \\cos^p\\left(\\frac{\\pi (k+1)}{2n}\\right)\\right) - \\frac{1}{\\pi/(2n)}\\int_{k\\pi/(2n)}^{(k+1)\\pi/(2n)} \\cos^p xdx\\right]\\\\\n&=: \\frac{1}{n}\\sum_{k=0}^{n-1} E_k\n\\end{align*} Recall the following mean-value result for the error of trapezoidal rule: $$\n\\frac{1}{b-a}\\int_a^b f(x)dx - \\frac{f(a)+f(b)}{2} = -\\frac{(b-a)^2}{12}f''(\\xi)\n$$ Let $f(x) = \\cos^p x$ , then $f'(\\pi/2-\\delta)\\asymp \\delta^{p-1}$ and $f''(\\pi/2-\\delta)\\asymp 1/\\delta^{2-p}$ . Let $\\epsilon \\geq 2/n$ to be determined let $K = [n\\epsilon]$ so $K \\geq 2$ . Applying the mean-value result to the intervals corresponding to $k=0,\\dots,n-K-1$ , we have $$\nE = \\frac{1}{n}\\sum_{k=0}^{n-K-1} \\frac{1}{12}\\left(\\frac{\\pi}{2n}\\right)^2 f''(\\xi_k) + \\frac{1}{n}\\sum_{k=n-K}^{n-1} E_k \n=: A + B.\n$$ where $\\xi_k \\in [k\\pi/(2n), (k+1)\\pi/(2n)]$ . Write $A$ as $$\nA = \\frac{\\pi}{24n^2} \\sum_{k=0}^{n-K-1} f''(\\xi_k)\\frac{\\pi}{2n} =: \\frac{\\pi}{24n^2} A'\n$$ Note that $A'$ is the Riemann sum of $\\int_0^{\\pi/2-\\epsilon} f''(x)dx$ . Also note that $f''(x)$ has a unique positive root $x_0$ in $(0,\\pi/2)$ and $f''(x)$ is positive and increasing when $x\\geq x_0$ . We can upper bound $$\n\\begin{aligned}\nA' &\\leq \\int_0^{\\pi/2-\\epsilon} f''(x)dx + \\frac{C_1}{n}\\max_{x\\in [0,x_0]}|f'''(x)| + \\frac{C_2}{n}f''\\left(\\frac{\\pi}{2}-\\epsilon\\right) \\\\\n&\\leq f'\\left(\\frac{\\pi}{2}-\\epsilon\\right) + \\frac{C_3}{n} + \\frac{C_4}{n\\epsilon^{2-p}} \\\\\n&\\lesssim \\epsilon^{p-1} + \\frac{1}{n\\epsilon^{2-p}}.\n\\end{aligned}\n$$ Next, we deal with the last term $B$ . Invoke the integral estimation error from Theorem 3 of this paper , which states that, if $f'$ is absolutely continuous on $[a,b]$ and $f''\\in L^\\alpha(a,b)$ for some $\\alpha\\geq 1$ , then $$\n\\left|\\frac{1}{b-a}\\int_a^b f(x)dx - \\frac{f(a)+f(b)}{2}\\right| \\leq C_\\alpha (b-a)^{2-\\frac{1}{\\alpha}} \\|f''\\|_\\alpha.\n$$ Since $f''(\\pi/2-\\epsilon)\\asymp 1/\\epsilon^{2-p}$ , $f''$ is $L^1$ integrable. It is clear that $E_k > 0$ when $k\\geq n-K$ , as $f''(\\xi_k) > 0$ in this case. Applying the error bound above to $E_k$ ( $k\\geq n-K$ ), we obtain that $$\nB \\lesssim \\frac{1}{n^2}\\int_{\\pi/2-\\epsilon}^{\\pi/2} f''(x)dx \\lesssim\\frac{1}{n^2}\\int_0^{\\epsilon} \\frac{1}{x^{2-p}}dx \\lesssim \\frac{\\epsilon^{p-1}}{n^2}.\n$$ Therefore we conclude that $$\nE \\lesssim \\frac{\\epsilon^{p-1}}{n^2} + \\frac{1}{n^3\\epsilon^{2-p}}.\n$$ Taking $\\epsilon = \\Theta(1/n)$ gives the desired result.",
    "AcceptedAnswer": "A \"Fourier-analytic\" approach, with the analysis of $n^{p+1}|S_n-\\beta|$ as $n\\to\\infty$ . Let $$\nT_N(f):=\\frac1N\\left(\\frac{f(0)+f(2\\pi)}{2}+\\sum_{k=1}^{N-1}f\\Big(\\frac{2k\\pi}{N}\\Big)\\right),\\\\\\Delta_N(f):=T_N(f)-\\frac1{2\\pi}\\int_0^{2\\pi}f(x)\\,dx.$$ Suppose that $f(x)=\\sum_{n\\in\\mathbb{Z}}c_n e^{inx}$ with $\\sum_{n\\in\\mathbb{Z}}|c_n|<\\infty$ , then $$T_N(f)=\\frac1N\\sum_{k=0}^{N-1}\\sum_{n\\in\\mathbb{Z}}c_n e^{2\\pi ikn/N}=\\sum_{d\\in\\mathbb{Z}}c_{Nd},$$ because $\\sum_{k=0}^{N-1}e^{2\\pi ikn/N}=0$ if $n$ is not a multiple of $N$ ; thus $\\color{blue}{\\Delta_N(f)=\\sum_{d\\neq 0}c_{Nd}}$ . In particular, if $c_n=O(|n|^{-\\alpha})$ as $n\\to\\pm\\infty$ with $\\alpha>1$ , then $\\Delta_N(f)=O(N^{-\\alpha})$ as $N\\to\\infty$ . Take $f(x)=|\\cos x|^p$ with $\\color{blue}{p>0}$ , then $c_n=0$ if $n$ is odd, and (see e.g. {1} or {2} ) $$c_{2n}=\\frac2\\pi\\int_0^{\\pi/2}\\cos^p x\\cos 2nx\\,dx=\\frac{\\Gamma(p+1)}{2^p\\Gamma(p/2+1+n)\\Gamma(p/2+1-n)},$$ so that, using the reflection formula for $\\Gamma$ and that $\\Gamma(x+a)/x^a\\Gamma(x)\\to1$ as $x\\to\\infty$ , $$\\lim_{n\\to\\infty}(-1)^{n-1}n^{p+1}c_{2n}=\\lambda_p:=\\frac1{2^p\\pi}\\Gamma(p+1)\\sin\\frac{p\\pi}{2}.$$ Now, denoting $a_n:=n^{p+1}(S_n-\\beta)=n^{p+1}\\Delta_{2n}(f)$ , we get easily $$\\lim_{n\\to\\infty}a_{2n}=-2\\lambda_p\\zeta(p+1)=2\\pi^p\\zeta(-p);\\\\\\lim_{n\\to\\infty}a_{2n+1}=-(1-2^{-p})\\lim_{n\\to\\infty}a_{2n}.$$",
    "llm_answer_create_structured_problem": "###BEGIN_OF_FORMAT###\nAssumption: \n$p$ is in the interval $[1, 2)$,\n$\\beta$ is defined as $\\frac{1}{2\\pi}\\int_0^{2\\pi} |\\cos x|^p dx$,\n$S_n$ is defined as $\\frac{1}{2n}\\sum_{k=0}^{2n-1} \\left| \\cos\\left(2\\pi \\cdot \\frac{k}{2n}\\right)\\right|^p$,\nthe approximation error is $|S_n - \\beta|$.\nProblem:\nProve that there exists a constant $c_p$ (depending only on $p$) such that $$|S_n - \\beta| \\leq \\frac{c_p}{n^{p+1}},$$ where $c_p \\to 0$ as $p \\to 2$.\n###",
    "reasoning_create_structured_problem": "Okay, let's tackle this problem. The user wants to structure the given Math Stack Exchange question into the specified format. The example provided shows that the assumptions should list each condition line by line, focusing on one property or object each. Then, the problem statement itself should be clearly stated.\n\nLooking at the original problem:\n\nThe title is about the approximation of the integral of |cos x|^p. The problem defines beta as an integral involving |cos x|^p over 0 to 2π, expressed using Gamma functions. Then, there's an approximation S_n using a sum over 2n points. The main goal is to find the asymptotics of the approximation error |S_n - beta|, with the user conjecturing it's bounded by c_p / n^{p+1}.\n\nThe user mentions that p is in [1,2), and they tried splitting the integral into 2n pieces but only got O(1/n²) error. They provided their own proof attempt, splitting the error into parts and using trapezoidal rule error estimates, but the core problem is to prove the bound on |S_n - beta|.\n\nNow, to format this into Assumptions and Problem. The assumptions should be all the given conditions. The problem is to prove the error bound.\n\nAssumptions:\n1. p is in the interval [1, 2).\n2. beta is defined as (1/(2π)) times the integral from 0 to 2π of |cos x|^p dx, which equals the Gamma function expression given.\n3. S_n is the approximation using a sum over 2n points with step 1/(2n).\n4. The error |S_n - beta| is to be bounded by c_p / n^{p+1} where c_p depends only on p and tends to 0 as p approaches 2.\n\nWait, but the user also mentions that the bound is tight, so the order is 1/n^{p+1}. However, in the example given earlier, assumptions included conditions on the variables, like n being an integer and divisible by 7. Here, the key assumptions are about p being in [1,2), the definitions of beta and S_n, and the nature of the error term. However, in the problem statement, the user is asking to prove the asymptotics of the error, given these definitions.\n\nSo the assumptions should list the conditions given in the problem statement, each as a single line.\n\nAssumptions:\n- p is an element of the interval [1, 2).\n- β is defined as (1/(2π)) ∫₀²π |cos x|^p dx, which equals Γ((p+1)/2) / (√π Γ(1 + p/2)).\n- S_n is defined as (1/(2n)) Σₖ=₀²ⁿ⁻¹ |cos(2π k/(2n))|^p.\n- The approximation error is |S_n - β|.\n\nThe problem is to prove that |S_n - β| ≤ c_p / n^{p+1}, where c_p is a constant depending only on p and c_p → 0 as p → 2.\n\nBut wait, in the example, assumptions were more about the conditions given (n is integer, n divisible by 7). Here, the problem doesn't state any additional conditions on n other than it's an integer (since the sum is over 2n points), but the user doesn't specify that n must be even or something. However, in their edit, they assume n is even, but that's part of their proof attempt. The original problem's assumptions don't include that; the user's own approach uses that, but the problem as posed doesn't require n to be even. So the assumptions should only include what's given in the problem statement, not the user's proof steps.\n\nTherefore, the key assumptions are:\n\n- p ∈ [1, 2).\n- β is defined as (1/(2π)) ∫₀²π |cos x|^p dx.\n- S_n is the sum approximation given.\n- The error |S_n - β| is to be bounded.\n\nThe problem is to show that this error is ≤ c_p / n^{p+1} with c_p as described.\n\nSo structuring:\n\nAssumption:\np is in the interval [1,2),\nβ is defined as \\(\\frac{1}{2\\pi}\\int_0^{2\\pi} |\\cos x|^p dx\\),\nS_n is defined as \\(\\frac{1}{2n}\\sum_{k=0}^{2n-1} \\left| \\cos\\left(2\\pi \\cdot \\frac{k}{2n}\\right)\\right|^p\\),\nthe approximation error is \\(|S_n - \\beta|\\).\n\nProblem:\nProve that \\(|S_n - \\beta| \\leq \\frac{c_p}{n^{p+1}}\\) where \\(c_p\\) is a constant depending only on \\(p\\) and \\(c_p \\to 0\\) as \\(p \\to 2\\).\n\nWait, but in the example, assumptions were listed line by line. Let me check the example again.\n\nIn the example, the original problem had an expression A(n) and the assumptions were that n is an integer and n is divisible by 7. However, in the user's problem, the key assumptions are the definitions and the range of p.\n\nBut in the user's problem, the integral definition of β and the sum definition of S_n are given, and p is in [1,2). So each of these should be separate assumptions.\n\nTherefore, the assumptions would be:\n\n- \\( p \\in [1, 2) \\).\n- \\( \\beta = \\frac{1}{2\\pi} \\int_0^{2\\pi} |\\cos x|^p dx \\).\n- \\( \\beta = \\frac{\\Gamma(\\frac{p+1}{2})}{\\sqrt{\\pi}\\Gamma(1+\\frac{p}{2})} \\).\n- \\( S_n = \\frac{1}{2n} \\sum_{k=0}^{2n-1} \\left| \\cos\\left(2\\pi \\cdot \\frac{k}{2n}\\right)\\right|^p \\).\n- The approximation error is \\( |S_n - \\beta| \\).\n\nWait, but the equation for β involving Gamma functions is part of its definition. Should that be included as an assumption? The problem states that β is equal to that integral and that Gamma expression. However, in the problem statement, the user might be taking that as a given, so it's part of the problem's conditions. So yes, it's an assumption that β is given by that integral and equals the Gamma expression. But since the problem is about the approximation error between S_n and β, perhaps the Gamma expression is just an alternative form and not necessary for the problem's assumptions. The integral definition is the key part, and the Gamma function expression is a known result. However, since the user includes it in the problem statement, it's part of the given information, so it should be listed as an assumption. However, maybe the equality is a known result, not an assumption. Hmm, this is a bit tricky.\n\nLooking at the example again: the original problem had an expression for A(n), and the formatted problem listed the assumptions about n being integer and divisible by 7. The integral definition of β and its Gamma function equivalent are both given, so perhaps both should be listed as assumptions. Alternatively, since the Gamma expression is a result derived elsewhere, but the problem statement presents it as a given, so it's an assumption that β equals both the integral and that Gamma expression.\n\nBut perhaps the problem is to analyze the approximation error between S_n and β, where β is defined as that integral. The Gamma expression might not be directly relevant to the error analysis; it's just a way to compute β. Therefore, the key assumptions are:\n\n- p is in [1,2).\n- β is defined as (1/(2π)) ∫₀²π |cos x|^p dx.\n- S_n is the average sum given.\n- The problem is to bound |S_n - β| by c_p / n^{p+1}.\n\nBut the Gamma function part might not be necessary for the problem's assumptions, as it's just a known identity for β. However, the user includes it, so maybe we need to list it as part of β's definition.\n\nAlternatively, perhaps the Gamma function expression is a result, not an assumption. The problem states that β is equal to that integral and then provides the Gamma function expression. So the assumption is that β is defined as that integral, and the Gamma expression is a known result. But since the problem is about the approximation error between S_n and β, the Gamma expression might not be directly used in the proof, so maybe it's not necessary to include as an assumption. However, the user includes it in the problem statement, so to be thorough, it's better to list both definitions of β as assumptions.\n\nBut in terms of the problem structure, the user wants to prove the error bound between S_n and β, where β is given by the integral. The Gamma function expression is an exact formula for β, but perhaps it's not an assumption but a given identity. However, in the problem's context, the user is taking β as defined by the integral, so the Gamma expression might be part of the problem's background information, not an assumption. Therefore, perhaps the key assumptions are:\n\n- p ∈ [1, 2).\n- β = (1/(2π)) ∫₀²π |cos x|^p dx.\n- S_n is defined as (1/(2n)) Σₖ=₀²ⁿ⁻¹ |cos(2πk/(2n))|^p.\n\nThe problem is to prove that |S_n - β| ≤ c_p / n^{p+1} with c_p → 0 as p → 2.\n\nTherefore, the formatted problem would list each of these as separate assumptions and then state the problem to prove the bound.",
    "Original_Problem": "Assumption: \n$p$ is in the interval $[1, 2)$,\n$\\beta$ is defined as $\\frac{1}{2\\pi}\\int_0^{2\\pi} |\\cos x|^p dx$,\n$S_n$ is defined as $\\frac{1}{2n}\\sum_{k=0}^{2n-1} \\left| \\cos\\left(2\\pi \\cdot \\frac{k}{2n}\\right)\\right|^p$,\nthe approximation error is $|S_n - \\beta|$.\nProblem:\nProve that there exists a constant $c_p$ (depending only on $p$) such that $$|S_n - \\beta| \\leq \\frac{c_p}{n^{p+1}},$$ where $c_p \\to 0$ as $p \\to 2$.",
    "Original_Problem_with_numerical_assumption": "Assumption:\nAssumption 1: $p$ is in the interval $[1, 2)$,\nAssumption 2: $\\beta$ is defined as $\\frac{1}{2\\pi}\\int_0^{2\\pi} |\\cos x|^p dx$,\nAssumption 3: $S_n$ is defined as $\\frac{1}{2n}\\sum_{k=0}^{2n-1} \\left| \\cos\\left(2\\pi \\cdot \\frac{k}{2n}\\right)\\right|^p$,\nAssumption 4: the approximation error is $|S_n - \\beta|$.\nProblem:\nProve that there exists a constant $c_p$ (depending only on $p$) such that $$|S_n - \\beta| \\leq \\frac{c_p}{n^{p+1}},$$ where $c_p \\to 0$ as $p \\to 2$.",
    "Proof_problem": "Yes",
    "Redundant_assumption": "$$T_N(f)=\\frac1N\\sum_{k=0}^{N-1}\\sum_{n\\in\\mathbb{Z}}c_n e^{2\\pi ikn/N}=\\sum_{d\\in\\mathbb{Z}}c_{Nd},$$",
    "Problem_with_redundant_assumption": "Assumption:\nAssumption 1: $p$ is in the interval $[1, 2)$,\nAssumption 2: $\\beta$ is defined as $\\frac{1}{2\\pi}\\int_0^{2\\pi} |\\cos x|^p dx$,\nAssumption 3: $S_n$ is defined as $\\frac{1}{2n}\\sum_{k=0}^{2n-1} \\left| \\cos\\left(2\\pi \\cdot \\frac{k}{2n}\\right)\\right|^p$,\nAssumption 4: the approximation error is $|S_n - \\beta|$.\nAssumption 5: $$T_N(f)=\\frac1N\\sum_{k=0}^{N-1}\\sum_{n\\in\\mathbb{Z}}c_n e^{2\\pi ikn/N}=\\sum_{d\\in\\mathbb{Z}}c_{Nd},$$\nProblem:\nProve that there exists a constant $c_p$ (depending only on $p$) such that $$|S_n - \\beta| \\leq \\frac{c_p}{n^{p+1}},$$ where $c_p \\to 0$ as $p \\to 2$."
}