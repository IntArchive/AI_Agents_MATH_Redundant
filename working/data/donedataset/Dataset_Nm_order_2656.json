{
    "Link_API": "https://api.stackexchange.com/2.3/questions/3627784",
    "Title": "Does the fraction of distinct substrings in prefixes of the Thue–Morse sequence of length $2^n$ tend to $73/96$?",
    "Score": 13,
    "Category": "Chứng minh",
    "Tags": "sequences-and-series, discrete-mathematics, conjectures, experimental-mathematics, combinatorics-on-words",
    "Link": "https://math.stackexchange.com/questions/3627784/does-the-fraction-of-distinct-substrings-in-prefixes-of-the-thue-morse-sequence",
    "Content": "Recall that the Thue–Morse sequence $^{[1]}$ $\\!^{[2]}$ $\\!^{[3]}$ is an infinite binary sequence that begins with $\\,t_0 = 0,$ and whose each prefix $p_n$ of length $2^n$ is immediately followed by its bitwise complement (i.e. obtained by flipping $0\\to1$ and $1\\to0$ ): $$\n\\begin{array}{c|cc}&t_0&t_1&t_2&t_3&t_4&t_5&t_6&t_7&\\!\\!\\!\\dots\\\\\\hline\np_0&0\\\\\np_1&0&\\color{red}1\\\\\np_2&0&1&\\color{red}1&\\color{red}0\\\\\np_3&0&1&1&0&\\color{red}1&\\color{red}0&\\color{red}0&\\color{red}1\\\\\n\\cdots&\\cdots\\!\\!\n\\end{array}\n$$ We are interested in contiguous substrings of these prefixes. For a string $\\mathcal{S}$ of length $\\ell$ , the total number of its substrings, including the empty substring $\\langle\\unicode{x202f}\\rangle$ and the string $\\mathcal{S}$ itself, is $(\\ell^2+\\ell+2)/2.$ Hence, the total number of substrings in $p_n$ is $(4^n+2^n+2)/2.$ Clearly, not all of those substrings are distinct for $n>1$ . For example, $p_2 = \\langle0\\,1\\,1\\,0\\rangle$ has $11$ substrings in total, but only $9$ distinct substrings: $$\n\\begin{array}{l|cc}&\\langle\\!\\!\\!&0&\\color{#808080}1&\\color{#b8b8b8}1&\\color{#c8c8c8}0&\\!\\!\\!\\rangle\\\\\\hline\n1&\\langle\\!\\!\\!&&&&&\\!\\!\\!\\rangle\\\\\\hdashline\n2&\\langle\\!\\!\\!&0&&&&\\!\\!\\!\\rangle\\\\\n&\\langle\\!\\!\\!&&&&\\color{#c8c8c8}0&\\!\\!\\!\\rangle\\\\\\hdashline\n3&\\langle\\!\\!\\!&&\\color{#808080}1&&&\\!\\!\\!\\rangle\\\\\n&\\langle\\!\\!\\!&&&\\color{#b8b8b8}1&&\\!\\!\\!\\rangle\\\\\\hdashline\n4&\\langle\\!\\!\\!&0&\\color{#808080}1&&&\\!\\!\\!\\rangle\\\\\n5&\\langle\\!\\!\\!&&\\color{#808080}1&\\color{#b8b8b8}1&&\\!\\!\\!\\rangle\\\\\n6&\\langle\\!\\!\\!&&&\\color{#b8b8b8}1&\\color{#c8c8c8}0&\\!\\!\\!\\rangle\\\\\n7&\\langle\\!\\!\\!&0&\\color{#808080}1&\\color{#b8b8b8}1&&\\!\\!\\!\\rangle\\\\\n8&\\langle\\!\\!\\!&&\\color{#808080}1&\\color{#b8b8b8}1&\\color{#c8c8c8}0&\\!\\!\\!\\rangle\\\\\n9&\\langle\\!\\!\\!&0&\\color{#808080}1&\\color{#b8b8b8}1&\\color{#c8c8c8}0&\\!\\!\\!\\rangle\n\\end{array}\n$$ Among these, $\\langle0\\rangle$ and $\\langle1\\rangle$ appear in $p_2$ twice, so the fraction of distinct substrings in $p_2$ is $\\,\\stackrel9{}\\!\\!\\unicode{x2215}_{\\!\\unicode{x202f}11}\\!.$ Can we find a simple general formula for $\\mathscr D_n$ , the number of distinct substrings in $p_n$ ? Let's try to compute a few terms: $$2,\\,4,\\,9,\\,28,\\,101,\\,393,\\,1561,\\,6233,\\,24921,\\,99673,\\,398681,\\,1594713,\\,6378841,\\,\\dots$$ These few terms can be computed by a brute-force approach, but using Coolwater 's program from here we can compute hundreds of thousands more. It is not too difficult to discover that for $n>2$ all known terms match a simple formula: $$\\mathscr D_n\\stackrel{\\color{#d0d0d0}?}=\\frac{73\\cdot4^n+704}{192}\\color{#d0d0d0}{,\\,\\,\\text{for}\\,\\,n>2}\\tag{$\\diamond$}$$ Somewhat oddly, the three initial terms $\\mathscr D_0=2,\\,\\mathscr D_1=4,$ and $\\mathscr D_2=9$ do not match the general formula $(\\diamond)$ , which results in non-integer rational values for these indexes. I conjecture that the general formula $(\\diamond)$ is valid for all $n>2$ . $$\\bbox[LemonChiffon]{\\begin{array}{c}\n\\\\\n\\hspace{1in}\\text{Could you suggest a way to prove this conjecture?}\\hspace{1in}\\\\\n\\vphantom.\n\\end{array}}$$ If the conjecture turns out to be true, then we have a remarkable corollary that for $n\\to\\infty$ the fraction of distinct substrings in the prefixes $p_n$ tends to a quite surprising limit: $$\\mathscr L=\\lim_{n\\to\\infty}\\frac{73\\cdot4^n+704}{192}{\\large/}\\frac{4^n+2^n+2}2=\\frac{73}{96}.\\tag{$\\small\\spadesuit$}$$",
    "AcceptedAnswer": "J.-E. Pin has described the following fact in detail according to Proposition 4.2 in Enumeration of factors in the Thue-Morse word by Srećko Brlek. Formulas of $P(n,m)$ . Let $P(n,m)$ be the number of distinct substrings of length $m$ of $p_n$ , $0\\le m\\le2^n$ . We have $$\\begin{align}\n&\\begin{array}{c|cccccccc}\nP_n(m)& m=1 & m=2 & m=3 & m=4 & m=5 &m=6 &m=7 &m=8\\\\\n\\hline\nn=1&2&1\\\\\nn=2&2&3&2&1\\\\\nn=3&2&4&6&5&4&3&2&1\\\\\n\\end{array}\\\\\n\\text{If } n\\ge4,\\\\\n&P_n(m)=\\begin{cases}\n P_{n-1}(m)\\quad &\\text{ for } m\\le2^{n-3}+1,\\\\ \n 4(m-1)-2^{n-3}\\quad &\\text{ for } 2^{n-3}+1\\le m\\le 2^{n-3} + 2^{n-4}+1,\\\\\n 2^{n-2}+2(m-1)\\quad &\\text{ for } 2^{n-3} + 2^{n-4}+1\\le m\\le 2^{n-2}+1,\\\\\n 2^{n} -(m-1)\\quad &\\text{ for } 2^{n-2}+1\\le m.\\\\\n\\end{cases}\n\\end{align}$$ As defined in question, $\\mathscr D_{n} = \\sum_{m=0}^{2^n}p(n,m)$ . Proposition : $\\mathscr D_{n} = \\dfrac{73\\cdot 4^{n-3} + 11}{3}$ for $n\\ge3$ . Proof : Let $\\mathscr C_{n}=\\sum_{m=0}^{2^{n-2}}p(n,m)$ . Let us prove $\\mathscr C_n=\\dfrac{38\\cdot4^{n-3}-9\\cdot2^{n-2}+22}6$ by induction on $n$ . The base case, $\\mathscr C_3=7$ can be verified directly. Suppose it is true for $n$ . $$\\begin{align}\\mathscr C_{n+1}\n&= \\sum_{m=0}^{2^{n-2}}p(n+1,m)\\ +\\sum_{m=2^{n-2}+1}^{2^{n-2}+2^{n-3}}p(n+1,m)\n  \\ +\\sum_{m=2^{n-2}+2^{n-3}+1}^{2^{n-1}}p(n+1,m) \\\\\n&= \\sum_{m=0}^{2^{n-2}}p(n,m)\\ \n  +\\sum_{m=2^{n-2}+1}^{2^{n-2}+2^{n-3}}\\left(4(m-1)-2^{n-2}\\right)\\ \n  +\\sum_{m=2^{n-2}+2^{n-3}+1}^{2^{n-1}} \\left(2^{n-1}+2(m-1)\\right) \\\\\n&=\\mathscr C_n+2^{n-3}(-2^{n-2}) +2^{n-3}\\cdot2^{n-1}\\\n  +\\sum_{m=2^{n-2}+1}^{2^{n-2}+2^{n-3}}4(m-1)\\ \n  +\\sum_{m=2^{n-2}+2^{n-3}+1}^{2^{n-1}} 2(m-1) \\\\\n&= \\mathscr C_n+2^{2n-5} +4\\cdot2^{n-3}(2^{n-1}+2^{n-3}-1)/2+2\\cdot2^{n-3}(2^{n-1}+2^{n-2}+2^{n-3}-1)/2\\\\\n&= \\dfrac{38\\cdot4^{n-3}-9\\cdot2^{n-2}+22}6+19\\cdot4^{n-3} -3\\cdot2^{n-3}\\\\\n&= \\dfrac{38\\cdot4^{n-2}-9\\cdot2^{n-1}+22}6.\\\\\n\\end{align}$$ So we have proved the formula for $\\mathscr C_n$ . $$\\begin{align}\n\\mathscr D_{n}\n&=\\mathscr C_{n} +\\sum_{m=2^{n-2}+1}^{2^{n}}P_{n}(m) \\\\\n&= \\dfrac{38\\cdot4^{n-3}-9\\cdot2^{n-2}+22}6 + \\sum_{m=2^{n-2}+1}^{2^n}2^n-(m-1)\\\\\n&= \\dfrac{38\\cdot4^{n-3}-9\\cdot2^{n-2}+22}6 + (2^n-2^{n-2})(2^{n+1}-2^{n-2}-(2^n-1))/2\\\\\n&= \\frac{73\\cdot 4^{n-3} + 11}{3}. \\quad \\blacksquare\n\\end{align}$$ As user125932 points out in this comment , the formula for $\\mathscr D_n$ appears in Theorem 14 of on the structure of compacted subword graphs of Thue-Morse words and their applications by Jakub Radoszewski and Wojciech Rytter. Theorem 14. The number of different factors of $p_n$ for $n\\ge4$ equals $\\frac{73}{192} |p_n|^2 + \\frac83$ . Here factors means non-empty substrings while empty string is counted in $\\mathscr D_n$ . Note that $|p_n|=2^n$ and $\\frac{704}{192}=\\frac83+1$ . The formalization can be generalized. Given a string $w$ made of $0$ and $1$ , define sequence ${}_wP$ , that begins with ${}_wp_0=w$ , and ${}_wp_{n+1}$ is ${}_wp_{n}$ followed by its bitwise complement. The Thue-Morse sequence $p_0, p_1, p_2,\\cdots$ is just sequence ${}_{0}P$ . For example, sequence ${}_{00}P$ is $00, 00\\underline{11}, 00\\,\\underline{11}\\,\\underline{1100}, \\cdots$ . For another example, sequence ${}_{01011}P$ is $01011, 01011\\,\\underline{10100}, 01011\\,\\underline{10100}\\,\\underline{1010001011}, \\cdots$ . Let ${}_w\\mathscr D_n $ be the number of distinct substrings in ${}_wp_n$ . This question and answers give the formula for ${}_0\\mathscr D_n$ . It looks like we also have the following formulas. It might be interesting to prove them and generalize them further. $$\\begin{align}\n{}_{00}\\mathscr D_{n}&=\\frac{73\\cdot4^{n-2}+11}{3}\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge3}\\\\\n{}_{000}\\mathscr D_{n}&=219\\cdot4^{n-3}+1\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge3}\\\\\n{}_{001}\\mathscr D_{n}&=219\\cdot4^{n-3}+9\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge3}\\\\\n{}_{010}\\mathscr D_{n}&=219\\cdot4^{n-3}-23\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge4}\\\\\n{}_{0001}\\mathscr D_{n}&=\\frac{73\\cdot4^{n-1}+41}{3}\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge3}\\\\\n{}_{0100}\\mathscr D_{n}&=\\frac{73\\cdot4^{n-1}+41}{3}\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge3}\\\\\n{}_{0101}\\mathscr D_{n}&=\\frac{73\\cdot4^{n-1}-13}{3}\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge3}\\\\\n{}_{01000}\\mathscr D_{n}&=\\frac{1825\\cdot4^{n-3}+59}{3}\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge3}\\\\\n{}_{01011}\\mathscr D_{n}&=\\frac{1825\\cdot4^{n-3}+59}{3}\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge3}\\\\\n{}_{010001}\\mathscr D_{n}&=219\\cdot4^{n-2}+35\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge3}\\\\\n{}_{0000001}\\mathscr D_{n}&=\\frac{3577\\cdot4^{n-3}+107}{3}\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge3}\\\\\n{}_{01010101}\\mathscr D_{n}&=\\frac{73\\cdot4^{n}-157}{3}\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge3}\\\\\n{}_{011001111}\\mathscr D_{n}&=1971\\cdot4^{n-3}+81\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge3}\\\\\n{}_{0010011100}\\mathscr D_{n}&=\\frac{1825\\cdot4^{n-2}+323}{3}\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge3}\\\\\n{}_{01011010000}\\mathscr D_{n}&=\\frac{8833\\cdot4^{n-3}+371}{3}\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge3}\\\\\n{}_{011111100000}\\mathscr D_{n}&=219\\cdot4^{n-1}+27\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge2}\\\\\n{}_{0101010101010}\\mathscr D_{n}&=\\frac{12337\\cdot4^{n-3}-2389}{3}\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge4}\\\\\n{}_{01010101010111}\\mathscr D_{n}&=\\frac{3577\\cdot4^{n-2}+401}{3}\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge3}\\\\\n{}_{010101000101111}\\mathscr D_{n}&=5475\\cdot4^{n-3}+231\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge3}\\\\\n{}_{0000010000001111}\\mathscr D_{n}&=\\frac{73\\cdot4^{n+1}+791}{3}\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge3}\\\\\n{}_{010110011101010001}\\mathscr D_{n}&=1971\\cdot4^{n-2}+381\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge3}\\\\\n{}_{0101010101010101010}\\mathscr D_{n}&=\\frac{26353\\cdot4^{n-3}-5317}{3}\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge4}\\\\\n{}_{0101010101010101111}\\mathscr D_{n}&=\\frac{26353\\cdot4^{n-3}+731}{3}\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge3}\\\\\n{}_{001001001001001001001}\\mathscr D_{n}&=10731\\cdot4^{n-3}-351\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge3}\\\\\n{}_{0001011000101100010110001011}\\mathscr D_{n}&=\\frac{3577\\cdot4^{n-1}-1021}{3}\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge2}\\\\\n{}_{0101010101010101010101010101010101010101010101010}\\mathscr D_{n}&=\\frac{175273\\cdot4^{n-3}-37237}{3}\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge4}\\\\\n{}_{000000000000000000000000000000000000000000000000000000001}\\mathscr D_{n}&=79059\\cdot4^{n-3}+2169\\color{#d0d0d0}{,\\ \\text{for}\\,\\,n\\ge3}\\\\\n\\end{align}$$",
    "llm_answer_create_structured_problem": "###BEGIN_OF_FORMAT###\nAssumption: \nThe Thue–Morse sequence begins with $t_0 = 0$,\nEach prefix $p_n$ of length $2^n$ is constructed by appending the bitwise complement of $p_{n-1}$,\n$\\mathscr D_n$ denotes the number of distinct contiguous substrings in $p_n$,\n$n$ is an integer,\n$n > 2$.\nProblem: \nProve that $$\\mathscr D_n = \\frac{73 \\cdot 4^n + 704}{192}$$ for $n > 2$.\n###",
    "reasoning_create_structured_problem": "Okay, let me try to parse this problem. The user wants me to act as a math professor and structure the given Math Stack Exchange question into the specified format. The example provided shows that I need to list assumptions line by line, each addressing one property or condition applied to one object, then state the problem clearly.\n\nFirst, let me read the original question carefully. The title asks if the fraction of distinct substrings in prefixes of the Thue-Morse sequence of length 2^n tends to 73/96. The problem involves the Thue-Morse sequence, specifically its prefixes p_n of length 2^n. The user defines p_n as each prefix of the Thue-Morse sequence, which is built by appending the bitwise complement of the current prefix. The question then talks about the number of distinct substrings in these prefixes and presents a conjecture for a general formula for D_n (the number of distinct substrings) when n > 2, which is (73*4^n + 704)/192. They want to prove this conjecture and note that the limit of the fraction tends to 73/96.\n\nNow, I need to extract the assumptions. The key points are:\n\n1. The Thue-Morse sequence is considered. So t_0 = 0, and each prefix p_n of length 2^n is followed by its bitwise complement.\n2. The problem is about the number of distinct substrings in p_n.\n3. The formula for total substrings is given as (4^n + 2^n + 2)/2, but this isn't an assumption; it's a calculation based on the string length. However, the key assumption here is that for each prefix p_n, the total number of substrings is (4^n + 2^n + 2)/2. Wait, but actually, the user says \"for a string S of length l, the total number of its substrings... is (l² + l + 2)/2\". So the assumption here is that the formula for total substrings applies to p_n. But since p_n has length 2^n, substituting l = 2^n gives that total substrings. But maybe that's part of the problem setup, not an assumption. Wait, the problem is to find D_n, the number of distinct substrings, given that the total number (non-distinct) is (4^n + 2^n + 2)/2. Hmm.\n\nWait, the assumptions would be the conditions given in the problem. Let me check the example again. The example listed assumptions as n being an integer and divisible by 7. So in the original problem here, the assumptions would be:\n\n- The Thue-Morse sequence is defined with t_0 = 0, and each prefix p_n of length 2^n is immediately followed by its bitwise complement.\n- The problem considers contiguous substrings of these prefixes p_n.\n- The formula for total substrings (including duplicates) for a string of length l is (l² + l + 2)/2. Therefore, for p_n of length 2^n, the total is (4^n + 2^n + 2)/2.\n- The conjecture is that for n > 2, D_n = (73·4^n + 704)/192.\n\nBut wait, the problem is to prove this conjecture. The user is asking for a way to prove the formula for D_n when n > 2. So the assumptions would be the conditions under which the problem is posed.\n\nLooking at the example, the assumptions were about the properties of n. Here, the key assumptions are about the structure of the Thue-Morse sequence prefixes p_n and the formula for total substrings.\n\nBut the problem's main focus is on proving that D_n follows the given formula for n > 2. So the assumptions should include:\n\n- The Thue-Morse sequence is constructed such that each prefix p_n of length 2^n is followed by its bitwise complement.\n- For each prefix p_n of length 2^n, the number of distinct substrings D_n is to be determined.\n- The formula for total substrings (including duplicates) in p_n is (4^n + 2^n + 2)/2.\n\nBut maybe not all of these are necessary. Let me check the original example again. The original problem had A(n) defined, and the assumption was that n is an integer and n is divisible by 7. The problem then was to prove that A(n) is divisible by 91. So in that case, the assumptions were the conditions on n. Here, perhaps the key assumptions are about the structure of the Thue-Morse sequence and the definition of D_n.\n\nWait, the problem is about the Thue-Morse sequence's prefixes, so the main assumption is that the prefixes p_n are built as described. Also, perhaps that we are considering all contiguous substrings (including empty and the whole string). But the problem statement already says that D_n is the number of distinct substrings in p_n.\n\nSo to structure the problem:\n\nAssumptions:\n\n- The Thue-Morse sequence begins with t_0 = 0, and each prefix p_n of length 2^n is immediately followed by its bitwise complement.\n- For each prefix p_n of length 2^n, the number of distinct contiguous substrings is denoted by D_n.\n- The formula for the total number of substrings (including duplicates) in a string of length l is (l² + l + 2)/2, leading to (4^n + 2^n + 2)/2 for p_n.\n- The conjecture is that for n > 2, D_n = (73·4^n + 704)/192.\n\nBut wait, the problem is to prove the conjecture. So perhaps the assumptions are the properties given, and the problem is to prove that D_n equals that formula for n > 2.\n\nBut the example only listed the conditions on the variables. Here, the Thue-Morse construction is part of the problem setup, not an assumption. Hmm, perhaps the key is to list the properties that are given as premises for the problem. For example, the Thue-Morse sequence's construction is part of the problem's definition, so the assumption is that we are working with the Thue-Morse sequence as defined. Also, the problem is about prefixes p_n of length 2^n, so maybe another assumption is that n is a non-negative integer. But the user might have already considered that.\n\nAlternatively, perhaps the assumptions are:\n\n- The Thue-Morse sequence is defined with each prefix p_n of length 2^n constructed by appending the bitwise complement of the previous prefix.\n- The number of distinct substrings in p_n is denoted by D_n.\n- The conjecture is that D_n = (73·4^n + 704)/192 for n > 2.\n\nBut the problem is to prove this conjecture, so the problem statement would be: \"Prove that for n > 2, D_n = (73·4^n + 704)/192.\"\n\nBut in the example, the problem was to prove A(n) is divisible by 91, given that n is an integer divisible by 7.\n\nWait, the example's assumptions were two: n is an integer and n is divisible by 7. Then the problem was to prove A(n) divisible by 91.\n\nSo in this case, the assumptions would be the conditions on n and the structure of the Thue-Morse sequence. But here, the problem's conjecture is for n > 2. So perhaps the assumptions are:\n\n- n is an integer greater than 2.\n- The Thue-Morse sequence prefixes p_n are constructed as described (each p_n of length 2^n is followed by its complement).\n\nBut perhaps more precise. Let's try:\n\nAssumption:\n\n- The Thue-Morse sequence is constructed such that each prefix p_n has length 2^n and is followed by its bitwise complement.\n- The number of distinct substrings in p_n is denoted by D_n.\n- The formula D_n = (73·4^n + 704)/192 holds for n > 2.\n\nWait, but the problem is to prove the formula, so the conjecture is not an assumption. So the assumptions are the given conditions of the problem. The problem is to prove that D_n equals that formula for n > 2.\n\nThus, the assumptions are the definitions and conditions under which D_n is defined. So:\n\nAssumptions:\n\n- The Thue-Morse sequence is defined such that each prefix p_n of length 2^n is followed by its bitwise complement.\n- For each n, D_n is the number of distinct contiguous substrings in p_n.\n- The total number of substrings (including duplicates) in p_n is (4^n + 2^n + 2)/2.\n\nBut the problem is to prove that D_n = (73*4^n + 704)/192 for n > 2.\n\nWait, but the total number of substrings is given as part of the problem's context. However, the problem is about the distinct substrings. So maybe the total substrings formula is just provided for context, not an assumption. The key assumptions would be about the structure of the Thue-Morse sequence and the definition of D_n.\n\nTherefore, perhaps:\n\nAssumptions:\n\n- The Thue-Morse sequence prefixes p_n have length 2^n and are constructed by appending the bitwise complement of the previous prefix.\n- D_n is the number of distinct contiguous substrings in p_n.\n- The problem considers n > 2.\n\nProblem: Prove that D_n = (73·4^n + 704)/192 for n > 2.\n\nBut in the example, the assumptions included n being an integer and divisible by 7. Here, the main assumptions are the construction of the Thue-Morse sequence and that D_n counts distinct substrings in p_n. Also, the problem is specifically for n > 2.\n\nBut the user's example had assumptions on the variable (n is integer, n divisible by 7). Here, the variable n is an integer (as in the problem statement, n=0,1,2,...). But the problem's conjecture is for n > 2, so perhaps that's part of the problem statement, not the assumption. Wait, in the example, the assumption was that n is divisible by 7. Here, the conjecture is for n > 2, so the problem is to prove for n > 2, hence the assumption would be n > 2. But maybe the user's example included the divisibility as an assumption because the original problem had a mistake, but here, the problem is to prove the formula holds for n > 2.\n\nSo the assumptions should include:\n\n- n is an integer greater than 2.\n- The prefixes p_n are constructed as per the Thue-Morse sequence definition.\n- D_n is the number of distinct substrings in p_n.\n\nBut the problem is to prove that D_n equals the given formula. So perhaps:\n\nAssumptions:\n- n is an integer with n > 2.\n- The Thue-Morse sequence prefix p_n is of length 2^n, constructed by appending the bitwise complement of p_{n-1}.\n- D_n denotes the number of distinct contiguous substrings in p_n.\n\nProblem: Prove that D_n = (73·4^n + 704)/192.\n\nThis seems to fit the example's structure. Each assumption is a single property applied to one object. For example, \"n is an integer\" and \"n is divisible by 7\" were separate lines. So here, \"n is an integer with n > 2\" could be split into two: \"n is an integer\" and \"n > 2\". But in the example, the original problem had \"for every integer n\", but the formatted problem's assumption was \"n is an integer, n is divisible by 7\". So the user split the conditions.\n\nWait, the original problem was to prove for every integer n, A(n) is divisible by 91. But the formatted problem's assumption was n is an integer and n divisible by 7, which was incorrect. Wait, the original example's correct assumption should be that n is an integer (as the problem states \"for every integer n\"), but perhaps the user made a mistake. Wait, the example given by the user was:\n\nOriginal problem: Prove that for every integer n, A(n) is divisible by 91.\n\nFormatted problem's assumption: n is an integer, n is divisible by 7.\n\nProblem: Prove that A(n) is divisible by 91.\n\nBut that seems incorrect because the original problem says \"for every integer n\", but in the formatted problem, the assumption adds that n is divisible by 7, which restricts it. However, perhaps the original example had a mistake, but the user's instruction was to structure the problem as per the example. Therefore, perhaps in this problem, the assumptions should include the structure of the Thue-Morse sequence and the definition of D_n, and n > 2.\n\nBut to follow the example's format, each assumption is a single condition. So for this problem:\n\nAssumption:\n\n- The Thue-Morse sequence begins with t_0 = 0.\n- Each prefix p_n of length 2^n is followed by its bitwise complement.\n- D_n is the number of distinct contiguous substrings in p_n.\n- n is an integer.\n- n > 2.\n\nProblem: Prove that D_n = (73·4^n + 704)/192.\n\nThis way, each assumption is one line, each addressing one property. The Thue-Morse sequence's starting point, the construction of prefixes, the definition of D_n, n being integer, and n being greater than 2.\n\nThis should align with the example's structure. The problem is then to prove the formula for D_n under these assumptions.",
    "Original_Problem": "Assumption: \nThe Thue–Morse sequence begins with $t_0 = 0$,\nEach prefix $p_n$ of length $2^n$ is constructed by appending the bitwise complement of $p_{n-1}$,\n$\\mathscr D_n$ denotes the number of distinct contiguous substrings in $p_n$,\n$n$ is an integer,\n$n > 2$.\nProblem: \nProve that $$\\mathscr D_n = \\frac{73 \\cdot 4^n + 704}{192}$$ for $n > 2$.",
    "Original_Problem_with_numerical_assumption": "Assumption:\nAssumption 1: The Thue–Morse sequence begins with $t_0 = 0$,\nAssumption 2: Each prefix $p_n$ of length $2^n$ is constructed by appending the bitwise complement of $p_{n-1}$,\nAssumption 3: $\\mathscr D_n$ denotes the number of distinct contiguous substrings in $p_n$,\nAssumption 4: $n$ is an integer,\nAssumption 5: $n > 2$.\nProblem: \nProve that $$\\mathscr D_n = \\frac{73 \\cdot 4^n + 704}{192}$$ for $n > 2$.",
    "Proof_problem": "Yes",
    "Redundant_assumption": "$$\\begin{align}\n\\mathscr D_{n}\n&=\\mathscr C_{n} +\\sum_{m=2^{n-2}+1}^{2^{n}}P_{n}(m) \\\\\n&= \\dfrac{38\\cdot4^{n-3}-9\\cdot2^{n-2}+22}6 + \\sum_{m=2^{n-2}+1}^{2^n}2^n-(m-1)\\\\\n&= \\dfrac{38\\cdot4^{n-3}-9\\cdot2^{n-2}+22}6 + (2^n-2^{n-2})(2^{n+1}-2^{n-2}-(2^n-1))/2\\\\\n&= \\frac{73\\cdot 4^{n-3} + 11}{3}. \\quad \\blacksquare\n\\end{align}$$",
    "Problem_with_redundant_assumption": "Assumption:\nAssumption 1: The Thue–Morse sequence begins with $t_0 = 0$,\nAssumption 2: Each prefix $p_n$ of length $2^n$ is constructed by appending the bitwise complement of $p_{n-1}$,\nAssumption 3: $\\mathscr D_n$ denotes the number of distinct contiguous substrings in $p_n$,\nAssumption 4: $n$ is an integer,\nAssumption 5: $n > 2$.\nAssumption 6: $$\\begin{align}\n\\mathscr D_{n}\n&=\\mathscr C_{n} +\\sum_{m=2^{n-2}+1}^{2^{n}}P_{n}(m) \\\\\n&= \\dfrac{38\\cdot4^{n-3}-9\\cdot2^{n-2}+22}6 + \\sum_{m=2^{n-2}+1}^{2^n}2^n-(m-1)\\\\\n&= \\dfrac{38\\cdot4^{n-3}-9\\cdot2^{n-2}+22}6 + (2^n-2^{n-2})(2^{n+1}-2^{n-2}-(2^n-1))/2\\\\\n&= \\frac{73\\cdot 4^{n-3} + 11}{3}. \\quad \\blacksquare\n\\end{align}$$\nProblem: \nProve that $$\\mathscr D_n = \\frac{73 \\cdot 4^n + 704}{192}$$ for $n > 2$."
}