{
    "Link_API": "https://api.stackexchange.com/2.3/questions/307299",
    "Title": "Kronecker product and the commutation matrix",
    "Score": 12,
    "Category": "Chứng minh",
    "Tags": "matrices",
    "Link": "https://math.stackexchange.com/questions/307299/kronecker-product-and-the-commutation-matrix",
    "Content": "Prove that for every $m \\times n$ matrix $A$ and $r \\times q$ matrix $B$ it holds that $$K(r,m)(A \\otimes B)K(n,q) = B \\otimes A.$$ I looked up the definition of the commutation matrix which is the following: Commutation matrix . However, I still do not know exactly what does the commutation matrix look like (concretely). Therefore, I do not have a clue how I can check the equation that is claimed, since I cannot do it by taking an example and checking it. Could anyone please help me out? I would very much appreciate it.",
    "AcceptedAnswer": "Commutation matrices Lets start with a basic example of a commutation matrix. Let\n$$A = \\begin{pmatrix} a_{11} & a_{12} \\\\ a_{21} & a_{22} \\end{pmatrix}$$\nthus\n$$A^T = \\begin{pmatrix} a_{11} & a_{21} \\\\ a_{12} & a_{22} \\end{pmatrix}$$\nand\n$$\\operatorname{vec}(A) = \\begin{pmatrix} a_{11} \\\\ a_{21} \\\\ a_{12} \\\\ a_{22} \\end{pmatrix}, ~~~~ \\operatorname{vec}(A^T) = \\begin{pmatrix} a_{11} \\\\ a_{12} \\\\ a_{21} \\\\  a_{22} \\end{pmatrix}.$$\nThus, the commutation matrix $K(2,2)$ is\n$$K(2,2) = \\begin{pmatrix}\n   1 & 0 & 0 & 0 \\\\\n   0 & 0 & 1 & 0 \\\\\n   0 & 1 & 0 & 0 \\\\\n   0 & 0 & 0 & 1\n\\end{pmatrix}$$\nsince $K(2,2)\\operatorname{vec}(A) = \\operatorname{vec}(A^T).$ For larger matrices, the commutation matrix will be more complicated, but it will be a permutation matrix. If $a_{ij}$ is the element at row $i$, column $j$ of the  $n \\times m$ matrix $A$, it will be in position $(j-1)n + i$ in $\\operatorname{vec}(A)$. In the $m \\times n$ matrix $A^T$ the element will be in row $j$, column $i$ and thus will be in position $(i-1)m + j$ in $\\operatorname{vec}(A^T)$. Note that for $i = j$ (which corresponds to the diagonal elements in a square matrix), the element will be in the same position in both $\\operatorname{vec}(A)$ and $\\operatorname{vec}(A^T)$. Thus, the commutation matrix $K(n,m)$ will map the element at position $(j-1)n+i$ to the $(i-1)m + j$:th position. Thus, the $(i-1)m + j$:th row of $K(n,m)$ will have a one in the $(j-1)n+i$:th position, zero in all other places. Put another way, row $k$ will have a one at position\n$$((k-1) \\mod m)n +\\left\\lfloor \\frac{k-1}{m} \\right\\rfloor + 1.$$ Using this it is straightforward to construct any commutation matrix, e.g.: $$K(3,2) = \\begin{pmatrix}\n1 & 0 & 0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 1 & 0 & 0 \\\\\n0 & 1 & 0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 1 & 0 \\\\\n0 & 0 & 1 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 1\n\\end{pmatrix}.$$ Properties of commutation matrices From the formula above one can deduce that $K(n,m) = K(m,n)^T$. In particular, $K(n,n)$ is symmetric. One can also note that $K(n,m)^{-1} = K(m,n)$. This can be seen by taking an arbitrary $n \\times m$ matrix $A$. Now, of course:\n$$K(n,m)\\operatorname{vec}(A) = \\operatorname{vec}(A^T)$$\nNow, $A^T$ is an $m \\times n$ matrix and we get:\n$$K(m,n) \\operatorname{vec}(A^T) = \\operatorname{vec}(A).$$\nThus, the action of $K(m,n)$ is the inverse of $K(n,m)$ and the matrices are each others inverses. Kronecker products and commutation matrices The equation \n$$K(r,m)(A \\otimes B)K(n,q) = B \\otimes A$$\nis equivalent to\n$$(A \\otimes B)K(n,q) =K(m,r)B \\otimes A$$\nsince $K(r,m)^{-1} = K(m,r)$. Now, pick an arbitrary $X$ and use that $$(A \\otimes B) \\operatorname{vec}(X) = \\operatorname{vec}(BXA^T)$$ (cf. Wikipedia ):\n$$\\begin{align}\n(A \\otimes B) K(n,q) \\operatorname{vec}(X) &= (A \\otimes B) \\operatorname{vec}(X^T) = \\operatorname{vec}(BX^TA^T) = \\\\\n&= K(m,r) \\operatorname{vec}(AXB^T) = K(m,r) (B \\otimes A) \\operatorname{vec}(X)\n\\end{align}$$\nwhich shows that $$(A \\otimes B)K(n,q) =K(m,r)B \\otimes A$$ since $X$ was picked arbitrarily, and hence that $$K(r,m)(A \\otimes B)K(n,q) = B \\otimes A$$ Q.E.D.",
    "llm_answer_create_structured_problem": "###BEGIN_OF_FORMAT###\nAssumption: \n$A$ is an $m \\times n$ matrix,\n$B$ is an $r \\times q$ matrix,\n$K(r,m)$ is the commutation matrix of size $rm \\times rm$,\n$K(n,q)$ is the commutation matrix of size $nq \\times nq$,\n$A \\otimes B$ is the Kronecker product of $A$ and $B$,\nthe matrix multiplication $K(r,m)(A \\otimes B)K(n,q)$ is valid.\nProblem: \nProve that $$K(r,m)(A \\otimes B)K(n,q) = B \\otimes A.$$\n###",
    "reasoning_create_structured_problem": "Okay, let's see. The user wants me to act as a bilingual math professor and structure this problem from Math Stack Exchange into the specified format. The original question is about proving an equation involving the Kronecker product and commutation matrices. \n\nFirst, I need to filter out the unrelated information. The user mentioned they looked up the definition of the commutation matrix but don't know how it looks concretely. They also can't check the equation with an example. But the main problem is the equation itself. \n\nThe problem statement is to prove that for every m×n matrix A and r×q matrix B, the product K(r,m)(A⊗B)K(n,q) equals B⊗A. The assumptions here would be about the matrices involved. Let me list each assumption line by line, each addressing one property or condition of one object.\n\nAssumptions:\n1. A is an m×n matrix.\n2. B is an r×q matrix.\n3. K(r,m) is the commutation matrix of dimensions rm×rm (since commutation matrices K(p,q) are pq×pq matrices).\n4. K(n,q) is the commutation matrix of dimensions nq×nq.\n5. The Kronecker product A⊗B is defined (which it is since A is m×n and B is r×q, resulting in an mr×nq matrix).\n6. The matrix multiplication K(r,m)(A⊗B)K(n,q) is valid. Let me check the dimensions. K(r,m) is rm×rm, A⊗B is mr×nq, K(n,q) is nq×nq. Multiplying K(r,m) with A⊗B gives rm×nq, then multiplied by K(n,q) would require that the columns of the first (nq) match the rows of K(n,q) (which is nq×nq), so yes, valid. The result should be rm×nq, but B⊗A is rq×mn. Wait, that might not match. Wait, maybe I need to verify dimensions. Wait, B is r×q, A is m×n. So B⊗A should be r×q ⊗ m×n = rm×qn. Similarly, A⊗B is m×n⊗r×q = mr×nq. Then K(r,m) is rm×rm, so K(r,m)(A⊗B) is rm×nq. Then multiplying by K(n,q) which is nq×nq. So the result is rm×nq. B⊗A is r×q⊗m×n = rm×qn. Hmm, nq and qn are the same since multiplication is commutative, so rm×nq is same as rm×qn. So dimensions match. So the multiplication is valid and the result has the same dimensions as B⊗A. So that's correct.\n\nSo the assumptions are about the sizes of A, B, and the commutation matrices. Each assumption on one line. So each line addresses one object's property. \n\nSo the formatted problem should list these assumptions and then the problem statement. The problem is to prove that the product equals B⊗A. So the assumptions would include the sizes of A and B, and the commutation matrices involved. The user might have thought that the commutation matrices have specific sizes, which they do, based on the indices given. For example, K(r,m) is a commutation matrix that rearranges the order of Kronecker products, and its size is rm×rm. Similarly, K(n,q) is nq×nq. So these are critical assumptions about the commutation matrices' dimensions. \n\nI don't see any other conditions mentioned. The problem doesn't specify any restrictions on m, n, r, q except that they are positive integers such that the matrices are defined. So the assumptions are purely about the matrices being of the specified sizes and the commutation matrices existing with their standard definitions. \n\nSo putting it all together:\n\nAssumption: \nA is an m×n matrix,\nB is an r×q matrix,\nK(r,m) is the commutation matrix of size rm×rm,\nK(n,q) is the commutation matrix of size nq×nq,\nA⊗B is the Kronecker product of A and B,\nK(r,m)(A⊗B)K(n,q) is a valid matrix multiplication.\nProblem: Prove that K(r,m)(A⊗B)K(n,q) = B⊗A.\n\nWait, but in the example provided by the user, the assumption included a divisibility condition. Here, the assumptions are more about the definitions and sizes. The user's example had two assumptions: n is an integer, and n is divisible by 7. But in the original problem, the user might have mistakenly included the divisibility by 7, but in the original problem, the example actually had \"for every integer n\", but the formatted problem listed \"n is an integer, n is divisible by 7\". Wait, that seems contradictory. Wait, no, the original problem said \"for every integer n\", but in the example, the formatted problem had \"n is divisible by 7\". Wait, perhaps the example was a different case. Maybe the user made a mistake in the example. But regardless, the current problem is about matrices and commutation matrices. So the key assumptions here are the sizes of the matrices and the commutation matrices. Therefore, the structured problem would list each matrix's size and the commutation matrices' definitions as separate assumptions.\n\nI think that's all. Let me double-check. The problem is to prove the equation with the given commutation matrices. The assumptions needed are the sizes of A, B, and the commutation matrices. Each on separate lines.",
    "Original_Problem": "Assumption: \n$A$ is an $m \\times n$ matrix,\n$B$ is an $r \\times q$ matrix,\n$K(r,m)$ is the commutation matrix of size $rm \\times rm$,\n$K(n,q)$ is the commutation matrix of size $nq \\times nq$,\n$A \\otimes B$ is the Kronecker product of $A$ and $B$,\nthe matrix multiplication $K(r,m)(A \\otimes B)K(n,q)$ is valid.\nProblem: \nProve that $$K(r,m)(A \\otimes B)K(n,q) = B \\otimes A.$$",
    "Original_Problem_with_numerical_assumption": "Assumption:\nAssumption 1: $A$ is an $m \\times n$ matrix,\nAssumption 2: $B$ is an $r \\times q$ matrix,\nAssumption 3: $K(r,m)$ is the commutation matrix of size $rm \\times rm$,\nAssumption 4: $K(n,q)$ is the commutation matrix of size $nq \\times nq$,\nAssumption 5: $A \\otimes B$ is the Kronecker product of $A$ and $B$,\nAssumption 6: the matrix multiplication $K(r,m)(A \\otimes B)K(n,q)$ is valid.\nProblem: \nProve that $$K(r,m)(A \\otimes B)K(n,q) = B \\otimes A.$$",
    "Proof_problem": "Yes",
    "Redundant_assumption": "$$(A \\otimes B) \\operatorname{vec}(X) = \\operatorname{vec}(BXA^T)$$",
    "Problem_with_redundant_assumption": "Assumption:\nAssumption 1: $A$ is an $m \\times n$ matrix,\nAssumption 2: $B$ is an $r \\times q$ matrix,\nAssumption 3: $K(r,m)$ is the commutation matrix of size $rm \\times rm$,\nAssumption 4: $K(n,q)$ is the commutation matrix of size $nq \\times nq$,\nAssumption 5: $A \\otimes B$ is the Kronecker product of $A$ and $B$,\nAssumption 6: the matrix multiplication $K(r,m)(A \\otimes B)K(n,q)$ is valid.\nAssumption 7: $$(A \\otimes B) \\operatorname{vec}(X) = \\operatorname{vec}(BXA^T)$$\nProblem: \nProve that $$K(r,m)(A \\otimes B)K(n,q) = B \\otimes A.$$"
}