{
    "Link_API": "https://api.stackexchange.com/2.3/questions/774956",
    "Title": "A Pell equation inside a Pell equation",
    "Score": 13,
    "Category": "Chứng minh",
    "Tags": "number-theory, elementary-number-theory, quadratic-forms",
    "Link": "https://math.stackexchange.com/questions/774956/a-pell-equation-inside-a-pell-equation",
    "Content": "While working on another problem (see https://mathoverflow.net/questions/143599/solving-the-quartic-equation-r4-4r3s-6r2s2-4rs3-s4-1 ), I found the following equation to be solved:\n$$ \\bigl((r+s)^2-2s^2\\bigr)^2 - 2(2rs)^2 = 1.  \\tag{*}$$ Conjecture : There are no solutions with $r > 3$; put another way the solution $(r,s)=(3,2)$ is the only solution with $r>s>0$. Clearly, $(*)$ is the Pell equation $u^2-2v^2=1$, the fundamental solution of which is [perhaps coincidentally?] $(u,v)=(3,2)$. However, in this case, every other solution $u$ is of the same form, i.e. , $u=(r+s)^2-2s^2$. This leads me to believe there is some sort of elementary descent argument that can prove the conjecture. Can anyone point me in the right direction? Thanks, Kieren. EDITED to incorporate Will Jagy's observation about \"every [other] solution\". EDIT: In addition to (*), the following similar Pell equation is simultaneously true:\n$$\n    \\bigl((r-s)^2-2s^2\\bigr)^2 - 2(r^2-s^2)^2 = -1.\n$$ EDIT (2014/06/05): Is there a way to prove that these two simultaneous Pell equations force $(r,s)$ to be a solution to $X^2-2Y^2=\\pm1$?",
    "AcceptedAnswer": "[ Edited mostly to add the uniqueness of the $(119,120,169)$ triangle\nand the elliptic-curve connection] The conjecture is correct, and equivalent to a famous theorem of Ljunggren\n(1942, see references below).  No really simple proof is known,\nand it might be that such a proof is not possible; the existence of\nseveral solutions such as $(3,2)$ suggests it's hard to get a proof\nwith elementary techniques $-$ for instance an attempt to use just\ncongruences is bound to fail because any congruence condition must\nallow the two orbits $\\{ (0,\\pm1), (1, \\pm0) \\}$ and\n$\\{(\\pm3,\\pm2), (\\pm2,\\mp3)$ of small solutions. The left-hand side $\\left( (r+s)^2 - 2s^2 \\right)^2 - 2(2rs)^2$\nis a homogeneous quartic polynomial\n$$\nQ(r,s) = r^4 + 4r^3s - 6r^2s^2 - 4rs^3 + s^4.\n$$\nHence we are dealing with the Thue equation $Q(r,s) = 1$.  Thue proved that such an equation has only finitely many\nsolutions.  His proof is ineffective, i.e. does not yield a method for\nprovably finding all solutions; but later results do make this possible.\nOne technique is implemented in several computer algebra packages,\nincluding gp in which the command thue(thueinit(r^4+4*r^3-6*r^2-4*r+1),1) yields the expected list [[-2, 3], [2, -3], [0, 1], [0, -1], [3, 2], [-3, -2], [1, 0], [-1, 0]] and reports only 14 milliseconds' computing time on my laptop.\nBut this relies on some quite difficult theorems to bound the search. The quartic $Q$ is quite nice: it has fourfold symmetry generated by\n$(r,s) \\mapsto (s,-r)$, and the roots of $Q(r,1)=0$ generate the\ncyclic quartic field ${\\bf Q}(\\cos \\pi/8) = \\frac12 \\sqrt{2+\\sqrt 2}$.\nBut ironically this symmetry makes it hard to use a more elementary\ntechnique, Skolem's $p$-adic method, which often succeeds in showing\nthat a moderately large list $L$ of solutions is complete by showing\nthat any other solution must be congruent to one of the solutions in $L$\nmodulo an arbitrarily large power of $p$.  Ljunggren thus resorted to\napplying the method not over ${\\bf Q}(\\cos \\pi/8)$ but over some quadratic\nextension, which made his proof even harder to carry out and to follow\n(though still not as hard as the bounds exploited by the thue function). The equation in the title of Ljunggren's paper is not $Q(r,s)=1$ but\n$X^2 + 1 = 2Y^4$, which has large integer solutions $(X,Y) = (\\pm 239, \\pm 13)$\n[NB $(1+\\sqrt2)^7 = 239 + 13^2 \\sqrt 2$] in addition to the clear\n$(X,Y) = (\\pm 1, \\pm 1)$.  Ljungreen showed that there are no other solutions.\nThanks to the identity\n$$\nQ(r,s)^2 + Q(r,-s)^2 = 2(r^2+s^2)^4\n$$\nit follows that any solution of $Q(r,s) = 1$ has $r^2+s^2 = 1$ or $13$,\nwhich soon yields the desired result. Conversely any integer solution of $2X^2 + 1 = Y^4$\nyields an integer solution of $Q(r,s) = 1$, as\nSteiner and Tzanakis show in Section II of their paper; they use\narithmetic in the Gaussian ring ${\\bf Z}[i]$, but one can instead\nwrite the Ljunggren's equation as a primitive Pythagorean triple\n$((X-1)/2, (X+1)/2, Y^2)$ and apply the parametrization $(m^2-n^2,2mn,m^2+n^2)$\nof Pythagorean triples twice, first to obtain\n$$\nm^2-n^2-2mn = \\pm 1, \\quad m^2+n^2 = Y^2\n$$\nand then to the resulting triple $(m,n,Y)$.  Section III then gives a proof\nof the solution of $Q(r,s) = 1$ which the authors claim is\nsimpler than Ljunggren's, but it requires \"a deep result\nof Mignotte and Waldschmidt on linear forms in logarithms\" (presumably\nthe same result that the gp program exploits), so the\nSteiner-Tzanakis proof ends up even more complicated than Ljunggren's. Ljunggren, W.:, Zur Theorie der Gleichung $x^2 + 1 = Dy^4$, Avh. Norske, Vid. Akad. Oslo 1 #5 (1942) Steiner, R., and Tzanakis, N.: Simplifying the Solution of Ljunggren's Equation $X^2 + 1 = 2Y^4$ , Journal of Number Theory 37 (1991), 123-132 P.S. 1) The Ljunggren/Pythagorean-triple connection also gives\nthe following equivalent formulation: There is a unique nearly-isosceles\nPythagorean triangle, namely $(119, 120, 169)$, whose hypotenuse is a square. (I use \"nearly isosceles\" to mean $(a,b,c)$ with $a-b = \\pm 1$.) 2) If $Q(r,s) = 1$ then $(r,s,1)$ is a integer solution of $Q(r,s) = u^2$.\nIf we seek rational solutions,\nwe get an elliptic curve $E$ isomorphic with $y^2 = x^3 - 2x$\n[explicitly $u/s^2 = t^2+2t-1 - 2x$ where $t=r/s=(y-x)/(x-2)$].\nBy standard descent techniques one shows that $E$ has infinitely many points,\neach of which is either $kP$ or $kP+T$ where $P$ is the point $(x,y)=(-1,1)$\nand $T$ is the 2-torsion point $(x,y)=(0,0)$.  The symmetries of the problem\nlet us assume without loss of generality that it's $kP$ with $k$ odd.\nAt this point we can use $p$-adic techniques to show that $k = \\pm 1$,\nwhich recovers the known solutions.  For example, if we use $p=3$\nthen it seems that the numerator of $u/s^2$ is congruent to $1 \\bmod 3^f$ iff $k \\equiv \\pm 1 \\bmod 3^{f-1}$, whence $u=1$ happens only\nat the known $k = \\pm 1$.  A proof along these lines, though still\nfar from elementary, might satisfy Mordell's desire for a proof\nsimpler than Ljunggren's, as well as Kieren MacMillan 's hope for\na proof that uses descent (though descent is not the only ingredient).",
    "llm_answer_create_structured_problem": "###BEGIN_OF_FORMAT###\nAssumption: \n$r$ and $s$ are positive integers,\n$r > s$,\n$\\bigl((r+s)^2 - 2s^2\\bigr)^2 - 2(2rs)^2 = 1$,\n$\\bigl((r-s)^2 - 2s^2\\bigr)^2 - 2(r^2 - s^2)^2 = -1$.\nProblem:\nProve that $(r, s) = (3, 2)$ is the only solution with $r > s > 0$.\n###",
    "reasoning_create_structured_problem": "Okay, let's try to parse this problem. The user is working on a quartic equation and came across a Pell equation. The main goal is to show that the only solution with r > s > 0 is (3,2), and they think there might be an elementary descent method. \n\nFirst, I need to identify the assumptions. The original equation is ((r+s)^2 - 2s^2)^2 - 2(2rs)^2 = 1. They mention that this is a Pell equation u^2 - 2v^2 = 1, where u = (r+s)^2 - 2s^2 and v = 2rs. The conjecture is that the only solution with r > s > 0 is (3,2). \n\nAnother edit adds another Pell equation: ((r - s)^2 - 2s^2)^2 - 2(r^2 - s^2)^2 = -1. The user also asks if these two simultaneous Pell equations force (r,s) to be solutions of X^2 - 2Y^2 = ±1.\n\nSo, the assumptions need to list each condition applied to the variables. Let's see:\n\nAssumption 1: r and s are positive integers (since they talk about r > s > 0, and Pell equations usually involve integers).\n\nAssumption 2: The equation ((r + s)^2 - 2s^2)^2 - 2(2rs)^2 = 1 holds. (This is the first Pell equation given.)\n\nAssumption 3: The equation ((r - s)^2 - 2s^2)^2 - 2(r^2 - s^2)^2 = -1 also holds. (The second Pell equation added in the edit.)\n\nProblem: Prove that the only solution with r > s > 0 is (r, s) = (3, 2), or show that these equations force (r, s) to satisfy X^2 - 2Y^2 = ±1.\n\nWait, but the problem has two parts. The original conjecture is about the only solution being (3,2), and then the edit asks about the simultaneous equations leading to X^2 - 2Y^2 = ±1. However, the way the user phrased the problem is: \"Prove that these two simultaneous Pell equations force (r,s) to be a solution to X^2 - 2Y^2 = ±1?\" So perhaps the problem is to show that if both equations hold, then (r,s) satisfy X^2 - 2Y^2 = ±1. But the original conjecture is that (3,2) is the only solution with r>3. Hmm. The user's main problem is to prove the conjecture, but the edit adds another related question. The example given in the initial instruction was filtering unrelated info, so maybe focus on the main problem. Let me check the original question again.\n\nOriginal question's title: A Pell equation inside a Pell equation. The main conjecture is that there are no solutions with r >3, and (3,2) is the only solution with r >s>0. The user thinks an elementary descent argument could work. Then, in the edit, they added another Pell equation and a new question about the two equations forcing (r,s) to satisfy X^2 -2Y^2=±1. \n\nSo, the problem as presented has two parts but maybe the main problem is the conjecture. However, the user's final question is \"Is there a way to prove that these two simultaneous Pell equations force (r,s) to be a solution to X^2 -2Y^2=±1?\" So perhaps the problem to structure is that, given the two Pell equations, to show that (r,s) must satisfy another Pell equation. Or maybe the problem is to show that the only solution is (3,2). Wait, but in the example given, the assumption was that n is an integer and divisible by 7, but in the original problem, the user didn't state that. However, in the example, the original problem said \"for every integer n\" but the formatted problem added \"n is divisible by 7\". Wait, that seems like a mistake. Wait, the example's original problem says \"Prove that for every integer n, the number A(n) is divisible by 91.\" But in the formatted problem, the assumption is \"n is an integer, n is divisible by 7\". Wait, that's conflicting. Wait, maybe the example was incorrect? Because if the original problem says \"for every integer n\", then the assumption should be \"n is an integer\", but the user added \"n is divisible by 7\" as an assumption, which contradicts. That might have been an error. But perhaps the user intended to restructure the problem with some unstated assumptions. But in any case, following the user's example, we need to list the assumptions line by line, each applied to one object.\n\nSo, for the current problem, the assumptions would include:\n\n- r and s are positive integers (since the problem states r > s > 0)\n\n- The equation ((r + s)^2 - 2s^2)^2 - 2(2rs)^2 = 1 holds.\n\n- The equation ((r - s)^2 - 2s^2)^2 - 2(r^2 - s^2)^2 = -1 holds.\n\nBut the user's conjecture is about the only solution being (3,2). The problem as stated in the title is \"A Pell equation inside a Pell equation\", but the main problem is to prove the conjecture. However, in the latest edit, the user asks specifically: \"Is there a way to prove that these two simultaneous Pell equations force (r,s) to be a solution to X^2-2Y^2=±1?\"\n\nSo, perhaps the problem is to show that these two equations imply that (r,s) is a solution to X^2 - 2Y^2 = ±1. Alternatively, the original problem is to prove the conjecture that (r,s)=(3,2) is the only solution with r>s>0. However, the user also mentions that (u,v)=(3,2) is the fundamental solution of the Pell equation, and they believe there's an elementary descent argument. So, the problem might be two-fold, but the user's latest edit asks specifically about proving that the two equations force (r,s) to satisfy another Pell equation. But maybe the problem statement is the conjecture. Let me parse the original question again.\n\nOriginal question: They found the equation ((r+s)^2 -2s^2)^2 -2(2rs)^2=1. Conjecture: No solutions with r>3, (3,2) is the only solution with r>s>0. They ask for an elementary descent argument. Then, edited to add another Pell equation similar to the first one, and asks if there's a way to prove that these two simultaneous equations force (r,s) to be solutions to X^2 -2Y^2=±1.\n\nSo, the problem as per the latest edit is: \"Is there a way to prove that these two simultaneous Pell equations force (r,s) to be a solution to X^2-2Y^2=±1?\" But the original conjecture is about (r,s)=(3,2). So, the problem may need to be split into two parts, but according to the user's instruction, we need to structure the problem as per the format. The example given had the problem statement as \"Prove that A(n) is divisible by 91\", with assumptions. So here, perhaps the problem is the conjecture, and the assumptions are the equations and r>s>0.\n\nBut let's list all the necessary assumptions:\n\n1. r and s are positive integers.\n\n2. r > s.\n\n3. The equation ((r + s)^2 - 2s^2)^2 - 2(2rs)^2 = 1 holds.\n\n4. The equation ((r - s)^2 - 2s^2)^2 - 2(r^2 - s^2)^2 = -1 holds.\n\nBut the user mentions \"simultaneous Pell equations\", so these two equations are both required. The problem is to show that these equations force (r,s) to satisfy X^2 - 2Y^2 = ±1, or to prove the conjecture that (3,2) is the only solution with r > s > 0. The original problem's title is about a Pell equation inside another, but the conjecture is about uniqueness.\n\nBut in the latest edit, the user explicitly asks: \"Is there a way to prove that these two simultaneous Pell equations force (r,s) to be a solution to X^2-2Y^2=±1?\" So that seems to be the specific problem they want structured. However, the original conjecture is separate. But perhaps the user wants both parts addressed? But according to the example, we need to structure the problem based on the given information. The example added an assumption that n is divisible by 7 even though the original problem said \"for every integer n\". That might be an error, but following that, perhaps here we need to extract the assumptions from the problem, even if they are not explicitly stated. However, the user's problem mentions that \"r > s >0\", so that's an assumption. The equations given are also assumptions. The variables r and s are integers (since Pell equations are over integers). So, the assumptions would be:\n\nAssumption: \nr and s are integers,\nr > s,\ns > 0,\nEquation (*): ((r + s)^2 - 2s^2)^2 - 2(2rs)^2 = 1,\nEquation (**): ((r - s)^2 - 2s^2)^2 - 2(r^2 - s^2)^2 = -1.\n\nProblem: Prove that (r, s) must be a solution to X^2 - 2Y^2 = ±1, or alternatively, prove that the only solution with r > s > 0 is (3, 2).\n\nWait, but the user's main conjecture is the latter, but the edit asks about the former. The user has two questions: the original conjecture and the subsequent edit question. The example given had one problem. Since the user's latest edit asks specifically about the two Pell equations forcing (r,s) into X^2 -2Y^2=±1, perhaps that's the problem. But the original problem is the conjecture about (3,2). The user is a bit confused. However, according to the instructions, I need to structure the problem as per the given format. Let's check the original problem's text again.\n\nOriginal question: The main conjecture is that there are no solutions with r >3, (3,2) is the only solution. Then, in an edit, they added another Pell equation and ask if these two equations force (r,s) to be solutions of X^2 -2Y^2=±1. So, the problem has two parts. But in the example, the problem was restructured to have the assumptions and the problem. The example added an assumption (n divisible by7) even though the original problem said \"for every integer n\". That seems contradictory, but maybe the example is wrong, but we need to follow it. So, perhaps in this case, the problem is to prove the conjecture that (3,2) is the only solution with r>s>0, given the two Pell equations. Alternatively, the problem is to show that the two equations imply X^2 -2Y^2=±1. Given the user's last question, perhaps the problem is: \"Is there a way to prove that these two simultaneous Pell equations force (r,s) to be a solution to X^2 -2Y^2=±1?\" So, the problem is that, given the two equations, show that (r,s) satisfy another Pell equation. Alternatively, the problem could be to show that the only solution is (3,2). \n\nTo resolve this, perhaps the problem is the original conjecture: Prove that (r,s)=(3,2) is the only solution with r>s>0. The two Pell equations are part of the assumptions. So, the assumptions would be:\n\n- r and s are positive integers.\n\n- r > s.\n\n- The equation ((r + s)^2 - 2s^2)^2 - 2(2rs)^2 = 1 holds.\n\n- The equation ((r - s)^2 - 2s^2)^2 - 2(r^2 - s^2)^2 = -1 holds.\n\nProblem: Prove that the only solution is (r, s) = (3, 2).\n\nAlternatively, if considering the edit's question, the problem would be:\n\nAssumptions: same as above.\n\nProblem: Prove that (r, s) must satisfy X^2 - 2Y^2 = ±1.\n\nBut I need to see which one the user is focusing on. The title is \"A Pell equation inside a Pell equation\", and the main conjecture is the uniqueness of (3,2). The edit's question is an additional one. However, according to the example, the problem should be structured with the main question. The example took the main problem (prove A(n) is divisible by91) even though the original problem had a different assumption. Hmm, maybe the example is flawed. But following the user's instruction, the problem should be structured as per the example. So, the formatted problem should have the assumptions listed line by line, each as a single condition, then the problem. The original problem's main question is the conjecture, but the edit adds another problem. However, the user might have intended to have both, but according to the example, it's one problem. So perhaps the main problem is the conjecture, and the assumptions include the two equations. Alternatively, since the user mentioned in the edit \"Is there a way to prove that these two simultaneous Pell equations force...\", perhaps that's the problem. Given that, maybe the problem to structure is:\n\nAssumption: r and s are integers,\n\nr > s > 0,\n\nEquation (*): ((r + s)^2 - 2s^2)^2 - 2(2rs)^2 = 1,\n\nEquation (**): ((r - s)^2 - 2s^2)^2 - 2(r^2 - s^2)^2 = -1.\n\nProblem: Prove that (r, s) must be a solution to X^2 - 2Y^2 = ±1.\n\nAlternatively, the problem is to prove the conjecture that (3,2) is the only solution. Given the example, which focused on the main problem in the original post, perhaps the problem here is the conjecture. However, the user's latest edit adds a specific question about the two equations leading to another Pell equation, which might be a separate problem. Since the user includes both, but the instructions say to filter unrelated information, perhaps the main problem is the conjecture. However, in the example, the assumption added a condition (n divisible by7) that wasn't in the original problem. Wait, the original problem in the example was \"Prove that for every integer n, A(n) is divisible by91\", but in the formatted problem, the assumption was \"n is an integer, n is divisible by7\". This seems incorrect, as the original problem states \"for every integer n\", which would mean the assumption shouldn't restrict n. But the example formatted problem added an assumption that n is divisible by7, which changes the problem. This suggests that perhaps the example is incorrect, but following that, maybe the assistant is supposed to extract implicit assumptions. But in the current problem, the user's main conjecture is about r>3 and (3,2) being the only solution. The two Pell equations are given as conditions. So, the assumptions should be:\n\n- r and s are positive integers,\n\n- r > s,\n\n- Equation (*) holds,\n\n- Equation (**) holds.\n\nProblem: Prove that the only solution is (r, s) = (3, 2).\n\nAlternatively, if we follow the user's final question in the edit, the problem is to show that the two equations imply (r,s) satisfy X^2 -2Y^2=±1. But since the example added an assumption not present in the original problem, maybe here we need to include the two equations as assumptions and pose the problem as the conjecture. Therefore, the formatted problem would be:\n\nAssumption:\nr and s are positive integers,\nr > s,\nEquation (*): ((r + s)^2 - 2s^2)^2 - 2(2rs)^2 = 1,\nEquation (**): ((r - s)^2 - 2s^2)^2 - 2(r^2 - s^2)^2 = -1.\n\nProblem:\nProve that the only solution is (r, s) = (3, 2).\n\nAlternatively, if the user's final question is about linking to X^2-2Y^2=±1, then:\n\nProblem:\nProve that (r, s) must be a solution to X^2 - 2Y^2 = ±1.\n\nBut the user's main problem is the conjecture. Given the example's structure, which took the main problem (prove divisibility by91) even though the original said \"for every integer n\", but formatted it with an added assumption (n divisible by7), perhaps in this case, we need to structure the main problem as the conjecture, with the assumptions being the equations and r>s>0. The added Pell equations are part of the problem's conditions. Therefore, the correct formatted problem would list the assumptions and the problem as proving the uniqueness of (3,2).",
    "Original_Problem": "Assumption: \n$r$ and $s$ are positive integers,\n$r > s$,\n$\\bigl((r+s)^2 - 2s^2\\bigr)^2 - 2(2rs)^2 = 1$,\n$\\bigl((r-s)^2 - 2s^2\\bigr)^2 - 2(r^2 - s^2)^2 = -1$.\nProblem:\nProve that $(r, s) = (3, 2)$ is the only solution with $r > s > 0$.",
    "Original_Problem_with_numerical_assumption": "Assumption:\nAssumption 1: $r$ and $s$ are positive integers,\nAssumption 2: $r > s$,\nAssumption 3: $\\bigl((r+s)^2 - 2s^2\\bigr)^2 - 2(2rs)^2 = 1$,\nAssumption 4: $\\bigl((r-s)^2 - 2s^2\\bigr)^2 - 2(r^2 - s^2)^2 = -1$.\nProblem:\nProve that $(r, s) = (3, 2)$ is the only solution with $r > s > 0$.",
    "Proof_problem": "Yes",
    "Redundant_assumption": "$$\nQ(r,s) = r^4 + 4r^3s - 6r^2s^2 - 4rs^3 + s^4.\n$$",
    "Problem_with_redundant_assumption": "Assumption:\nAssumption 1: $r$ and $s$ are positive integers,\nAssumption 2: $r > s$,\nAssumption 3: $\\bigl((r+s)^2 - 2s^2\\bigr)^2 - 2(2rs)^2 = 1$,\nAssumption 4: $\\bigl((r-s)^2 - 2s^2\\bigr)^2 - 2(r^2 - s^2)^2 = -1$.\nAssumption 5: $$\nQ(r,s) = r^4 + 4r^3s - 6r^2s^2 - 4rs^3 + s^4.\n$$\nProblem:\nProve that $(r, s) = (3, 2)$ is the only solution with $r > s > 0$."
}