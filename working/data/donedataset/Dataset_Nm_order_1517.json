{
    "Link_API": "https://api.stackexchange.com/2.3/questions/133628",
    "Title": "Distribution of hitting time of line by Brownian motion",
    "Score": 20,
    "Category": "Chứng minh",
    "Tags": "stochastic-processes",
    "Link": "https://math.stackexchange.com/questions/133628/distribution-of-hitting-time-of-line-by-brownian-motion",
    "Content": "I came across the following question: Let $T_{a,b}$ denote the first hitting time of the line $a + bs$ by a standard Brownian\n  motion, where $a > 0$ and $−\\infty < b < \\infty$ and let $T_a = T_{a,0}$ represent the first hitting time of the level $a$. 1) For $\\theta > 0$, by using the fact that $\\mathbb{E}e^{-\\theta T_a}=e^{-a\\sqrt{2\\theta}}$, or otherwise, derive an expression for $Ee^{-\\theta T_{a,b}}$, for each $b$, $−\\infty < b < \\infty$. 2) Hence, or otherwise, show that, for $t > 0$, \n  $$\\mathbb{P}[T_{a,b}\\leq t] = e^{-2ab}\\phi\\left(\\frac{bt-a}{\\sqrt{t}}\\right)+1-\\phi\\left(\\frac{a+bt}{\\sqrt{t}}\\right).$$ For the first part, I ended up, by changing measure, with the (unverified) expression $$\\mathbb{E}e^{-\\theta T_{a,b}}=\\exp\\left(-a\\left[b+\\sqrt{2\\left(\\theta+\\frac{b^2}{2}\\right)}\\right]\\right).$$ What's the cleanest way to do the second part? It seems I could either do some kind of inverse transform on the moment generating function, or calculate the moment generating function of the given distribution. Both of these seem difficult. Am I missing something, or do I just need to persevere? Thank you.",
    "AcceptedAnswer": "First part The probability density of $T_{a,0}$ is well-known:\n$$\n    f_{T_{a,0}}(t) = \\frac{a}{\\sqrt{2 \\pi}} t^{-3/2} \\exp\\left( -\\frac{a^2}{2t} \\right)\n$$\nFrom here, for $\\theta >0$, $$\n   \\mathbb{E}\\left( \\mathrm{e}^{-\\theta T_{a,0}} \\right) = \\int_0^\\infty \\frac{a}{\\sqrt{2 \\pi t}} \\exp\\left( -\\theta t -\\frac{a^2}{2t} \\right) \\frac{\\mathrm{d} t}{t} \\stackrel{t = a^2 u}{=} \\int_0^\\infty \\frac{1}{\\sqrt{2 \\pi u}} \\exp\\left( -\\theta a^2 u -\\frac{1}{2 u} \\right) \\frac{\\mathrm{d} u}{u}\n$$\nAccording to Grandstein and Ryzhyk, formula 3.471.9, see also this math.SE question , we have:\n$$\n   \\mathbb{E}\\left( \\mathrm{e}^{-\\theta T_{a,0}} \\right) = \\frac{1}{\\sqrt{2 \\pi}} \\cdot \\left. 2 \\left(2 \\theta a^2\\right)^{\\nu/2} K_{\\nu}\\left( 2 \\sqrt{\\frac{\\theta a^2}{2}}  \\right) \\right|_{\\nu = \\frac{1}{2}} = \\sqrt{\\frac{2}{\\pi}} \\sqrt{2\\theta} a K_{1/2}(a \\sqrt{2 \\theta} ) = \\mathrm{e}^{-a \\sqrt{2 \\theta}}\n$$ The time $T_{a,b}$ for standard Brownian motion $B(t)$ to hit slope $a+ b t$, is equal in distribution to the time for Wiener process $W_{-b, 1}(t)$ to hit level $a$. Thus we can use Girsanov theorem, with $M_t = \\exp(-b B(t) - b^2 t/2)$:\n$$\n   \\mathbb{E}_P\\left( \\mathrm{e}^{-\\theta T_{a,b}} \\right) = \\mathbb{E}_Q\\left( \\mathrm{e}^{-\\theta T_{a,0}} M_{T_{a,0}} \\right) = \\mathbb{E}_Q\\left( \\mathrm{e}^{-\\theta T_{a,0}} \\mathrm{e}^{-b a - b^2 T_{a,0}/2} \\right) = \\exp(-b a - a \\sqrt{b^2 + 2\\theta})\n$$ Second part In order to arrive at $\\mathbb{P}(T_{a,b} \\leqslant t)$ notice that\n$$\n   \\mathbb{P}(T_{a,b} \\leqslant t) = \\mathbb{E}_Q\\left( [T_{a,0} \\leqslant t] \\mathrm{e}^{-b a - b^2 T_{a,0}/2} \\right) = \\int_0^t \\frac{a}{\\sqrt{2 \\pi s}} \\exp\\left( -b a - \\frac{b^2 s}{2} -\\frac{a^2}{2s} \\right) \\frac{\\mathrm{d} s}{s}\n$$\nThe integral is doable by noticing that\n$$\n  -b a - \\frac{b^2 s}{2} -\\frac{a^2}{2s} = -\\frac{(a+b s)^2}{2s} = -2a b -\\frac{(a-b s)^2}{2s}\n$$\nand\n$$\n   \\frac{a}{s^{3/2}} = \\frac{\\mathrm{d}}{\\mathrm{d} s} \\frac{-2a}{\\sqrt{s}} = \\frac{\\mathrm{d}}{\\mathrm{d} s} \\left( \\frac{b s - a}{\\sqrt{s}}  - \\frac{b s + a}{\\sqrt{s}}\\right)\n$$\nHence\n$$ \\begin{eqnarray}\n \\mathbb{P}(T_{a,b} \\leqslant t) &=& \\int_0^t \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(- \\frac{(a+bs)^2}{2 s}\\right) \\mathrm{d} \\left(  - \\frac{b s + a}{\\sqrt{s}} \\right) + \\\\ &\\phantom{+}& \\int_0^t \\frac{1}{\\sqrt{2\\pi}} \\exp(-2ab) \\exp\\left(- \\frac{(b s-a)^2}{2 s}\\right) \\mathrm{d} \\left(  \\frac{b s - a}{\\sqrt{s}} \\right) \\\\ \n  &=& -\\Phi\\left( \\frac{b t + a}{\\sqrt{t}} \\right) + \\lim_{t \\searrow 0} \\Phi\\left( \\frac{b t + a}{\\sqrt{t}} \\right) +  \\\\\n  &\\phantom{=}& \\mathrm{e}^{-2 a b} \\Phi\\left(\\frac{b t - a}{\\sqrt{t}} \\right) - \\mathrm{e}^{-2 a b} \\lim_{t \\searrow 0} \\Phi\\left(\\frac{b t - a}{\\sqrt{t}} \\right)\n\\end{eqnarray}\n$$\nwhere $\\Phi(x) = \\int_{-\\infty}^x \\frac{1}{\\sqrt{2\\pi}} \\mathrm{e}^{-z^2/2} \\mathrm{d} z$ is the cumulative distribution function of the standard normal variable. Since we assumed $a > 0$,\n$$\n   \\lim_{t \\searrow 0} \\Phi\\left( \\frac{b t + a}{\\sqrt{t}} \\right) = \\Phi(+\\infty) = 1 \n \\qquad \n   \\lim_{t \\searrow 0} \\Phi\\left( \\frac{b t - a}{\\sqrt{t}} \\right) = \\Phi(-\\infty) = 0\n$$\nand we arrive at c.d.f of the inverse Gaussian random variable :\n$$\n  \\mathbb{P}(T_{a,b} \\leqslant t) = 1 - \\Phi\\left( \\frac{b t + a}{\\sqrt{t}} \\right) + \\mathrm{e}^{-2 a b} \\Phi\\left( \\frac{b t - a}{\\sqrt{t}} \\right)\n$$",
    "llm_answer_create_structured_problem": "###BEGIN_OF_FORMAT###\nAssumption: \n$T_{a,b}$ is the first hitting time of the line $a + bs$ by a standard Brownian motion,\n$a > 0$,\n$b \\in \\mathbb{R}$,\n$\\mathbb{E}[e^{-\\theta T_a}] = e^{-a\\sqrt{2\\theta}}$ for $\\theta > 0$,\nThe expression $\\mathbb{E}[e^{-\\theta T_{a,b}}] = \\exp\\left(-a\\left[b + \\sqrt{2\\left(\\theta + \\frac{b^2}{2}\\right)}\\right]\\right)$ holds.\nProblem: \nShow that, for $t > 0$,  \n$$\\mathbb{P}[T_{a,b}\\leq t] = e^{-2ab}\\Phi\\left(\\frac{bt-a}{\\sqrt{t}}\\right)+1-\\Phi\\left(\\frac{a+bt}{\\sqrt{t}}\\right).$$\n###END_OF_FORMAT###",
    "reasoning_create_structured_problem": "Okay, let me try to work through this problem step by step. The user is asking about the distribution of the hitting time of a line by a Brownian motion. Specifically, they want to show that the probability P[T_{a,b} ≤ t] is equal to the given expression involving the standard normal distribution function φ.\n\nFirst, I need to recall some properties of Brownian motion and hitting times. The first part of the problem mentions that the expectation of e^{-θ T_a} is e^{-a√(2θ)}, which is a known result for the Laplace transform of the hitting time of a level a by a standard Brownian motion. For the hitting time of a line a + bs, which is T_{a,b}, they derived an expression using a change of measure, but they are unsure if it's correct. However, the second part requires using this result to derive the probability distribution.\n\nLet me start by understanding the problem statement again. We have a standard Brownian motion, and T_{a,b} is the first time it hits the line a + bs, where a > 0 and b is a real number. The first part asks for the Laplace transform E[e^{-θ T_{a,b}}], which the user attempted and got an expression involving exponential of -a [b + sqrt(2(θ + b²/2))]. The second part then uses this to find the probability that T_{a,b} is less than or equal to t, which is given in terms of the standard normal CDF φ.\n\nThe user is asking for the cleanest way to approach part 2. They mention two possibilities: inverse transforming the moment generating function (which here is the Laplace transform) or computing the MGF of the given distribution. Both seem difficult, so maybe there's a trick they're missing.\n\nFirst, let me check if their expression for part 1 is correct, because if that's off, part 2 would be problematic. The standard result for hitting a sloping line by Brownian motion can be found using Girsanov's theorem to change measure and account for the drift. Let me recall that if we have a Brownian motion W_t, and we want to find the first passage time to a line a + bt, then under a change of measure that introduces a drift, this becomes equivalent to a Brownian motion without drift hitting a certain level. The Laplace transform E[e^{-θ T_{a,b}}] should adjust for the drift. The formula they obtained is exp(-a [b + sqrt(2(θ + b²/2)]). Let me verify this.\n\nLet’s denote λ = θ + b²/2, then the exponent becomes -a [b + sqrt(2λ)]. Alternatively, sqrt(2λ) = sqrt(2θ + b²). So the exponent is -a(b + sqrt(2θ + b²)). Let me see if this matches known results. From some references, the Laplace transform for hitting time of a + bt by standard BM is exp(-a (b + sqrt(b² + 2θ))). Yes, that seems correct. So their expression for part 1 is correct.\n\nNow, moving to part 2: using this Laplace transform to find P(T_{a,b} ≤ t). The Laplace transform is E[e^{-θ T}], so to get the distribution function, we need to invert this Laplace transform. Alternatively, maybe we can relate the given expression for the probability to its Laplace transform.\n\nThe given expression is e^{-2ab} φ( (bt - a)/sqrt(t) ) + 1 - φ( (a + bt)/sqrt(t) ). Let me note that φ is the standard normal CDF. The terms involving φ look like they come from probabilities related to the Brownian motion's position at time t, possibly adjusted for some drift or reflection.\n\nAlternatively, maybe there's a way to compute the Laplace transform of the given probability expression and check if it matches the result from part 1. If we can show that the Laplace transform of the given P(T ≤ t) is equal to the expression from part 1, then by uniqueness of Laplace transforms, the expressions must be equal.\n\nSo the plan is: compute the Laplace transform L(θ) = ∫_0^∞ e^{-θ t} P(T_{a,b} ≤ t) dt, and show that it equals the given E[e^{-θ T_{a,b}}]. But this might involve some integration. Alternatively, since we already have E[e^{-θ T}] = exp(-a(b + sqrt(b² + 2θ))), we can try to invert this Laplace transform to find P(T ≤ t).\n\nInverting Laplace transforms can be tricky, but maybe there's a known inverse for this form. Let me consider that expression: exp(-a(b + sqrt(b² + 2θ))). Let's denote s = sqrt(b² + 2θ), so we have exp(-a(b + s)). To invert this, perhaps we can express it as exp(-ab) * exp(-a s). The term exp(-a s) is similar to the Laplace transform of the hitting time for a Brownian motion with drift, but I need to recall the exact form.\n\nAlternatively, we can write s = sqrt(b² + 2θ) = sqrt(2(θ + b²/2)). So the Laplace transform is exp(-a b) exp(-a sqrt(2(θ + b²/2))). Now, the term exp(-a sqrt(2(θ + c))) with c = b²/2. The Laplace transform of the first hitting time T_a for a standard BM is exp(-a sqrt(2θ)), which corresponds to the given E[e^{-θ T_a}] = e^{-a sqrt(2θ)}. So if we shift θ by b²/2, then we have exp(-a sqrt(2(θ + b²/2))), which would correspond to the Laplace transform of T_a under a BM with some drift?\n\nAlternatively, perhaps this suggests a relationship between T_{a,b} and a hitting time under a different measure. Since we used Girsanov's theorem in part 1, maybe in part 2 we can use that change of measure again to relate the probabilities.\n\nLet me think. Suppose we have a standard BM W_t. The hitting time T_{a,b} is the first time t where W_t = a + b t. Let's apply Girsanov's theorem to change the measure such that under the new measure, W_t has drift -b. Then, the process W_t + b t becomes a BM under the new measure Q. Then, the event {T_{a,b} ≤ t} is equivalent to the event that the drifted BM W_t + b s hits a by time t. Wait, maybe I need to formalize this.\n\nUnder the original measure P, W_t is a standard BM. We want to find the probability that W_s = a + b s for some s ≤ t. Let's define a new measure Q via the Radon-Nikodym derivative dQ/dP = exp(-b W_t - b² t / 2). Then, under Q, the process X_s = W_s + b s is a BM. The event {T_{a,b} ≤ t} under P is equivalent to the event that X_s hits a by time t under Q. Therefore, P(T_{a,b} ≤ t) = E_Q[exp(b W_t + b² t / 2) I_{T_{a} ≤ t}], where T_a is the first hitting time of a by X_s under Q.\n\nBut under Q, X_t is a BM, so T_a has the same distribution as the first hitting time of a by a BM, which has the density known as the inverse Gaussian distribution. The expectation would then involve the density of T_a under Q multiplied by the exponential term. Let's try to compute this.\n\nUnder Q, the density of T_a is f_{T_a}(s) = a / (sqrt(2π s³)) exp(-a² / (2 s)) for s > 0. Therefore, P(T_{a,b} ≤ t) = ∫_0^t exp(b W_s + b² s / 2) * f_{T_a}(s) ds. But W_s = X_s - b s, and at time T_a = s, X_s = a, so W_s = a - b s. Therefore, substituting back, we get exp(b (a - b s) + b² s / 2) = exp(a b - b² s + b² s / 2) = exp(a b - b² s / 2). Therefore, the integral becomes ∫_0^t exp(a b - b² s / 2) * (a / sqrt(2π s³)) exp(-a² / (2 s)) ds. Combining the exponents: exp(a b) * exp( - (a² + b² s²) / (2 s) - b² s / 2 ). Wait, perhaps I need to handle the exponents more carefully.\n\nWait, the exponent inside the integral is from the Girsanov term and the density. Let me write it again:\n\nThe integral is ∫_0^t exp(b W_s + (b² / 2) s) * (a / sqrt(2π s³)) exp(- (a - b s)^2 / (2 s)) ds.\n\nWait, no. Under Q, X_s is a BM, so the hitting time T_a is the first time X_s = a, so at time s = T_a, X_s = a, which means W_s = a - b s. Therefore, the Girsanov term is exp(b W_s - (b² / 2) s). Wait, the Radon-Nikodym derivative is dQ/dP = exp(-b W_t - (b² / 2) t), so to go from Q to P, it's exp(b W_t + (b² / 2) t). Therefore, the expectation under P is E_Q[exp(b W_t + (b² / 2) t) I_{T_a ≤ t}]. But at time T_a = s ≤ t, W_s = a - b s, and after that, we can use the strong Markov property. However, this seems a bit involved.\n\nAlternatively, perhaps there is a formula for the distribution of the hitting time of a linear boundary. The given expression resembles the formula from the reflection principle or some similar technique. Let me look up the formula for the first hitting time of a linear boundary by a Brownian motion.\n\nUpon checking references, the formula for P(T_{a,b} ≤ t) is indeed given by e^{-2ab} Φ( (bt - a)/sqrt(t) ) + 1 - Φ( (bt + a)/sqrt(t) ), where Φ is the standard normal CDF. This can be derived using the method of images or by applying Girsanov's theorem and then computing the probability.\n\nLet me try to outline the steps. Using Girsanov's theorem to change measure to remove the drift, then relate the hitting time probability under the original measure to that under the new measure. Under the new measure, the process becomes a Brownian motion without drift, and the hitting time probability can be computed using known results, then adjusted back with the Radon-Nikodym derivative.\n\nAlternatively, there's a direct approach using the reflection principle. For a standard Brownian motion W_t, the reflection principle states that the probability that W_t crosses a level a by time t is 2Φ(-a / sqrt(t)). But when there's a linear boundary a + b s, the reflection becomes more complex. However, there's a known result where the probability is expressed as e^{-2ab} Φ( (bt - a)/sqrt(t) ) + 1 - Φ( (bt + a)/sqrt(t) ). The exponential term e^{-2ab} comes from the Cameron-Martin formula/Girsanov theorem, accounting for the drift.\n\nAnother approach is to compute the Laplace transform of the given probability expression and verify that it matches the expression from part 1. Let's attempt this.\n\nGiven P(T_{a,b} ≤ t) = e^{-2ab} Φ( (bt - a)/sqrt(t) ) + 1 - Φ( (bt + a)/sqrt(t) ). Let's compute its Laplace transform L(θ) = ∫_0^∞ e^{-θ t} P(T_{a,b} ≤ t) dt.\n\nBreaking it into two terms: L(θ) = e^{-2ab} ∫_0^∞ e^{-θ t} Φ( (bt - a)/sqrt(t) ) dt + ∫_0^∞ e^{-θ t} [1 - Φ( (bt + a)/sqrt(t) )] dt.\n\nLet’s handle the first integral: I1 = ∫_0^∞ e^{-θ t} Φ( (bt - a)/sqrt(t) ) dt.\n\nThe second integral: I2 = ∫_0^∞ e^{-θ t} [1 - Φ( (bt + a)/sqrt(t) )] dt.\n\nFirst, note that 1 - Φ(x) = Φ(-x), so I2 becomes ∫_0^∞ e^{-θ t} Φ( (-bt - a)/sqrt(t) ) dt.\n\nSo both integrals involve Φ of some expression. Let me make a substitution in the integrals. Let’s denote for I1: Let z = (bt - a)/sqrt(t). Let’s see if we can manipulate this.\n\nBut integrating Φ of such expressions against e^{-θ t} is non-trivial. Alternatively, maybe we can differentiate L(θ) with respect to a or b to relate it to known Laplace transforms.\n\nAlternatively, recall that the Laplace transform of the distribution function P(T ≤ t) is (1/θ) times the Laplace transform of the density function. However, since we are dealing with the Laplace transform of P(T ≤ t), which is ∫_0^∞ e^{-θ t} P(T ≤ t) dt. Integration by parts gives [ -e^{-θ t} / θ P(T ≤ t) ]_0^∞ + (1/θ) ∫_0^∞ e^{-θ t} f_T(t) dt = (1/θ) E[e^{-θ T} ], since P(T ≤ t) approaches 1 as t → ∞ and 0 as t→0. But this requires that e^{-θ t} P(T ≤ t) tends to 0 as t→infty, which is true if θ > 0. Therefore, L(θ) = (1/θ) E[e^{-θ T} ].\n\nGiven that E[e^{-θ T} ] = exp(-a (b + sqrt(b² + 2θ))), then L(θ) = (1/θ) exp(-a (b + sqrt(b² + 2θ))).\n\nTherefore, if we can show that the Laplace transform of the given expression for P(T_{a,b} ≤ t) is indeed (1/θ) exp(-a (b + sqrt(b² + 2θ))), then we have proved the result.\n\nThus, the strategy would be:\n\n1. Compute the Laplace transform L(θ) of the given expression for P(T_{a,b} ≤ t).\n2. Show that L(θ) = (1/θ) exp(-a (b + sqrt(b² + 2θ))).\n3. Conclude that since their Laplace transforms are equal, the original functions must be equal almost everywhere, hence the expression for P(T_{a,b} ≤ t) is correct.\n\nBut computing L(θ) directly might be challenging. Let me attempt to compute I1 and I2.\n\nStarting with I1:\n\nI1 = ∫_0^∞ e^{-θ t} Φ( (bt - a)/sqrt(t) ) dt.\n\nLet’s make a substitution: let x = sqrt(t), so t = x², dt = 2x dx. Then,\n\nI1 = 2 ∫_0^∞ e^{-θ x²} Φ( (b x² - a)/x ) x dx.\n\nSimplify the argument of Φ: (b x² - a)/x = b x - a/x.\n\nSo I1 = 2 ∫_0^∞ x e^{-θ x²} Φ(b x - a/x) dx.\n\nThis still looks complicated. Maybe another substitution. Let y = x - (a)/(b x). Wait, not sure.\n\nAlternatively, recognize that Φ(b x - a/x) can be related to some probability involving Brownian motion. Perhaps, but I'm not sure.\n\nAlternatively, consider differentiating I1 with respect to a. Let’s compute dI1/da:\n\ndI1/da = 2 ∫_0^∞ x e^{-θ x²} (-1/x) φ(b x - a/x) dx = -2 ∫_0^∞ e^{-θ x²} φ(b x - a/x) dx.\n\nWhere φ is the standard normal density. Since φ(z) = (1/√(2π)) e^{-z²/2}, so:\n\ndI1/da = -2 / sqrt(2π) ∫_0^∞ e^{-θ x²} e^{- (b x - a/x)² / 2} dx.\n\nSimilarly, for I2:\n\nI2 = ∫_0^∞ e^{-θ t} Φ( (-bt - a)/sqrt(t) ) dt.\n\nSimilarly substituting x = sqrt(t):\n\nI2 = 2 ∫_0^∞ x e^{-θ x²} Φ(-b x - a/x) dx.\n\nDifferentiating I2 with respect to a:\n\ndI2/da = 2 ∫_0^∞ x e^{-θ x²} (-1/x) φ(-b x - a/x) dx = -2 ∫_0^∞ e^{-θ x²} φ(-b x - a/x) dx.\n\nBut φ(-z) = φ(z), so this is -2 ∫_0^∞ e^{-θ x²} φ(b x + a/x) dx.\n\nNow, combining I1 and I2:\n\nL(θ) = e^{-2ab} I1 + I2.\n\nThen, dL/da = -2b e^{-2ab} I1 + e^{-2ab} dI1/da + dI2/da.\n\nBut this seems getting more complicated. Maybe there's a better way.\n\nAlternatively, recall that the given expression for P(T_{a,b} ≤ t) is similar to the formula for Brownian motion with drift. Let me consider a Brownian motion with drift -b, i.e., X_t = W_t - b t. The first passage time of X_t to level a is equivalent to T_{a,b} for the original BM. Then, the density of T_{a,b} can be found using the formula for Brownian motion with drift. The density is known to be:\n\nf(t) = a / sqrt(2π t³) exp( - (a - (-b) t)^2 / (2t) )\n\nWait, no. For a BM with drift μ, the first passage time density to level a is:\n\nf(t) = a / sqrt(2π t³) exp( - (a - μ t)^2 / (2t) )\n\nBut in our case, the drift is -b, so μ = -b. Therefore, the density would be:\n\nf(t) = a / sqrt(2π t³) exp( - (a + b t)^2 / (2t) )\n\nBut the distribution function is the integral from 0 to t of f(s) ds. However, the given expression in the problem is different. Wait, maybe it's adjusted by an exponential term due to Girsanov.\n\nAlternatively, the survival probability P(T_{a,b} > t) is equal to the probability that the BM has not crossed the line a + bs up to time t. This can be computed using the reflection principle. The formula for this probability is known and is given by:\n\nP(T_{a,b} > t) = Φ( (a + bt)/sqrt(t) ) - e^{-2ab} Φ( (bt - a)/sqrt(t) )\n\nHence, P(T_{a,b} ≤ t) = 1 - [Φ( (a + bt)/sqrt(t) ) - e^{-2ab} Φ( (bt - a)/sqrt(t) ) ] = e^{-2ab} Φ( (bt - a)/sqrt(t) ) + 1 - Φ( (a + bt)/sqrt(t) )\n\nWhich matches the given expression. Therefore, referencing the known result from the reflection principle applied to Brownian motion with a linear boundary, the expression holds.\n\nBut the problem asks to derive this using part 1's result, i.e., using the Laplace transform. So we need to connect the Laplace transform from part 1 to the given distribution.\n\nGiven that the Laplace transform of T_{a,b} is exp(-a(b + sqrt(b² + 2θ))), we can write this as exp(-ab) exp(-a sqrt(b² + 2θ)).\n\nNow, recall that the Laplace transform of the function e^{-2ab} Φ( (bt - a)/sqrt(t) ) + 1 - Φ( (a + bt)/sqrt(t) ) needs to be computed and shown to match (1/θ) exp(-a(b + sqrt(b² + 2θ))).\n\nAlternatively, since we know that the Laplace transform of P(T ≤ t) is (1/θ) E[e^{-θ T}], and we have E[e^{-θ T}] = exp(-a(b + sqrt(b² + 2θ))), then the Laplace transform of P(T ≤ t) is (1/θ) exp(-a(b + sqrt(b² + 2θ))). Therefore, if we can show that the Laplace transform of the given expression is indeed this, then we are done.\n\nHowever, directly computing the Laplace transform of the given expression is non-trivial. Perhaps instead, we can use the expression from part 1 and perform an inverse Laplace transform.\n\nGiven L(θ) = (1/θ) exp(-a(b + sqrt(b² + 2θ))).\n\nTo find the inverse Laplace transform of this, we can note that exp(-a sqrt(b² + 2θ)) can be expressed as exp(-a sqrt(2(θ + b²/2))). Let’s denote c = b²/2, so it becomes exp(-a sqrt(2(θ + c))).\n\nThe inverse Laplace transform of exp(-k sqrt(θ + c)) / θ is known. Let me recall that the Laplace transform of erfc(k/(2√t)) e^{-c t} is (1/θ) e^{-k sqrt(θ + c)}. Therefore, if we have L(θ) = (1/θ) e^{-a sqrt(2(θ + b²/2)}), then its inverse Laplace transform would be e^{- b² t / 2} erfc(a / (2√t)).\n\nBut the given expression in the problem is different. Wait, perhaps there is a miscalculation here. Let me check the inverse Laplace transform.\n\nAlternatively, consider that the function with Laplace transform exp(-a sqrt(2(θ + c))) is the density of the hitting time for a BM with drift. However, I might need to use convolution or other properties.\n\nAlternatively, consider that exp(-a sqrt(2θ)) is the Laplace transform of the density of the hitting time T_a for standard BM, which is a / sqrt(2π t³) e^{-a² / (2t)}. Therefore, exp(-a sqrt(2(θ + c))) is the Laplace transform of the density e^{-c t} times the original density. That is, if L{f(t)}(θ) = exp(-a sqrt(2θ)), then L{e^{-c t} f(t)}(θ) = exp(-a sqrt(2(θ + c))).\n\nTherefore, the inverse Laplace transform of exp(-a sqrt(2(θ + c))) is e^{-c t} * (a / sqrt(2π t³)) e^{-a² / (2t)} = a / sqrt(2π t³) e^{-c t - a² / (2t)}.\n\nTherefore, the inverse Laplace transform of (1/θ) exp(-a sqrt(2(θ + c))) is the integral from 0 to t of a / sqrt(2π s³) e^{-c s - a² / (2s)} ds.\n\nBut this integral is exactly P(T ≤ t) for the hitting time with Laplace transform exp(-a sqrt(2(θ + c)))).\n\nComparing this to the given expression in the problem, which is e^{-2ab} Φ( (bt - a)/sqrt(t) ) + 1 - Φ( (a + bt)/sqrt(t) ), we need to show that this expression equals the integral of a / sqrt(2π s³) e^{-c s - a² / (2s)} ds from 0 to t, where c = b²/2.\n\nBut substituting c = b²/2, the integral becomes ∫_0^t a / sqrt(2π s³) e^{- b² s / 2 - a² / (2s)} ds.\n\nThis integral can be related to the standard normal CDF Φ through a substitution. Let me make the substitution y = sqrt(s), so s = y², ds = 2y dy. Then the integral becomes:\n\n∫_0^{sqrt(t)} a / sqrt(2π (y²)^3) e^{- b² y² / 2 - a² / (2 y²)} * 2y dy = ∫_0^{sqrt(t)} a / sqrt(2π y^6) * 2y e^{- (b² y² + a² / y²)/2 } dy.\n\nSimplifying:\n\n= ∫_0^{sqrt(t)} (2a) / sqrt(2π y^4) e^{- (b² y² + a² / y²)/2 } dy\n\n= ∫_0^{sqrt(t)} (2a) / (y² sqrt(2π)) e^{- (b² y² + a² / y²)/2 } dy.\n\nThis still looks complicated. Perhaps another substitution: let z = a/(y). Then y = a/z, dy = -a/z² dz. When y goes from 0 to sqrt(t), z goes from ∞ to a/sqrt(t). The integral becomes:\n\n= ∫_{a/sqrt(t)}^{∞} (2a) / ( (a²/z²) sqrt(2π) ) e^{- (b² (a²/z²) + z² )/2 } * (a/z²) dz\n\n= ∫_{a/sqrt(t)}^{∞} (2a) * z² / (a² sqrt(2π)) * a/z² e^{- (b² a² / z² + z² )/2 } dz\n\n= ∫_{a/sqrt(t)}^{∞} 2 / sqrt(2π) e^{- ( (b² a²)/z² + z² )/2 } dz\n\n= sqrt(2/π) ∫_{a/sqrt(t)}^{∞} e^{- ( (b a/z )² + z² )/2 } dz\n\nThis seems symmetric in terms of z and b a/z. Perhaps another substitution.\n\nLet’s set u = z - (b a)/z. Then du/dz = 1 + (b a)/z². Not sure if this helps.\n\nAlternatively, consider completing the square or using a identity. Let me note that:\n\n(ba/z - z)^2 = (ba/z)^2 - 2 ba + z²\n\nBut this might not help directly. Alternatively, recall that the integral ∫ e^{- (c/z² + z²)} dz can be expressed in terms of Bessel functions, but that's probably not helpful here.\n\nAlternatively, consider writing the exponent as:\n\n( b² a² / z² + z² ) / 2 = ( (z - ba/z )² + 2 ba ) / 2 = (z - ba/z )² / 2 + ba.\n\nTherefore, e^{- (b² a² / z² + z² )/2 } = e^{-ba} e^{- (z - ba/z )² / 2 }.\n\nThen the integral becomes:\n\nsqrt(2/π) e^{-ba} ∫_{a/sqrt(t)}^{∞} e^{- (z - ba/z )² / 2 } dz.\n\nThis substitution might relate to the normal distribution. Let me set v = z - ba/z. But integrating over v is not straightforward.\n\nAlternatively, notice that if we set v = z + ba/z, then it's similar to a completing the square. However, this might not lead to an elementary integral.\n\nGiven that this path seems too complicated, perhaps there's a different approach. Recall that the given expression for P(T_{a,b} ≤ t) can be written as:\n\ne^{-2ab} Φ( (bt - a)/sqrt(t) ) + 1 - Φ( (bt + a)/sqrt(t) )\n\nLet me consider the two terms separately. The first term involves e^{-2ab} Φ( (bt - a)/sqrt(t) ), and the second term is 1 - Φ( (bt + a)/sqrt(t) ).\n\nNotice that 1 - Φ(x) = Φ(-x), so the second term is Φ( - (bt + a)/sqrt(t) ) = Φ( (-bt - a)/sqrt(t) ).\n\nSo the probability can be rewritten as:\n\ne^{-2ab} Φ( (bt - a)/sqrt(t) ) + Φ( (-bt - a)/sqrt(t) )\n\nNow, consider the process W_t - bt. This is a Brownian motion with drift -b. The event that W_t hits a + bt by time t is equivalent to the event that this drifted BM hits a by time t. The probability density for the first passage time of a drifted BM is known, and the survival probability is given by:\n\nΦ( (-a - μ t)/sqrt(t) ) - e^{-2aμ} Φ( (μ t - a)/sqrt(t) )\n\nWhere μ is the drift. In our case, μ = -b, so substituting:\n\nΦ( (-a - (-b) t)/sqrt(t) ) - e^{-2a(-b)} Φ( (-b t - a)/sqrt(t) )\n\n= Φ( (bt - a)/sqrt(t) ) - e^{2ab} Φ( (-bt - a)/sqrt(t) )\n\nBut the survival probability is P(T > t) = Φ( (bt - a)/sqrt(t) ) - e^{2ab} Φ( (-bt - a)/sqrt(t) )\n\nTherefore, P(T ≤ t) = 1 - [Φ( (bt - a)/sqrt(t) ) - e^{2ab} Φ( (-bt - a)/sqrt(t) ) ]\n\n= 1 - Φ( (bt - a)/sqrt(t) ) + e^{2ab} Φ( (-bt - a)/sqrt(t) )\n\nBut this does not match the given expression. However, there might be a sign error or miscalculation.\n\nAlternatively, let's refer to the classic result for Brownian motion with drift. For a BM with drift μ, X_t = W_t + μ t, the first passage time to level a > 0 has the survival probability:\n\nP(T > t) = Φ( (a - μ t)/sqrt(t) ) - e^{2 μ a} Φ( (-a - μ t)/sqrt(t) )\n\nIn our case, the drift is -b, so μ = -b. Therefore, the survival probability is:\n\nP(T > t) = Φ( (a - (-b) t)/sqrt(t) ) - e^{2*(-b)*a} Φ( (-a - (-b) t)/sqrt(t) )\n\n= Φ( (a + bt)/sqrt(t) ) - e^{-2ab} Φ( (bt - a)/sqrt(t) )\n\nTherefore, P(T ≤ t) = 1 - Φ( (a + bt)/sqrt(t) ) + e^{-2ab} Φ( (bt - a)/sqrt(t) )\n\nWhich matches the given expression:\n\ne^{-2ab} Φ( (bt - a)/sqrt(t) ) + 1 - Φ( (a + bt)/sqrt(t) )\n\nHence, this confirms that the given expression for P(T_{a,b} ≤ t) is correct based on the known result for Brownian motion with drift. Therefore, by using Girsanov's theorem to relate the original problem to a Brownian motion with drift, we can directly apply this classic result.\n\nTherefore, the cleanest way to do part 2 is to recognize that the problem reduces to the known first passage time distribution for a Brownian motion with drift, which can be derived using the reflection principle or by applying Girsanov's theorem and then utilizing the standard result. By connecting the Laplace transform from part 1 to this classic result through measure change, we can avoid directly inverting the Laplace transform and instead reference the established probability expression.",
    "Original_Problem": "Assumption: \n$T_{a,b}$ is the first hitting time of the line $a + bs$ by a standard Brownian motion,\n$a > 0$,\n$b \\in \\mathbb{R}$,\n$\\mathbb{E}[e^{-\\theta T_a}] = e^{-a\\sqrt{2\\theta}}$ for $\\theta > 0$,\nThe expression $\\mathbb{E}[e^{-\\theta T_{a,b}}] = \\exp\\left(-a\\left[b + \\sqrt{2\\left(\\theta + \\frac{b^2}{2}\\right)}\\right]\\right)$ holds.\nProblem: \nShow that, for $t > 0$,  \n$$\\mathbb{P}[T_{a,b}\\leq t] = e^{-2ab}\\Phi\\left(\\frac{bt-a}{\\sqrt{t}}\\right)+1-\\Phi\\left(\\frac{a+bt}{\\sqrt{t}}\\right).$$",
    "Original_Problem_with_numerical_assumption": "Assumption:\nAssumption 1: $T_{a,b}$ is the first hitting time of the line $a + bs$ by a standard Brownian motion,\nAssumption 2: $a > 0$,\nAssumption 3: $b \\in \\mathbb{R}$,\nAssumption 4: $\\mathbb{E}[e^{-\\theta T_a}] = e^{-a\\sqrt{2\\theta}}$ for $\\theta > 0$,\nAssumption 5: The expression $\\mathbb{E}[e^{-\\theta T_{a,b}}] = \\exp\\left(-a\\left[b + \\sqrt{2\\left(\\theta + \\frac{b^2}{2}\\right)}\\right]\\right)$ holds.\nProblem: \nShow that, for $t > 0$,  \n$$\\mathbb{P}[T_{a,b}\\leq t] = e^{-2ab}\\Phi\\left(\\frac{bt-a}{\\sqrt{t}}\\right)+1-\\Phi\\left(\\frac{a+bt}{\\sqrt{t}}\\right).$$",
    "Proof_problem": "Yes",
    "Redundant_assumption": "$$\n   \\lim_{t \\searrow 0} \\Phi\\left( \\frac{b t + a}{\\sqrt{t}} \\right) = \\Phi(+\\infty) = 1 \n \\qquad \n   \\lim_{t \\searrow 0} \\Phi\\left( \\frac{b t - a}{\\sqrt{t}} \\right) = \\Phi(-\\infty) = 0\n$$",
    "Problem_with_redundant_assumption": "Assumption:\nAssumption 1: $T_{a,b}$ is the first hitting time of the line $a + bs$ by a standard Brownian motion,\nAssumption 2: $a > 0$,\nAssumption 3: $b \\in \\mathbb{R}$,\nAssumption 4: $\\mathbb{E}[e^{-\\theta T_a}] = e^{-a\\sqrt{2\\theta}}$ for $\\theta > 0$,\nAssumption 5: The expression $\\mathbb{E}[e^{-\\theta T_{a,b}}] = \\exp\\left(-a\\left[b + \\sqrt{2\\left(\\theta + \\frac{b^2}{2}\\right)}\\right]\\right)$ holds.\nAssumption 6: $$\n   \\lim_{t \\searrow 0} \\Phi\\left( \\frac{b t + a}{\\sqrt{t}} \\right) = \\Phi(+\\infty) = 1 \n \\qquad \n   \\lim_{t \\searrow 0} \\Phi\\left( \\frac{b t - a}{\\sqrt{t}} \\right) = \\Phi(-\\infty) = 0\n$$\nProblem: \nShow that, for $t > 0$,  \n$$\\mathbb{P}[T_{a,b}\\leq t] = e^{-2ab}\\Phi\\left(\\frac{bt-a}{\\sqrt{t}}\\right)+1-\\Phi\\left(\\frac{a+bt}{\\sqrt{t}}\\right).$$"
}