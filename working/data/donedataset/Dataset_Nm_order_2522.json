{
    "Link_API": "https://api.stackexchange.com/2.3/questions/55223",
    "Title": "How many solutions are there to $x^2\\equiv 1\\pmod{2^a}$ when $a\\geq 3$?",
    "Score": 13,
    "Category": "Chứng minh",
    "Tags": "elementary-number-theory",
    "Link": "https://math.stackexchange.com/questions/55223/how-many-solutions-are-there-to-x2-equiv-1-pmod2a-when-a-geq-3",
    "Content": "I know there is a result that says $x^2\\equiv 1\\pmod{p}$ has only $\\pm 1$ as solutions for $p$ an odd prime. Experimenting with $p=2$ shows that this is no longer the case. I ran a few tests on WolframAlpha, and noticed a pattern that there seem to be $4$ solutions to $x^2\\equiv 1\\pmod{2^a}$ when $a\\geq 3$, and they are $\\pm 1$ and $2^{a-1}\\pm 1$. This works fine for the first several cases, but I'm wondering how you would actually prove that these are the only 4 solutions?",
    "AcceptedAnswer": "In my opinion, Hensel's Lemma is a bit of overkill here. Anyway, when I teach undergraduate number theory I emphasize the connections to undergraduate algebra.  Here you are trying to find the elements of order $2$ in the finite abelian group $U(2^a) = (\\mathbb{Z}/2^a \\mathbb{Z})^{\\times}$ , so it would be very helpful to know how this group decomposes as a product of cyclic groups. This group structure is usually computed around the same time one shows that $U(p^a)$ is cyclic for all odd $p$ .  The answer is that for all $a \\geq 3$ , $U(2^a) \\cong Z_2 \\times Z_{2^{a-2}}$ , i.e., it is isomorphic to the product of a cyclic group of order $2$ and a cyclic group of order $2^{a-2}$ .  See e.g. Theorem 1 here for a proof. Can you see how to use this result to prove your conjecture?",
    "llm_answer_create_structured_problem": "###BEGIN_OF_FORMAT###\nAssumption: \n$a$ is an integer satisfying $a \\geq 3$,\nThe modulus is $2^a$,\n$x$ is an integer satisfying $x^2 \\equiv 1 \\pmod{2^a}$.\nProblem: \nProve that the only solutions to $x^2 \\equiv 1 \\pmod{2^a}$ are $x \\equiv \\pm 1$ and $x \\equiv 2^{a-1} \\pm 1 \\pmod{2^a}$.\n###",
    "reasoning_create_structured_problem": "Okay, let me try to work through this problem step by step. The user wants to know how many solutions there are to the congruence \\( x^2 \\equiv 1 \\pmod{2^a} \\) when \\( a \\geq 3 \\), and they mentioned that the solutions seem to be \\( \\pm 1 \\) and \\( 2^{a-1} \\pm 1 \\). They also want a proof that these are the only solutions.\n\nFirst, I need to recall how modular congruences work, especially with powers of 2. For odd primes, the number of solutions to \\( x^2 \\equiv 1 \\pmod{p} \\) is just 2, which are \\( \\pm 1 \\). But 2 is a special case because it's the only even prime. The user noticed that for modulus \\( 2^a \\) when \\( a \\geq 3 \\), there are four solutions instead. Let me verify this with some small values of \\( a \\).\n\nLet's take \\( a = 3 \\), so modulus 8. The solutions to \\( x^2 \\equiv 1 \\pmod{8} \\) should be numbers x where \\( x^2 - 1 \\) is divisible by 8. Let's check all residues mod 8:\n\n0² = 0 → 0 - 1 = -1 ≡ 7 mod 8 → Not congruent to 0.\n\n1² = 1 → 1 - 1 = 0 ≡ 0 mod 8. So 1 is a solution.\n\n2² = 4 → 4 - 1 = 3 ≡ 3 mod 8. Not a solution.\n\n3² = 9 ≡ 1 mod 8 → 1 - 1 = 0. So 3 is a solution.\n\n4² = 16 ≡ 0 mod 8 → 0 - 1 = -1 ≡ 7 mod 8. Not a solution.\n\n5² = 25 ≡ 1 mod 8 → Same as 3. So 5 is a solution (which is -3 mod 8).\n\n6² = 36 ≡ 4 mod 8 → 4 - 1 = 3. Not a solution.\n\n7² = 49 ≡ 1 mod 8 → So 7 is a solution (which is -1 mod 8).\n\nWait, so here we have solutions 1, 3, 5, 7 mod 8, which are ±1 and ±3 mod 8. But according to the user's observation, it should be \\( 2^{a-1} \\pm 1 \\). For \\( a = 3 \\), \\( 2^{a-1} = 4 \\), so 4 ±1 = 3 and 5. So indeed, the solutions are 1, 7 (which are ±1) and 3,5 (which are 4±1). So that checks out.\n\nSimilarly, let's check \\( a = 4 \\), modulus 16. The solutions should be 1, 15 (which are ±1), and 7, 9 (since \\( 2^{4-1} = 8, so 8 ±1 = 7,9). Let's verify:\n\n1² = 1 mod 16 → 1-1=0.\n\n3² = 9 → 9-1=8 ≡ 8 mod 16. Not 0.\n\n5² = 25 ≡ 9 mod 16 → 9-1=8. Not 0.\n\n7² = 49 ≡ 1 mod 16 → 1-1=0. So 7 is a solution.\n\n9² = 81 ≡ 1 mod 16 → 1-1=0. So 9 is a solution.\n\n11² = 121 ≡ 9 mod 16 → 9-1=8. Not 0.\n\n13² = 169 ≡ 9 mod 16 → same as above.\n\n15² = 225 ≡ 1 mod 16 → 1-1=0. So 15 is a solution.\n\nThus, solutions mod 16 are 1,7,9,15. Which matches the pattern: ±1 (1 and 15) and 8±1 (7 and 9). So the user's observation holds here.\n\nSo the problem is to show that for \\( a \\geq 3 \\), the congruence \\( x^2 \\equiv 1 \\pmod{2^a} \\) has exactly four solutions: \\( \\pm1 \\) and \\( 2^{a-1} \\pm 1 \\).\n\nNow, how to prove this? Let's start by considering the general case of solving \\( x^2 \\equiv 1 \\pmod{2^a} \\). Let’s let \\( x \\) be an integer solution. Then \\( x^2 -1 \\equiv 0 \\pmod{2^a} \\), so \\( (x - 1)(x + 1) \\equiv 0 \\pmod{2^a} \\).\n\nSince \\( x - 1 \\) and \\( x + 1 \\) are two consecutive even numbers (because x is odd; if x were even, then \\( x^2 \\) would be even, so \\( x^2 \\equiv 0 \\pmod{4} \\), but 1 is odd, so x must be odd). Therefore, x is odd, so x-1 and x+1 are even. Let’s denote x = 2k + 1 for some integer k. Then x -1 = 2k and x +1 = 2k + 2 = 2(k +1). So both x-1 and x+1 are even, but they differ by 2, so one of them is divisible by 2 but not by 4, and the other is divisible by 4? Wait, let's check:\n\nSuppose x is odd. Let’s write x = 2k + 1. Then x -1 = 2k, x +1 = 2k + 2 = 2(k +1). So one of k or k+1 is even, meaning that either x -1 is divisible by 4 or x +1 is divisible by 4. For example, if k is even, then x -1 = 2k is divisible by 4, and x +1 = 2(k+1) is divisible by 2 but not by 4. Conversely, if k is odd, then x -1 = 2k is divisible by 2 but not 4, and x +1 = 2(k+1) is divisible by 4.\n\nSo in either case, the product (x -1)(x +1) = (2k)(2(k +1)) = 4k(k +1). Now, k and k +1 are consecutive integers, so one of them is even. Thus, 4k(k +1) is divisible by 8. Therefore, \\( x^2 \\equiv 1 \\pmod{8} \\), which makes sense because when a >=3, modulus is 8 or higher.\n\nBut in our problem, we need the product (x -1)(x +1) to be divisible by \\( 2^a \\). Let's consider the prime factorization. Since x is odd, as established, so x -1 and x +1 are even. Let’s write x -1 = 2m and x +1 = 2n. Then, since x +1 - (x -1) = 2, we have 2n - 2m = 2 => n - m = 1. Therefore, n and m are consecutive integers, so one of them is even. Hence, in the product (x -1)(x +1) = 4mn, since either m or n is even, the product is divisible by 8. Thus, for modulus 8 (a=3), it's possible, but for higher a, we need more factors of 2.\n\nBut let's analyze the exponents. Let’s suppose that \\( 2^a \\) divides (x -1)(x +1). Since x -1 and x +1 are two consecutive even numbers, one is divisible by 2 and the other by 4, as we saw. Therefore, the product (x -1)(x +1) is divisible by 8. But for higher a, like 16 (a=4), we need the product to be divisible by 16. Let's see:\n\nSuppose a=4, so modulus 16. Then we need (x -1)(x +1) divisible by 16. Let's see, from the example above, when x=7 mod 16, x-1=6 and x+1=8. Then 6*8=48, which is 3*16=48, so divisible by 16. Similarly, x=9 mod 16: x-1=8, x+1=10. 8*10=80=5*16, which is divisible by 16.\n\nSo in general, when x ≡ 2^{a-1} ±1 mod 2^a, then (x-1)(x+1) = (2^{a-1})(2^{a-1} + 2) or (2^{a-1} - 2)(2^{a-1}). Wait, perhaps a better approach is to factor the product (x -1)(x +1) and see how many factors of 2 they contribute.\n\nSince x -1 and x +1 are consecutive even numbers (as x is odd), one of them is congruent to 2 mod 4, and the other is congruent to 0 mod 4. So suppose x -1 ≡ 0 mod 4, then x -1 = 4k, and x +1 = 4k + 2. Then the product is 4k*(4k + 2) = 16k^2 + 8k = 8k(2k + 1). The factor 8 is there, and k(2k +1) is an integer, but unless k has more factors of 2, we can't get higher powers. Wait, but for modulus 2^a, we need this product to be divisible by 2^a. So 8k(2k +1) must be divisible by 2^a. Note that 2k +1 is odd, so the entire product 8k(2k +1) has exactly 3 + the number of factors of 2 in k. Therefore, to have 8k(2k +1) divisible by 2^a, we need 3 + v_2(k) >= a, where v_2(k) is the exponent of 2 in k. Therefore, v_2(k) >= a -3. So k must be divisible by 2^{a -3}.\n\nSimilarly, if x +1 ≡ 0 mod 4, then x +1 = 4k, and x -1 = 4k - 2. Then product is (4k - 2)*4k = 16k^2 - 8k = 8k(2k -1). Again, 8k(2k -1) must be divisible by 2^a. Since 2k -1 is odd, the exponent of 2 in 8k(2k -1) is 3 + v_2(k). So same condition: v_2(k) >= a -3.\n\nTherefore, in both cases, k must be divisible by 2^{a -3}. Let me check this with examples.\n\nTake a=3. Then a -3 =0, so k must be divisible by 1, i.e., any integer. So for modulus 8, k can be any integer. Let's see. If x -1 =4k, then x=4k +1. Then x=1,5,9,13,… mod 8. But x=1 mod 8 gives k=0, x=5 mod 8 gives k=1, etc. Similarly, if x +1=4k, then x=4k -1. So x=3,7,11,… mod 8. But when a=3, modulus 8, we have solutions 1,3,5,7. These correspond to k=0,0 for x=1 and x=3 (wait, maybe I need to adjust).\n\nAlternatively, maybe this approach is getting complicated. Let's try induction. Assume that for some a >=3, the solutions are ±1 and 2^{a-1} ±1. Then show that for a +1, the solutions lift appropriately. But lifting solutions modulo 2^a to 2^{a+1} can be tricky because the number of solutions might change.\n\nAlternatively, let's use Hensel's lemma, which is typically for odd primes, but there's a version for p=2. However, Hensel's lemma for p=2 is different because the derivative might be zero. Let's see.\n\nConsider the function f(x) = x^2 -1. We want solutions to f(x) ≡0 mod 2^a. For a=1, modulus 2: x^2 ≡1 mod 2 has solution x≡1 mod 2.\n\nFor a=2, modulus 4: x^2 ≡1 mod 4. Testing x=1,3: 1²=1, 3²=9≡1 mod 4. So two solutions: 1 and 3.\n\nFor a >=3, the user claims four solutions. Let's check a=3 (mod 8): solutions are 1,3,5,7 as before. For a=4 (mod 16): 1,7,9,15.\n\nSo starting from a=3, the number of solutions doubles from two to four and remains four for higher a? Wait, no. Wait, for a=2, there are two solutions, then for a=3, four solutions. Wait, but the user says when a >=3, there are four solutions. So the number increases at a=3 and stays four for higher a. Let's verify for a=4: four solutions, yes. What about a=5? Let's check modulus 32.\n\nPossible solutions should be 1, 15, 17, 31.\n\nCheck 1²=1 mod 32, yes.\n\n15²=225=7*32 +1=224+1=225≡1 mod32.\n\n17²=289=9*32 +1=288+1=289≡1 mod32.\n\n31²=961=30*32 +1=960+1=961≡1 mod32.\n\nAlso check 16-1=15 and 16+1=17. Wait, 2^{5-1}=16, so 16±1=15,17. So yes, solutions are 1,31 (which are ±1 mod32), and 15,17 (which are 16±1). So indeed four solutions. Similarly for a=5, modulus 32.\n\nSo the pattern holds. Therefore, the number of solutions doubles from a=2 to a=3 (from two to four), but then remains four for higher a. Interesting.\n\nTo prove this, let's use induction. Suppose for a >=3, the solutions mod 2^a are ±1 and 2^{a-1} ±1. Then show that when lifting to modulus 2^{a+1}, these solutions each lift to two solutions, but perhaps only some of them do. Wait, but in reality, when moving from modulus 2^a to 2^{a+1}, each solution mod 2^a can lift to one or two solutions mod 2^{a+1}. However, for quadratic congruences, Hensel's lemma might have different behavior.\n\nAlternatively, let's try to solve the congruence step by step. Suppose we want x ≡ c mod 2^a such that c^2 ≡1 mod 2^a. Let’s look for solutions x ≡ c + t*2^{a-1} mod 2^{a+1}, where t is 0 or 1. Then expanding:\n\n(c + t*2^{a-1})^2 ≡ c^2 + 2c*t*2^{a-1} + t^2*2^{2(a-1)} mod 2^{a+1}.\n\nSince a >=3, 2(a-1) >=4, so 2^{2(a-1)} ≡0 mod 2^{a+1} when 2(a-1) >=a+1 => a >=3. So the last term is 0. Then the middle term is 2c t 2^{a-1} = c t 2^{a} mod 2^{a+1}.\n\nSo the expansion becomes c^2 + c t 2^{a} mod 2^{a+1}.\n\nWe want this ≡1 mod 2^{a+1}. Since c^2 ≡1 mod 2^a, we can write c^2 =1 + k*2^a for some integer k. Then:\n\nc^2 + c t 2^{a} ≡1 + k*2^a + c t 2^{a} mod 2^{a+1}.\n\nThis simplifies to 1 + 2^{a}(k + c t) mod 2^{a+1}.\n\nTo have this ≡1 mod 2^{a+1}, we need 2^{a}(k + c t) ≡0 mod 2^{a+1}, which implies that k + c t ≡0 mod 2. So:\n\nk + c t ≡0 mod 2.\n\nBut k is from c^2 =1 + k*2^a. Since c is odd (because solutions to x^2≡1 mod 2^a must be odd), let's see what k is.\n\nSince c is odd, c ≡1 mod 2. Let's write c =1 + 2m. Then c^2 =1 +4m +4m². For a=3, c^2 mod 8 is 1, so 1 +4m +4m² ≡1 mod8 ⇒ 4m(m +1) ≡0 mod8. Since m(m +1) is even, 4m(m+1) is divisible by 8. Therefore, k*8 must be congruent to 4m(m+1) for some k. But this might be getting too detailed.\n\nAlternatively, from the equation k + c t ≡0 mod2, where k = (c² -1)/2^a. Wait, since c² ≡1 mod 2^a, then c² -1 is divisible by 2^a, so k is an integer. Then we have:\n\n(c² -1)/2^a + c t ≡0 mod2.\n\nWe need to solve for t in {0,1} such that this congruence holds.\n\nLet’s take a solution c mod2^a. We want to find t such that:\n\n[(c² -1)/2^a] + c t ≡0 mod2.\n\nLet’s denote D = (c² -1)/2^a. Then D + c t ≡0 mod2.\n\nWe can solve for t:\n\nc t ≡ -D mod2.\n\nSince c is odd (as c is a solution mod2^a), c ≡1 mod2. Therefore, t ≡ -D mod2.\n\nThus, t = (-D) mod2. So there is exactly one t (0 or1) that satisfies this congruence. Therefore, each solution mod2^a lifts to exactly one solution mod2^{a+1}.\n\nWait, but that would mean that the number of solutions remains the same when lifting from a to a+1. But we know from a=2 to a=3, the number of solutions doubles from 2 to4. So this contradicts. Therefore, my approach might be flawed.\n\nWait, perhaps the lifting behavior is different for a=2 to a=3. Let's check. For a=2, modulus 4. Solutions are x≡1 and 3 mod4. Let's lift to a=3, modulus8.\n\nTake c=1 mod4. Then D=(1² -1)/4=0/4=0. So D=0. Then t ≡ -0=0 mod2. So t=0. Thus, x=1 +0*4=1 mod8. Check 1²=1≡1 mod8. Yes.\n\nThen for c=1, t=0 gives x=1 mod8. Then next, t=1 would give x=1 +4=5 mod8. Let's check 5²=25≡1 mod8. So why did we get t=0 only? Wait, but according to the previous calculation, t is determined uniquely. Wait, but D=(c² -1)/2^a. For c=1 mod4, and a=2, D=(1 -1)/4=0. So t ≡ -0 mod2 ⇒ t=0. Thus, only one solution. But we know that 5 mod8 is also a solution. Hmm, there's a discrepancy here.\n\nAlternatively, maybe when a >=3, the lifting process allows two solutions from each previous solution. But the calculation above suggests that only one solution lifts. This is confusing. Let's check with a=3 lifting to a=4.\n\nTake c=1 mod8. Then D=(1² -1)/8=0/8=0. So t ≡ -0=0 mod2. Thus, x=1 +0*8=1 mod16. Check 1²=1 mod16. Yes.\n\nBut also, if we try t=1, x=1 +8=9 mod16. 9²=81≡1 mod16. So why does this work? According to the previous formula, t should be uniquely determined. But in reality, for c=1 mod8, there are two solutions mod16: 1 and9. So the lifting gives two solutions. Therefore, my previous analysis was incorrect.\n\nWait, maybe my mistake was in the assumption that we lift by adding t*2^{a-1}. Perhaps the correct lifting step is different. Let's consider that when lifting from modulus 2^a to 2^{a+1}, a solution c mod2^a can be lifted to solutions of the form c + t*2^{a-1} mod2^{a+1}. Let’s verify this.\n\nLet’s take a=3, modulus8. Solutions are 1,3,5,7. Let's lift to a=4, modulus16.\n\nTake c=1 mod8. Then possible lifts are 1 and 1 +4=5 mod16. Wait, but x=5 mod16: 5²=25≡9 mod16≠1. Wait, that doesn't work. So maybe the step is different. Alternatively, maybe the lift is c + t*2^{a-1} where t=0 or1. For a=3, lifting from mod8 to mod16, we add t*4.\n\nSo for c=1 mod8: x=1 +4t mod16. Let’s compute (1+4t)²=1 +8t +16t² ≡1 +8t mod16. Set ≡1 mod16 ⇒8t≡0 mod16 ⇒ t≡0 mod2. But t can only be 0 or1. So t=0. Thus, only x=1 mod16 is a solution. But we know that 9 mod16 is also a solution. Therefore, this approach misses it. So this method isn't capturing all solutions. Hence, my previous approach is flawed.\n\nAlternatively, maybe we need to consider that solutions mod2^a can be lifted in two different ways when a >=3. Let's consider that after a=3, each solution mod2^a can lift to two solutions mod2^{a+1}. Wait, but in the case of a=3 to a=4, we have four solutions lifting to four solutions? But when we went from a=3 (mod8) to a=4 (mod16), we still have four solutions. So perhaps the number remains four.\n\nWait, no. From a=2 to a=3, the number of solutions doubles from two to four. From a=3 onwards, the number of solutions stays four. Therefore, there must be something special happening at a=3.\n\nLet me try a different approach. Let’s suppose that for a >=3, we can write x ≡1 mod8 or x ≡-1 mod8, and also x ≡2^{a-1} +1 mod2^a or x≡2^{a-1} -1 mod2^a. Let's verify for a=3:\n\n2^{3-1}=4. So 4±1=3,5. But mod8, 3 and5 are equivalent to -5 and -3, but anyway. Wait, x=3 mod8: 3²=9≡1 mod8. x=5 mod8:5²=25≡1 mod8. Similarly, x=1 and7≡-1 mod8. So yes, four solutions.\n\nFor a=4: 2^{4-1}=8. 8±1=7,9 mod16. 7²=49≡1 mod16,9²=81≡1 mod16. Similarly, 1 and15≡-1 mod16. So four solutions.\n\nNow, to prove that these are the only solutions. Let's suppose x is a solution to x²≡1 mod2^a. Then x is odd, so x=2k+1. Let’s expand:\n\n(2k+1)^2 =4k²+4k+1=4k(k+1)+1≡1 mod2^a.\n\nThus, 4k(k+1)≡0 mod2^a ⇒k(k+1)≡0 mod2^{a-2}.\n\nSince k and k+1 are consecutive integers, one is even. Hence, k(k+1) is even. Therefore, to have k(k+1)≡0 mod2^{a-2}, the product must be divisible by2^{a-2}. But since k and k+1 are coprime, one of them must be divisible by2^{a-2}.\n\nCase1: k≡0 mod2^{a-2}. Then k=2^{a-2}m for some integer m. Then x=2k+1=2^{a-1}m +1. So x≡1 mod2^{a-1}. But since we are working mod2^a, x can be written as x≡1 + t*2^{a-1} mod2^a, where t=0 or1 (since m can be 0 or1 mod2). Therefore, possible solutions are x≡1 mod2^a or x≡1 +2^{a-1} mod2^a.\n\nCase2: k+1≡0 mod2^{a-2}. Then k= -1 +2^{a-2}m. Then x=2k +1=2(-1 +2^{a-2}m) +1= -2 +2^{a-1}m +1= -1 +2^{a-1}m. So x≡-1 +2^{a-1}m mod2^a. Similarly, m can be 0 or1 mod2, so x≡-1 or -1 +2^{a-1} mod2^a.\n\nTherefore, combining both cases, the solutions are x≡±1 mod2^{a-1} and x≡±1 +2^{a-1} mod2^a. But mod2^a, these are equivalent to x≡1,2^{a-1} +1, -1, and2^{a-1} -1 mod2^a. Hence, the four solutions are ±1 and2^{a-1} ±1.\n\nTherefore, this shows that the only solutions are those four. Thus, the proof is complete.",
    "Original_Problem": "Assumption: \n$a$ is an integer satisfying $a \\geq 3$,\nThe modulus is $2^a$,\n$x$ is an integer satisfying $x^2 \\equiv 1 \\pmod{2^a}$.\nProblem: \nProve that the only solutions to $x^2 \\equiv 1 \\pmod{2^a}$ are $x \\equiv \\pm 1$ and $x \\equiv 2^{a-1} \\pm 1 \\pmod{2^a}$.",
    "Original_Problem_with_numerical_assumption": "Assumption:\nAssumption 1: $a$ is an integer satisfying $a \\geq 3$,\nAssumption 2: The modulus is $2^a$,\nAssumption 3: $x$ is an integer satisfying $x^2 \\equiv 1 \\pmod{2^a}$.\nProblem: \nProve that the only solutions to $x^2 \\equiv 1 \\pmod{2^a}$ are $x \\equiv \\pm 1$ and $x \\equiv 2^{a-1} \\pm 1 \\pmod{2^a}$.",
    "Proof_problem": "Yes",
    "Redundant_assumption": "$U(2^a) = (\\mathbb{Z}/2^a \\mathbb{Z})^{\\times}$",
    "Problem_with_redundant_assumption": "Assumption:\nAssumption 1: $a$ is an integer satisfying $a \\geq 3$,\nAssumption 2: The modulus is $2^a$,\nAssumption 3: $x$ is an integer satisfying $x^2 \\equiv 1 \\pmod{2^a}$.\nAssumption 4: $U(2^a) = (\\mathbb{Z}/2^a \\mathbb{Z})^{\\times}$\nProblem: \nProve that the only solutions to $x^2 \\equiv 1 \\pmod{2^a}$ are $x \\equiv \\pm 1$ and $x \\equiv 2^{a-1} \\pm 1 \\pmod{2^a}$."
}