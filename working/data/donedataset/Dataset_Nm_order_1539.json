{
    "Link_API": "https://api.stackexchange.com/2.3/questions/74132",
    "Title": "Explicit formula for Fermat&#39;s 4k+1 theorem",
    "Score": 20,
    "Category": "Chứng minh",
    "Tags": "number-theory, quadratic-reciprocity",
    "Link": "https://math.stackexchange.com/questions/74132/explicit-formula-for-fermats-4k1-theorem",
    "Content": "Let $p$ be a prime number of the form $4k+1$. Fermat's theorem asserts that $p$ is a sum of two squares, $p=x^2+y^2$. There are different proofs of this statement (descent, Gaussian integers,...). And recently I've learned there is the following explicit formula (due to Gauss):\n$x=\\frac12\\binom{2k}k\\pmod p$,\n$y=(2k)!x\\pmod p$\n($|x|,|y|<p/2$). But how to prove it? Remark. In another thread Matt E also mentions a formula \n$$\nx=\\frac12\\sum\\limits_{t\\in\\mathbb F_p}\\left(\\frac{t^3-t}{p}\\right).\n$$\nSince $\\left(\\dfrac{t^3-t}p\\right)=\\left(\\dfrac{t-t^{-1}}p\\right)=(t-t^{-1})^{2k}\\mod p$ (and $\\sum t^i=0$ when $0<i<p-1$), this is, actually, the same formula (up to a sign).",
    "AcceptedAnswer": "Here is a high level proof. I assume it can be done in a more elementary way. Chapter 3 of Silverman's Arithmetic of Elliptic Curves is a good reference for the ideas I am using. Let $E$ be the elliptic curve $y^2 = x^3+x$. By a theorem of Weyl, the number of points on $E$ over $\\mathbb{F}_p$ is $p- \\alpha- \\overline{\\alpha}$ where $\\alpha$ is an algebraic integer satisfying $\\alpha \\overline{\\alpha} =p$, and the bar is complex conjugation. (If you count the point at $\\infty$, then the formula should be $p - \\alpha - \\overline{\\alpha} +1$.) Let $p \\equiv 1 \\mod 4$. We will establish two key claims: Claim 1: $\\alpha$ is of the form $a+bi$, for integers $a$ and $b$, and Claim 2: $-2a \\equiv \\binom{(p-1)/2}{(p-1)/4} \\mod p$. So $a^2+b^2 = p$ and $a \\equiv -\\frac{1}{2} \\binom{(p-1)/2}{(p-1)/4}$, as desired. Proof sketch of Claim 1: Let $R$ be the endomorphism ring of $E$ over $\\mathbb{F}_p$. Let $j$ be a square root of $-1$ in $\\mathbb{F}_p$. Two of the elements of $R$ are $F: (x,y) \\mapsto (x^p, y^p)$ and $J: (x,y) \\mapsto (-x,jy)$. Note that $F$ and $J$ commute; this uses that $j^p = j$, which is true because $p \\equiv 1 \\mod 4$. So $F$ and $J$ generate a commutative subring of $R$. If you look at the list of possible endomorphism rings of elliptic curves, you'll see that such a subring must be of rank $\\leq 2$, and $J$ already generates a subring of rank $2$. (See section 3.3 in Silverman.) So $F$ is integral over the subring generated by $J$. That ring is $\\mathbb{Z}[J]/\\langle J^2=-1 \\rangle$, which is integrally closed. So $F$ is in that ring, meaning $F = a+bJ$ for some integers $a$ and $b$. If you understand the connection between Frobenius actions and points of $E$ over $\\mathbb{F}_p$, this shows that $\\alpha = a+bi$. Proof sketch of Claim 2: The number of points on $E$ over $\\mathbb{F}_p$ is congruent modulo $p$ to the coefficient of $x^{p-1}$ in $(x^3+x)^{(p-1)/2}$ (section 3.4 in Silverman). This coefficient is $\\binom{(p-1)/2}{(p-1)/4}$. So\n$$- \\alpha - \\overline{\\alpha}  \\equiv \\binom{(p-1)/2}{(p-1)/4} \\mod p$$\nor\n$$-2a \\equiv \\binom{(p-1)/2}{(p-1)/4} \\mod p$$\nas desired. Remark: This is very related to the formula Matt E mentions. For $u \\in \\mathbb{F}_p$, the number of square roots of $u$ in $\\mathbb{F}_p$ is $1+\\left( \\frac{u}{p} \\right)$. So the number of points on $E$ is \n$$p+\\sum_{x \\in \\mathbb{F}_p} \\left( \\frac{x^3+x}{p} \\right).$$ This is essentially Matt's sum; if you want, you could use the elliptic curve $y^2 = x^3-x$ in order to make things exactly match, although that would introduce some signs in other places. So your remark gives another (morally, the same) proof of Claim 2.",
    "llm_answer_create_structured_problem": "###BEGIN_OF_FORMAT###\nAssumption: \n$p$ is a prime number,\n$p$ is of the form $4k+1$ for some integer $k$.\nProblem: \nProve the explicit formulas for integers $x$ and $y$ such that $p = x^2 + y^2$, where  \n$$x \\equiv \\frac{1}{2} \\binom{2k}{k} \\pmod{p}, \\quad y \\equiv (2k)! \\cdot x \\pmod{p},$$  \nand $|x|, |y| < \\frac{p}{2}$.\n###END_OF_FORMAT###",
    "reasoning_create_structured_problem": "Okay, let me try to structure this problem according to the required format. First, I need to identify all the assumptions from the original question. The user mentions Fermat's theorem about primes of the form 4k+1 being expressible as the sum of two squares. Then they talk about an explicit formula by Gauss for x and y, and another formula mentioned by Matt E. \n\nSo, the main problem here is to prove the explicit formulas for x and y given by Gauss. The assumptions would include that p is a prime of the form 4k+1, which is stated in the title. The question also references Fermat's theorem as a premise. The user provides the explicit formulas for x and y using binomial coefficients and factorials modulo p, and mentions that |x| and |y| are less than p/2. \n\nI need to list each assumption line by line, each applying to one object. So first, p is a prime number. Second, p is of the form 4k+1. Then, Fermat's theorem is given as a premise, which states that p can be written as x² + y². The explicit formulas for x and y are part of the problem statement, along with the conditions on their absolute values. \n\nWait, but the problem is to prove the explicit formulas. So the assumptions would be the conditions under which the problem is posed. So p being a prime of the form 4k+1 is an assumption. The problem is to prove that x and y as given by those formulas satisfy x² + y² = p, with |x| and |y| less than p/2. \n\nBut in the original problem statement, the user says \"how to prove it?\" referring to the explicit formula. So the problem is to prove the formulas for x and y. The assumptions would be that p is a prime of the form 4k+1, and that Fermat's theorem holds (since they mention it's already established). However, maybe the Fermat theorem part is background, not an assumption needed here. The key assumptions are p is prime and p ≡1 mod 4. The problem is to show that x and y defined via the binomial coefficient and factorial modulo p satisfy x² + y² = p. Also, the constraints on |x| and |y| are part of the problem's conclusion.\n\nSo the assumptions would be:\n\n- p is a prime number.\n\n- p is of the form 4k + 1 for some integer k.\n\nThen the problem is to prove that the explicit formulas for x and y (using binomial coefficients and factorials modulo p) satisfy x² + y² = p with |x|, |y| < p/2.\n\nI need to make sure each assumption is one line, one property per line. So splitting p being prime and p being 4k+1 into two separate assumptions. The other parts, like Fermat's theorem, might be context but not an assumption required for this proof. The problem is to prove the explicit formulas given those two assumptions on p. The explicit formulas are part of the problem statement. The conditions |x|, |y| < p/2 are also part of what needs to be proven or given as part of the formulas. The user also mentions another formula involving a sum over the finite field, but that seems like an alternative expression, so maybe it's part of the problem to show equivalence or to prove either formula.\n\nBut the main problem as stated by the user is to prove Gauss's explicit formulas. So putting it all together:\n\nAssumptions:\n\n- p is a prime number.\n\n- p is of the form 4k + 1 for some integer k.\n\nProblem:\n\nProve that the explicit formulas \n\nx = (1/2) * binomial(2k, k) mod p,\n\ny = (2k)! * x mod p,\n\nwhere |x|, |y| < p/2, satisfy x² + y² = p.\n\nAlternatively, the problem might include the other formula mentioned, but the user is mainly asking about the Gauss formula. The key is to structure the problem based on what needs to be proven given the assumptions. So the assumptions are about p, and the problem is to prove the formulas for x and y such that x² + y² = p with the given bounds.",
    "Original_Problem": "Assumption: \n$p$ is a prime number,\n$p$ is of the form $4k+1$ for some integer $k$.\nProblem: \nProve the explicit formulas for integers $x$ and $y$ such that $p = x^2 + y^2$, where  \n$$x \\equiv \\frac{1}{2} \\binom{2k}{k} \\pmod{p}, \\quad y \\equiv (2k)! \\cdot x \\pmod{p},$$  \nand $|x|, |y| < \\frac{p}{2}$.",
    "Original_Problem_with_numerical_assumption": "Assumption:\nAssumption 1: $p$ is a prime number,\nAssumption 2: $p$ is of the form $4k+1$ for some integer $k$.\nProblem: \nProve the explicit formulas for integers $x$ and $y$ such that $p = x^2 + y^2$, where  \n$$x \\equiv \\frac{1}{2} \\binom{2k}{k} \\pmod{p}, \\quad y \\equiv (2k)! \\cdot x \\pmod{p},$$  \nand $|x|, |y| < \\frac{p}{2}$.",
    "Proof_problem": "Yes",
    "Redundant_assumption": "$$-2a \\equiv \\binom{(p-1)/2}{(p-1)/4} \\mod p$$",
    "Problem_with_redundant_assumption": "Assumption:\nAssumption 1: $p$ is a prime number,\nAssumption 2: $p$ is of the form $4k+1$ for some integer $k$.\nAssumption 3: $$-2a \\equiv \\binom{(p-1)/2}{(p-1)/4} \\mod p$$\nProblem: \nProve the explicit formulas for integers $x$ and $y$ such that $p = x^2 + y^2$, where  \n$$x \\equiv \\frac{1}{2} \\binom{2k}{k} \\pmod{p}, \\quad y \\equiv (2k)! \\cdot x \\pmod{p},$$  \nand $|x|, |y| < \\frac{p}{2}$."
}