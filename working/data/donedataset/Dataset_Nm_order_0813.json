{
    "Link_API": "https://api.stackexchange.com/2.3/questions/1891648",
    "Title": "A nice formula for the Thue–Morse sequence",
    "Score": 27,
    "Category": "Chứng minh",
    "Tags": "sequences-and-series, combinatorics, number-theory, discrete-mathematics, binomial-coefficients",
    "Link": "https://math.stackexchange.com/questions/1891648/a-nice-formula-for-the-thue-morse-sequence",
    "Content": "The Thue–Morse sequence $^{[1]}$ $\\!^{[2]}$ $t_n$ is an infinite binary sequence constructed by starting with $t_0=0$ and successively appending the binary complement of the sequence obtained so far:\n$$\\begin{array}l\n0\\\\\n0&\\color{red}1\\\\\n0&1&\\color{red}1&\\color{red}0\\\\\n0&1&1&0&\\color{red}1&\\color{red}0&\\color{red}0&\\color{red}1\\\\\n0&1&1&0&1&0&0&1&\\color{red}1&\\color{red}0&\\color{red}0&\\color{red}1&\\color{red}0&\\color{red}1&\\color{red}1&\\color{red}0\\\\\n\\hline\n0&1&1&0&1&0&0&1&1&0&0&1&0&1&1&0&1&0&0&1&0&1&1&\\dots\\\\\nt_0&t_1&t_2&t_3&t_4&\\dots\\!\\!\\!\n\\end{array}$$ It has many interesting properties: it is aperiodic, cube-free, shows the parity of the number of $1$'s in the binary representation of a natural number, has connections to the Fabius function , the hypergeometric function, etc. There is a nice formula for this sequence that uses only elementary functions, binomial coefficients and finite summation:\n$$t_n=\\frac43\\,\\sin^2\\left(\\frac\\pi3\\left(n-\\sum_{k=1}^n(-1)^{\\binom n k}\\right)\\right)=\\operatorname{mod}\\left(2n+\\sum_{k=1}^n(-1)^{\\binom n k},\\,3\\right).$$\nUnfortunately, I could not find a proof of this formula anywhere and could not construct it myself. So, I'm asking for your help with this.",
    "AcceptedAnswer": "Given any integer $n \\ge 0$, let $( n_0, n_1, n_2, \\ldots )$ be its binary representation, i.e. $$n = \\sum_{i=0}^\\infty n_i 2^i,  \\quad n_i \\in \\{ 0, 1 \\}$$ Let $P(n) = n_0$ be the parity of $n$ and $N(n) = \\sum\\limits_{i=0}^\\infty n_i$ be the number of set bits in this binary representation. It is not hard to see\n$t_n = 1$ when and only when $N(n)$ is odd. i.e.\n$$t_n = P(N(n))$$ Notice\n$$n - \\sum_{k=1}^n (-1)^{\\binom{n}{k}} \n= \\sum_{k=0}^n \\left(1 - (-1)^{\\binom{n}{k}}\\right) -2\n= 2\\sum_{k=0}^nP\\left(\\binom{n}{k}\\right) - 2\\tag{*1}\n$$\nFor any $0 \\le k \\le n$, let $(k_0,k_1,k_2,\\ldots)$ be the binary representation of $k$. By Lucas' theorem , we have\n$$P\\left(\\binom{n}{k}\\right) = \\prod_{i=0}^\\infty P\\left(\\binom{n_i}{k_i}\\right)$$ where $\\displaystyle\\;\\binom{n_i}{k_i}$ should be interpreted as $0$ whenever $n_i < k_i$. In order for the summand in RHS of $(*1)$ to be non-zero, For those $i$ where $n_i = 1$, $k_i$ can be $0$ or $1$. For those $i$ where $n_i = 0$, $k_i$ can only be $0$. This means in the rightmost sum of $(*1)$, exactly $2^{N(n)}$ of $P(\\cdot)$ contributes. This leads to $$\\begin{align}\n& n - \\sum_{k=1}^n(-1)^{\\binom{n}{k}} = 2^{N(n)+1} - 2 \\equiv 2P(N(n)) \\pmod 3\\\\\n\\implies &\n\\frac43\\sin^2\\left(\\frac{\\pi}{3}\\left(n - \\sum_{k=1}^n (-1)^{\\binom{n}{k}}\\right)\\right)\n= \\frac43\\sin^2\\left(\\frac{2\\pi}{3}P(N(n))\\right)\n\\stackrel{\\color{blue}{\\because P(\\cdot) = 0\\text{ or } 1}}{=}\nP(N(n)) = t_n\n\\end{align}$$",
    "llm_answer_create_structured_problem": "###BEGIN_OF_FORMAT###\nAssumption: \nn is a non-negative integer,\nt_0 = 0,\nfor each k ≥ 0, the subsequence \\( t_{2^k} \\) to \\( t_{2^{k+1}-1} \\) is the binary complement of \\( t_0 \\) to \\( t_{2^k -1} \\).\nProblem: \nProve that the Thue–Morse sequence $$t_n=\\frac43\\,\\sin^2\\left(\\frac\\pi3\\left(n-\\sum_{k=1}^n(-1)^{\\binom n k}\\right)\\right)=\\operatorname{mod}\\left(2n+\\sum_{k=1}^n(-1)^{\\binom n k},\\,3\\right).$$\n###END_OF_FORMAT###",
    "reasoning_create_structured_problem": "Okay, so the user wants me to format the given Math Stack Exchange question into the specified structure. Let me start by carefully reading the problem.\n\nThe original question is about proving a specific formula for the Thue-Morse sequence. The user provided the formula using sine squared and modulo functions, involving binomial coefficients and a summation. The title mentions \"A nice formula for the Thue–Morse sequence,\" and the question body describes the sequence's construction and properties, then presents the formula they want proven.\n\nFirst, I need to extract the assumptions and the problem statement. The example given earlier lists assumptions as individual conditions applied to one object each. Looking at the problem here, the Thue-Morse sequence is defined starting with t_0=0 and appending the binary complement. But in the problem statement, the user is asking about the proof of the given formula, so the assumptions would be the definitions or properties necessary for that proof.\n\nHowever, the original problem doesn't explicitly state any assumptions except the definition of the Thue-Morse sequence. Wait, the formula presented uses binomial coefficients and a summation. The problem is to prove that t_n equals those expressions. So the assumptions would include the definition of t_n as the Thue-Morse sequence constructed by appending the binary complement. But in the example, the assumption was about n being an integer and divisible by 7. Here, maybe the key assumptions are related to how t_n is defined. Let me check the problem again.\n\nThe problem statement says: \"There is a nice formula for this sequence that uses only elementary functions, binomial coefficients and finite summation: [formula]. Unfortunately, I could not find a proof of this formula anywhere and could not construct it myself. So, I'm asking for your help with this.\"\n\nSo the user wants to prove that t_n (Thue-Morse sequence) equals the given formula. Therefore, the assumptions would be the definition of the Thue-Morse sequence. Let me see the construction:\n\nThe Thue-Morse sequence t_n starts with t_0=0 and successively appends the binary complement. The example shows the initial terms. So possible assumptions are:\n\n- t_0 = 0\n- For each n ≥ 0, the sequence is extended by appending the binary complement of the current sequence.\n\nBut in the example given by the user, assumptions are about properties of n (integer, divisible by 7). Here, the problem is to prove a formula for t_n, so the assumptions are the definition of t_n as the Thue-Morse sequence. But the user might not have explicitly stated that. However, in the example, the assumption included the divisibility condition which was part of the original problem. Wait, in the original example, the problem was to prove A(n) is divisible by 91, and the user's formatted problem included the assumption that n is an integer and n is divisible by 7. But the original problem stated \"for every integer n\", but the formatted version added \"n is divisible by 7\". Wait, that seems conflicting. Wait, the original example's formatted problem might have a mistake? Wait, the original problem was to prove for every integer n, A(n) is divisible by 91, but the formatted problem in the example says the assumption is n is an integer, n divisible by 7, and the problem is to prove A(n) is divisible by 91. That seems incorrect. Wait, maybe the example is a mistake. But the user provided that as an example, so maybe they intended to have the assumptions as given. Therefore, perhaps in the current problem, the assumptions should include the definition of the Thue-Morse sequence as per the given construction. However, the example's assumptions were about the variable in the problem (n being integer and divisible by 7). So in this problem, the key variables are n, and the Thue-Morse sequence t_n. The problem is to prove that t_n equals those two expressions. Therefore, the assumptions would be:\n\n- t_n is the Thue-Morse sequence defined by t_0 = 0 and recursively appending the binary complement.\n\nBut the user wants each assumption to address only one property or condition applied to one object. So breaking that down:\n\nAssumption 1: t_0 = 0.\n\nAssumption 2: For each n ≥ 0, the sequence t_n is constructed by appending the binary complement of the existing sequence.\n\nWait, but the way the Thue-Morse sequence is built is by starting with 0, then each next step doubles the length by adding the complement. So for example, t_1 is 0 followed by 1, then t_2 is 01 followed by 10, etc. But in terms of the nth term, there's a direct definition involving the parity of the number of 1s in the binary representation of n. Alternatively, there's a recursive definition. However, the problem's formula uses a summation involving (-1)^{binom(n,k)}. Hmm. So maybe the key assumptions are the definition of t_n as the parity of the number of 1s in the binary expansion of n, which is a known property. Wait, but the original problem mentions that it \"shows the parity of the number of 1's in the binary representation of a natural number,\" which is one of its properties. So perhaps the definition of t_n is that t_n is the parity (0 if even, 1 if odd) of the number of 1s in the binary expansion of n. However, in the construction given, t_n is built by starting with 0 and appending complements. The two definitions are equivalent, but which is considered the definition here? The problem's first paragraph says it's constructed by starting with 0 and appending the complement, so the assumptions should be based on that construction.\n\nBut the problem is to prove that the given formula equals t_n. So the assumptions would be the recursive definition of t_n. However, each assumption must be a single line addressing one property of one object. So:\n\nAssumption 1: t_0 = 0.\n\nAssumption 2: For each m ≥ 0, the sequence is extended by appending the binary complement of the current sequence.\n\nBut maybe that's two assumptions. However, the user's example had two assumptions: n is an integer, and n is divisible by 7. Each is a separate line. Here, similarly:\n\nAssumption 1: t_0 = 0.\n\nAssumption 2: For each m ≥ 0, the sequence is constructed by appending the binary complement of the existing sequence.\n\nWait, but in the problem statement, the user is referencing the Thue-Morse sequence as defined by that construction. So these are the necessary assumptions. The problem is to prove that the given formula equals t_n under those assumptions.\n\nAlternatively, perhaps the problem doesn't have any explicit assumptions beyond the definition of the Thue-Morse sequence. In the example, the original problem said \"for every integer n\", but the formatted problem added \"n is divisible by 7\", which seems contradictory. Wait, perhaps the example had a mistake. But since the user provided it, we need to follow their structure. So in the current problem, the main assumption is that t_n is the Thue-Morse sequence as defined in the problem statement. Since the problem is to prove the formula for t_n, the assumptions would be the definition of t_n. Breaking that into individual points:\n\nAssumption 1: The Thue-Morse sequence t_n starts with t_0 = 0.\n\nAssumption 2: Each subsequent term is generated by appending the binary complement of the sequence obtained so far.\n\nBut in the example, the assumptions were about the variable n. Here, maybe the assumptions are about the sequence t_n. However, the problem is to prove the formula for t_n given its definition. Therefore, the assumptions are the definition steps. But each must be a single line, one property per line. So:\n\nAssumption 1: t_0 = 0.\n\nAssumption 2: For each m ≥ 0, the sequence up to t_{2^{m+1}-1} is the concatenation of the sequence up to t_{2^m -1} and its binary complement.\n\nAlternatively, since the construction is done by repeatedly doubling the length by appending the complement, maybe it's better to state it step-wise. However, the exact recursive definition might be more involved. Alternatively, another definition of the Thue-Morse sequence is that t_n is the parity of the number of 1s in the binary representation of n. But the problem statement says \"it shows the parity of the number of 1's in the binary representation of a natural number\", which is a property, not the definition. The construction given is the recursive appending of the complement. Therefore, the assumptions should be based on the construction provided in the problem statement.\n\nAlternatively, perhaps the problem has no explicit assumptions beyond the existence of the Thue-Morse sequence with the given formula. But the user example extracted assumptions from the problem. In the original example, the problem was to prove divisibility by 91 for all integers n, but the formatted version added an assumption that n is divisible by 7. That seems incorrect unless the original problem had a mistake. But perhaps the user intended to structure the problem with relevant assumptions. However, in the current problem, the user hasn't specified any conditions on n, except that it's a natural number (since the sequence is indexed by n). So possible assumptions:\n\nAssumption 1: n is a non-negative integer.\n\nAssumption 2: t_n is the Thue-Morse sequence defined by t_0 = 0 and recursively appending the binary complement.\n\nBut according to the example, assumptions should be listed line by line, each addressing one property or condition of one object. So:\n\nAssumption 1: n is a non-negative integer.\n\nAssumption 2: t_0 = 0.\n\nAssumption 3: For each m ≥ 0, the sequence is extended by appending the binary complement of the existing sequence.\n\nBut I'm not sure if the problem requires n to be a non-negative integer. The problem statement says \"natural number\", so perhaps that's an assumption. However, the original example didn't include that, but maybe because it was about integers. Here, since the sequence is indexed by n starting at 0, n should be a non-negative integer. Therefore:\n\nAssumption: n is a non-negative integer.\n\nBut the problem is to prove the formula for t_n, which is defined for all n ≥ 0. So that's an important assumption. The other assumptions are about the definition of t_n. So putting it all together:\n\nAssumption 1: n is a non-negative integer.\n\nAssumption 2: t_0 = 0.\n\nAssumption 3: For each k ≥ 0, the sequence t_{2^k}, t_{2^k +1}, ..., t_{2^{k+1} -1} is the binary complement of t_0, t_1, ..., t_{2^k -1}.\n\nAlternatively, perhaps the way the sequence is built is by starting with 0, then each term after is the complement. But the construction in the problem is:\n\nStart with 0.\n\nThen append the complement (1) to get 0,1.\n\nThen append the complement of 0,1 which is 1,0 to get 0,1,1,0.\n\nThen append the complement of 0,1,1,0 which is 1,0,0,1 to get 0,1,1,0,1,0,0,1, etc.\n\nSo the length doubles each time. Therefore, the position n can be expressed in terms of its binary representation. But the problem's formula involves a summation over k from 1 to n of (-1)^{binom(n,k)}. That's interesting. The binomial coefficient modulo 2 is related to Lucas' theorem, which connects to the Thue-Morse sequence. But that's part of the proof, not the assumptions.\n\nTherefore, the key assumptions here are the definition of the Thue-Morse sequence as per the construction given in the problem statement, and that n is a non-negative integer. Breaking it down:\n\nAssumption 1: n is a non-negative integer.\n\nAssumption 2: t_0 = 0.\n\nAssumption 3: For each m ≥ 0, the sequence is extended by appending the binary complement of the sequence obtained so far.\n\nBut assumption 3 is a bit general. Alternatively, maybe it's better to split into recursive steps. However, the problem requires each assumption to be a single line addressing one property or condition of one object. So perhaps:\n\nAssumption 1: n is a non-negative integer.\n\nAssumption 2: The Thue-Morse sequence t_n is defined by t_0 = 0.\n\nAssumption 3: For each m ≥ 0, t_{2^m + k} = 1 - t_k for 0 ≤ k < 2^m.\n\nYes, this is another way to define the Thue-Morse sequence recursively, where each block after 2^m is the complement of the previous block. This definition might be more precise for the assumptions.\n\nAlternatively, the problem states the construction as starting with 0 and successively appending the binary complement. So the process is:\n\nStart with S_0 = [0].\n\nThen S_1 = S_0 concatenated with complement(S_0) = [0,1].\n\nThen S_2 = S_1 concatenated with complement(S_1) = [0,1,1,0].\n\nAnd so on. Thus, the nth term where n is in the range [2^m, 2^{m+1}) is the complement of the term at position n - 2^m.\n\nTherefore, the recursive definition is t_n = 1 - t_{n - 2^m} where 2^m is the largest power of 2 less than or equal to n.\n\nBut how to phrase that as an assumption? Perhaps:\n\nAssumption 3: For each n ≥ 1, t_n = 1 - t_{n - 2^m}$, where m is the largest integer such that 2^m ≤ n.\n\nBut this is more complex. However, the example given by the user had simpler assumptions. Since the user's example included two assumptions (n is integer, n divisible by 7), which are separate conditions on the same object, here we might have:\n\nAssumption 1: n is a non-negative integer.\n\nAssumption 2: t_0 = 0.\n\nAssumption 3: For each n ≥ 1, t_n is the binary complement of t_{n - 2^m}$, where 2^m is the largest power of two less than or equal to n.\n\nBut perhaps that's too specific. Alternatively, since the construction is appending the complement each time, maybe:\n\nAssumption 3: The sequence t_n is constructed by successively appending the binary complement of the existing sequence.\n\nBut this is a single line. However, the example allowed multiple assumptions. Let's see:\n\nIn the example, the original problem was to prove for every integer n, A(n) is divisible by 91. The formatted problem included assumptions: n is an integer, n is divisible by 7. Wait, but the original problem said \"for every integer n\", so the formatted problem added an extra assumption that n is divisible by 7, which contradicts the original. That seems like a mistake. But perhaps the example was incorrect, and the user wants us to follow the structure regardless.\n\nAssuming that the user wants the assumptions to be the conditions given in the problem, even if they are not explicitly stated. For the current problem, the key is that t_n is the Thue-Morse sequence as defined in the problem statement. The problem is to prove the formula given that definition. Therefore, the assumptions would be:\n\nAssumption 1: The Thue-Morse sequence t_n is defined by t_0 = 0 and recursively appending the binary complement.\n\nAssumption 2: n is a non-negative integer.\n\nBut according to the example, each assumption should address only one property or condition applied to one object. Therefore:\n\nAssumption 1: n is a non-negative integer.\n\nAssumption 2: t_0 = 0.\n\nAssumption 3: For each m ≥ 0, the sequence t_{2^m} to t_{2^{m+1}-1} is the binary complement of the sequence t_0 to t_{2^m -1}.\n\nThis way, each assumption is a separate line. Assumption 1 is about n, assumption 2 is about t_0, assumption 3 is about the recursive construction.\n\nAlternatively, since the problem mentions the Thue-Morse sequence's construction, perhaps the assumptions are just the definition steps. However, to follow the example's structure, which included two assumptions (n is integer, n divisible by 7), here we can structure as:\n\nAssumption 1: n is a non-negative integer.\n\nAssumption 2: The Thue-Morse sequence t_n is constructed by starting with t_0 = 0 and appending the binary complement of the existing sequence.\n\nBut the example split into two assumptions for two properties of the same object (n). Here, perhaps:\n\nAssumption 1: n is a non-negative integer.\n\nAssumption 2: t_0 = 0.\n\nAssumption 3: For each k ≥ 0, the subsequence t_{2^k} to t_{2^{k+1}-1} is the binary complement of t_0 to t_{2^k -1}.\n\nThis way, each assumption is a single line, each addressing one property. The third assumption explains how the sequence is extended each time.\n\nThe problem statement is to prove the given formula for t_n. Therefore, the formatted problem should have these assumptions and the problem as proving the formula.\n\nSo putting it all together:\n\n###BEGIN_OF_FORMAT###\nAssumption: \nn is a non-negative integer,\nt_0 = 0,\nfor each k ≥ 0, the subsequence t_{2^k} to t_{2^{k+1}-1} is the binary complement of t_0 to t_{2^k -1}.\nProblem: \nProve that the Thue–Morse sequence $$t_n=\\frac43\\,\\sin^2\\left(\\frac\\pi3\\left(n-\\sum_{k=1}^n(-1)^{\\binom n k}\\right)\\right)=\\operatorname{mod}\\left(2n+\\sum_{k=1}^n(-1)^{\\binom n k},\\,3\\right).$$\n###END_OF_FORMAT###\n\nWait, but the original problem statement has two expressions for t_n. Should both be included? The problem states \"a nice formula for this sequence that uses only elementary functions...\", and provides two expressions. The user wants to prove that t_n equals either of those expressions. So the problem is to prove both equalities, or that they are equivalent and each equals t_n.\n\nIn the original problem statement, the user wrote:\n\n\"$$t_n=\\frac43\\,\\sin^2\\left(\\frac\\pi3\\left(n-\\sum_{k=1}^n(-1)^{\\binom n k}\\right)\\right)=\\operatorname{mod}\\left(2n+\\sum_{k=1}^n(-1)^{\\binom n k},\\,3\\right).$$\"\n\nSo two expressions separated by an equals sign. Therefore, the problem is to prove that both expressions equal t_n. However, the user might be asking to prove that the formula (either one) equals t_n. The problem statement says \"a nice formula...\", so the task is to prove that t_n is equal to that formula.\n\nTherefore, the problem line should state: Prove that the Thue-Morse sequence t_n satisfies the given formula. But in the example, the problem was to prove that A(n) is divisible by 91. Here, similarly, the problem is to prove that t_n equals the provided expressions.\n\nSo final answer would be:\n\nAssumption: n is a non-negative integer,\nt_0 = 0,\nfor each k ≥ 0, the subsequence t_{2^k} to t_{2^{k+1}-1} is the binary complement of t_0 to t_{2^k -1}.\nProblem: Prove that $$t_n=\\frac43\\,\\sin^2\\left(\\frac\\pi3\\left(n-\\sum_{k=1}^n(-1)^{\\binom n k}\\right)\\right)=\\operatorname{mod}\\left(2n+\\sum_{k=1}^n(-1)^{\\binom n k},\\,3\\right).$$\n\nYes, that seems correct.",
    "Original_Problem": "Assumption: \nn is a non-negative integer,\nt_0 = 0,\nfor each k ≥ 0, the subsequence \\( t_{2^k} \\) to \\( t_{2^{k+1}-1} \\) is the binary complement of \\( t_0 \\) to \\( t_{2^k -1} \\).\nProblem: \nProve that the Thue–Morse sequence $$t_n=\\frac43\\,\\sin^2\\left(\\frac\\pi3\\left(n-\\sum_{k=1}^n(-1)^{\\binom n k}\\right)\\right)=\\operatorname{mod}\\left(2n+\\sum_{k=1}^n(-1)^{\\binom n k},\\,3\\right).$$",
    "Original_Problem_with_numerical_assumption": "Assumption:\nAssumption 1: n is a non-negative integer,\nAssumption 2: t_0 = 0,\nAssumption 3: for each k ≥ 0, the subsequence \\( t_{2^k} \\) to \\( t_{2^{k+1}-1} \\) is the binary complement of \\( t_0 \\) to \\( t_{2^k -1} \\).\nProblem: \nProve that the Thue–Morse sequence $$t_n=\\frac43\\,\\sin^2\\left(\\frac\\pi3\\left(n-\\sum_{k=1}^n(-1)^{\\binom n k}\\right)\\right)=\\operatorname{mod}\\left(2n+\\sum_{k=1}^n(-1)^{\\binom n k},\\,3\\right).$$",
    "Proof_problem": "Yes",
    "Redundant_assumption": "$$n - \\sum_{k=1}^n (-1)^{\\binom{n}{k}} \n= \\sum_{k=0}^n \\left(1 - (-1)^{\\binom{n}{k}}\\right) -2\n= 2\\sum_{k=0}^nP\\left(\\binom{n}{k}\\right) - 2\\tag{*1}\n$$",
    "Problem_with_redundant_assumption": "Assumption:\nAssumption 1: n is a non-negative integer,\nAssumption 2: t_0 = 0,\nAssumption 3: for each k ≥ 0, the subsequence \\( t_{2^k} \\) to \\( t_{2^{k+1}-1} \\) is the binary complement of \\( t_0 \\) to \\( t_{2^k -1} \\).\nAssumption 4: $$n - \\sum_{k=1}^n (-1)^{\\binom{n}{k}} \n= \\sum_{k=0}^n \\left(1 - (-1)^{\\binom{n}{k}}\\right) -2\n= 2\\sum_{k=0}^nP\\left(\\binom{n}{k}\\right) - 2\\tag{*1}\n$$\nProblem: \nProve that the Thue–Morse sequence $$t_n=\\frac43\\,\\sin^2\\left(\\frac\\pi3\\left(n-\\sum_{k=1}^n(-1)^{\\binom n k}\\right)\\right)=\\operatorname{mod}\\left(2n+\\sum_{k=1}^n(-1)^{\\binom n k},\\,3\\right).$$"
}