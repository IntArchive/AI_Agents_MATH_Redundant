{
    "Link_API": "https://api.stackexchange.com/2.3/questions/64971",
    "Title": "Proof $\\sum\\limits_{k=1}^n \\binom{n}{k}(-1)^k \\log k = \\log \\log n + \\gamma +\\frac{\\gamma}{\\log n} +O\\left(\\frac1{\\log^2 n}\\right)$",
    "Score": 27,
    "Category": "Chứng minh",
    "Tags": "combinatorics, complex-analysis, algorithms, asymptotics",
    "Link": "https://math.stackexchange.com/questions/64971/proof-sum-limits-k-1n-binomnk-1k-log-k-log-log-n-gamma-fr",
    "Content": "More precisely, $$\\sum_{k=1}^n \\binom{n}{k}(-1)^k \\log k = \\log \\log n + \\gamma +\\frac{\\gamma}{\\log n} -\\frac{\\pi^2  + 6 \\gamma^2}{12 \\log^2 n} +O\\left(\\frac1{\\log ^3 n}\\right).$$ This is Theorem 4 from Flajolet, Sedgewick (1995) and was obtained using Hankel integration. It is related to analysis of quadtrees and digital search trees. I know from 'Concrete Mathematics' that similar-looking sums can be obtained and solved using discrete form of derivatives, $\\nabla f(x)=f(x+1)-f(x)$ and so $n^{\\text{th}}$ difference is $$\\nabla^n f(x)=\\sum_{k=0}^{n} \\binom{n}{k} (-1)^{n-k} f(x+k) $$ and I know how to use it for simple functions such as $f(x)=\\dfrac1{x}$, but I have no idea how solve something like the one above.",
    "AcceptedAnswer": "Thanks go to Andrew, J. M., and David Speyer!  The following solution leans heavily on what these three have already posted. (In the interest of having a complete solution I've added the argument that gets from the OP's sum to Andrew's reformulation of it.) Part 1: Getting to Andrew's gamma function formula. Since $$\\int_0^1\\sum_{m=1}^{k-1}\\frac1{x+m}\\, dx = \\sum_{m=1}^{k-1}(\\log(m+1) - \\log m) = \\log k,$$\nwe can rewrite the original formula as\n$$\\sum_{k=1}^n \\binom{n}{k}(-1)^k \\log k=\n\\sum_{k=2}^n \\binom{n}{k}(-1)^k\\int_0^1\\sum_{m=1}^{k-1}\\frac1{x+m}\\, dx = \\int_0^1 \\sum_{m=1}^{n-1} \\frac1{x+m} \\sum_{k=m+1}^n \\binom{n}{k}(-1)^k\\, dx.$$\nSince alternating row sums of binomial coefficients are easy to evaluate (see, for instance, Concrete Mathematics , Identity 5.16), this becomes (and then switching the index back to $k$)\n$$\\int_0^1 \\sum_{m=1}^{n-1} \\frac1{x+m} (-1)^{m-1} \\binom{n-1}{m}\\, dx = \\int_0^1 \\sum _{k=1}^{n-1}\\binom{n-1}{k} \\frac{(-1)^{k-1}}{k+x} \\, dx$$\n$$ = \\int_0^1 \\left(\\frac{1}{x} - \\sum _{k=0}^{n-1}\\binom{n-1}{k} \\frac{(-1)^k}{k+x}\\right) \\, dx.$$\nThe remaining binomial sum is actually the partial fractions decomposition of $\\frac{(n-1)!}{x(x+1)\\cdots (x+n-1)}$.  (This is identity 5.41 in Concrete Mathematics .  From another perspective - also discussed in Concrete Mathematics - the binomial sum is $(-1)^n$ times the $n-1$ difference of $\\frac{1}{x} = (x-1)^{\\underline{-1}}$.  Applying the finite difference rule $\\Delta x^{\\underline{m}} = m x^{\\underline{m-1}}$ successively $n-1$ times thus gets us to $\\frac{(n-1)!}{x(x+1)\\cdots (x+n-1)}$.) Thus our original sum is equivalent to \n$$\\int_0^1 \\left(\\frac{1}{x} - \\frac{(n-1)!}{x(x+1)\\cdots (x+n-1)}\\right) dx = \\int_0^1 \\left(\\frac{1}{x} - \\frac{\\Gamma(n) \\Gamma(x)}{\\Gamma(n+x)}\\right) dx,$$\nwhich is the formula Andrew mentions in the comments. Part 2: Rewriting the expression. Now, rewrite like so:\n$$\\int_0^1 \\left( \\frac{1}{x} - \\frac{\\Gamma(n) \\Gamma(x)}{\\Gamma(n+x)} \\right) dx = \\int_0^1 \\left( \\frac{1}{x}\\left(1- \\frac{\\Gamma(n) \\Gamma(x+1)}{\\Gamma(n+x)} \\right)\\right) dx.$$ For $0 < x < 1$, $$\\Gamma(x+1) = 1 - \\gamma x + \\frac{\\zeta(2) + \\gamma^2}{2}x^2 + O(x^3).$$  (This is the Maclaurin series for $\\Gamma(x+1)$; see Expression 8.321 in Gradshteyn and Ryzhik .  The only reason I know this is because I had to track it down for a paper I wrote a couple of years ago.)  Also, $$\\frac{\\Gamma(n)}{\\Gamma(n+x)} = n^{-x}\\left(1 + O\\left(\\frac{1}{n}\\right)\\right).$$  (See the DLMF .) Putting all this together means we want the asymptotic value of\n\\begin{equation}\n\\int_0^1 \\frac{1-n^{-x}\\left(1+ O\\left(\\frac{1}{n}\\right)\\right)\\left(1 - \\gamma x + \\frac{\\zeta(2) + \\gamma^2}{2}x^2 + O(x^3)\\right)}{x} dx. \\tag{1}\n\\end{equation} Part 3: Obtaining the dominant terms. Following David Speyer and J.M., we'll first extract what turns out to be the dominant part of (1): $$\\int_0^1 \\frac{1-n^{-x}}{x}dx = \\int_0^1 \\frac{1-e^{-x \\log n}}{x}dx = \\int_0^{\\log n} \\frac{1-e^{-u}}{u} du = \\text{Ein}(\\log n),$$\nwhere $\\text{Ein}(x)$ is the complementary exponential integral .  Now, $\\text{Ein}(x) = E_1(x) + \\log x + \\gamma$, where $E_1(x)$ is the usual exponential integral (again, see the DLMF ), and $E_1(x) < e^{-x} \\log (1 + 1/x)$ ( DLMF once again), so putting all of this together we have\n$$\\int_0^1 \\frac{(1-n^{-x})}{x}dx = \\log \\log n + \\gamma + O\\left(\\frac{1}{n}\\right).$$ Part 4: Obtaining the remaining terms. Now we consider the rest of (1).  This is\n$$\\left(1+ O\\left(\\frac{1}{n}\\right)\\right)\\int_0^1 n^{-x}\\left(\\gamma - \\frac{\\zeta(2) + \\gamma^2}{2}x + O(x^2)\\right) dx$$\n$$=\\left(1+ O\\left(\\frac{1}{n}\\right)\\right)\\left(\\gamma \\left(\\frac{n-1}{n \\log n}\\right) - \\frac{\\zeta(2) + \\gamma^2}{2}\\left(\\frac{n - \\log n -1}{n (\\log n)^2}\\right) + O\\left(\\frac{1}{(\\log n)^3}\\right)\\right)$$\n$$=\\frac{\\gamma }{\\log n} - \\frac{\\zeta(2) + \\gamma^2}{2(\\log n)^2} + O\\left(\\frac{1}{(\\log n)^3}\\right),$$\nwhich is the rest of the expression requested by the OP.",
    "llm_answer_create_structured_problem": "###BEGIN_OF_FORMAT###\nAssumption: \n$n$ is a positive integer,\nThe summation index $k$ ranges from $1$ to $n$,\nEach term in the sum is $\\binom{n}{k}(-1)^k \\log k$.\nProblem:\nProve that  \n$$\\sum_{k=1}^n \\binom{n}{k}(-1)^k \\log k = \\log \\log n + \\gamma +\\frac{\\gamma}{\\log n} -\\frac{\\pi^2  + 6 \\gamma^2}{12 \\log^2 n} +O\\left(\\frac1{\\log ^3 n}\\right).$$\n###",
    "reasoning_create_structured_problem": "Okay, let me try to tackle this problem. The user wants me to structure the given Math Stack Exchange question into the specified format. First, I need to identify the assumptions and the problem statement from the original question.\n\nThe original title and question mention the sum involving binomial coefficients, (-1)^k, and log k, resulting in an asymptotic expansion involving log log n, gamma, and higher-order terms. The user references Theorem 4 from Flajolet and Sedgewick (1995) and relates it to quadtrees and digital search trees. They also mention knowledge from \"Concrete Mathematics\" about using finite differences but are unsure how to apply it here.\n\nSo, the main problem is the summation formula. The assumptions need to be extracted. The original problem statement doesn't explicitly state many conditions, but in asymptotic analysis, typically n is a positive integer approaching infinity. Also, the sum starts at k=1, so k is an integer between 1 and n. The coefficients involve binomial coefficients and alternating signs. The problem is to prove the given asymptotic expansion for the sum. \n\nI need to list each assumption line by line. Since the problem is about an asymptotic expansion as n grows, the key assumptions would involve n being a positive integer, and perhaps that the expansion is valid for n tending to infinity. The sum is over k from 1 to n, with each term involving binomial coefficients, (-1)^k, and log k. The problem is to prove the specific form of the asymptotic expansion provided.\n\nWait, the original problem states the sum equals that expansion with O(1/log^3 n). So the assumptions would include that n is a positive integer, the sum is over k from 1 to n, and each term is as defined. The problem is to prove the asymptotic equality. The original problem also mentions using Hankel integration in the paper, but the user is asking about alternative methods using finite differences. However, in formatting the problem, we just need to present the problem and its assumptions, not the solution methods the user is considering. So the assumptions would be about the structure of the sum and the conditions on n and k.\n\nSo, the Assumption section should list:\n\n- n is a positive integer.\n- The sum is taken from k=1 to k=n.\n- Each term in the sum is (-1)^k multiplied by binomial(n,k) and log k.\n\nThe problem is to prove the given asymptotic expansion. The example given in the user's instruction had assumptions like n is an integer and n divisible by 7. Here, the key conditions are the structure of the sum and n being a positive integer. Since the asymptotic expansion is as n approaches infinity, maybe an assumption is that n is large, but since the problem states for n in general (with an error term), perhaps the main assumptions are the structure of the sum.\n\nTherefore, structured as:\n\nAssumption:\nn is a positive integer,\nThe sum is over k from 1 to n,\nEach term in the sum is $\\binom{n}{k}(-1)^k \\log k$.\n\nProblem: Prove that $$\\sum_{k=1}^n \\binom{n}{k}(-1)^k \\log k = \\log \\log n + \\gamma +\\frac{\\gamma}{\\log n} +O\\left(\\frac1{\\log^2 n}\\right)$$\n\nWait, the original problem states a more precise expansion including - (π² +6γ²)/(12 log² n) + O(1/log³ n), but the user in the Problem section might truncate it to O(1/log² n). But looking at the user's example, they simplified the original problem's conclusion. In their example, the original problem had the sum divisible by 91, but in the formatted problem, they listed the problem as \"Prove that... is divisible by 91\" even though the original had more context. So perhaps in the Problem section here, the exact statement to prove is the equation as written. However, the user's example also removed some parts; in their example, the original assumption was that n is an integer and divisible by 7, but in the formatted problem, they listed \"n is an integer, n is divisible by 7\" as assumptions, even though the original problem said \"for every integer n\". Wait, the original problem in the example was to prove for every integer n, the expression is divisible by 91. The formatted problem added an assumption that n is divisible by 7, which seems incorrect. Wait, maybe the example had a mistake? Let me check. The user's example:\n\nOriginal problem: Prove that for every integer n, A(n) is divisible by 91.\n\nFormatted problem:\nAssumption: n is an integer, n is divisible by 7.\n\nProblem: Prove that A(n) is divisible by 91.\n\nWait, this seems wrong. The original problem states \"for every integer n\", but in the formatted problem, they added an assumption that n is divisible by 7. That's incorrect. But maybe the user made a mistake in their example. Wait, perhaps the original problem had some hidden condition? For example, if 91=13*7, then maybe the divisibility by 7 and 13 requires n to satisfy some condition. But the example given by the user might have a mistake. But regardless, when processing the current problem, I should follow the instructions but correct any inconsistencies.\n\nHowever, the user is providing their own example, which may have errors, but we need to follow their structure. So for the current problem, the task is to list all the assumptions. The original problem states an identity for the sum, which is claimed to hold with the given asymptotic expansion. So the assumptions would include that n is a positive integer (since the sum is up to n), the sum is as defined, and perhaps that n is sufficiently large for the asymptotic expansion to hold. However, in asymptotic analysis, the expansion is valid as n tends to infinity, but the problem might be stated for all n >= some integer. But since the problem statement doesn't specify, perhaps the main assumptions are the structure of the sum. The original problem mentions \"for n\" in the title, so the key elements are the sum's components.\n\nSo, following the user's example, even if their example had an error, we proceed to extract assumptions line by line, each addressing one property or condition applied to one object.\n\nHence:\n\nAssumption:\nn is a positive integer,\nThe summation index k ranges from 1 to n,\nEach term in the sum is $\\binom{n}{k}(-1)^k \\log k$,\nThe asymptotic expansion is considered as n approaches infinity.\n\nBut wait, in the user's example, they included \"n is an integer\" and \"n is divisible by 7\" even though the original problem said \"for every integer n\". So maybe the assumptions are all the conditions needed for the problem to hold. But in their example, the problem's original statement was \"for every integer n\", but the formatted problem added \"n is divisible by 7\", which changes the problem. That seems incorrect. Perhaps the user made a mistake in their example. Therefore, I need to be careful here.\n\nIn the current problem, the problem is to prove that the given sum equals the asymptotic expansion. The original question states the expansion as Theorem 4 from Flajolet and Sedgewick, obtained via Hankel integration. The user is asking how to approach this using finite differences instead. But when structuring the problem, we should present the problem as stated, not the methods. Therefore, the assumptions are the conditions under which the problem is posed. The problem is about the sum for a general positive integer n, with the asymptotic expansion. So the key assumptions are:\n\n- n is a positive integer.\n- The sum is from k=1 to n.\n- Each term is (-1)^k multiplied by binomial(n,k) and log k.\n- The asymptotic expansion is as n approaches infinity.\n\nBut the problem statement in the original question includes the full expansion with the error term O(1/log^3 n), but the problem to prove is that equality. Therefore, the assumptions should include that n is a positive integer, the sum is structured as described, and perhaps that n is sufficiently large for the asymptotic expansion to hold. However, since asymptotic expansions are generally for n approaching infinity, that's an implicit assumption. But in the user's example, they included explicit divisibility conditions, so maybe here we should include that n is a positive integer and the sum structure. The problem is to prove the given equality with the asymptotic terms.\n\nThus, structured as:\n\nAssumption:\nn is a positive integer,\nThe summation is over integers k where 1 ≤ k ≤ n,\nEach term in the summation is of the form $\\binom{n}{k}(-1)^k \\log k$.\n\nProblem: Prove that\n$$\n\\sum_{k=1}^n \\binom{n}{k}(-1)^k \\log k = \\log \\log n + \\gamma + \\frac{\\gamma}{\\log n} + O\\left( \\frac{1}{\\log^2 n} \\right)\n$$\n\nBut the original problem's statement includes more terms in the expansion: - (π² +6γ²)/(12 log² n) + O(1/log³ n). However, the user might have truncated it in the Problem section. But according to the instructions, we should structure the problem as it is, so the full expansion should be included. Wait, the user's example truncated the problem's original expression. In the example, the original problem had A(n) = 5^n(5^n +1) -6^n(3^n+2^n), and the formatted problem kept the same expression. So in that case, the expression wasn't truncated. Therefore, in the current problem, the full expression given in the original question should be retained. The problem statement in the original question is:\n\nProve that the sum equals log log n + gamma + gamma/log n - (pi² +6 gamma²)/(12 log² n) + O(1/log³ n). So the problem should be written with the full expansion. However, the user's example shows that they included the problem as stated, so we should do the same here.\n\nBut the user's instruction says to \"structure that problem as the following format\" with the example provided. The example had the problem's expression as given, but the assumptions were perhaps incorrect. However, regardless, we need to follow the user's example structure.\n\nTherefore, the correct formatting would be:\n\nAssumption:\nn is a positive integer,\nThe sum is taken over k from 1 to n,\nEach term in the sum is $\\binom{n}{k}(-1)^k \\log k$.\n\nProblem: Prove that\n$$\n\\sum_{k=1}^n \\binom{n}{k}(-1)^k \\log k = \\log \\log n + \\gamma +\\frac{\\gamma}{\\log n} -\\frac{\\pi^2  + 6 \\gamma^2}{12 \\log^2 n} +O\\left(\\frac1{\\log ^3 n}\\right).\n$$\n\nBut in the user's example, they didn't include all terms. Wait, no. The user's example had the original problem as proving divisibility by 91, and the formatted problem repeated that. So in the current case, the problem statement should include the full asymptotic expansion as given. Therefore, the formatted problem should include all the terms mentioned in the original question.\n\nTherefore, the Assumptions are:\n\n- n is a positive integer.\n- The sum is from k=1 to n.\n- Each term is binomial(n,k)(-1)^k log k.\n\nProblem: Prove the given equality with the specified asymptotic expansion.\n\nThus, the final formatted problem is:\n\n###BEGIN_OF_FORMAT###\nAssumption: \nn is a positive integer,\nThe summation index $k$ ranges from $1$ to $n$,\nEach term in the sum is $\\binom{n}{k}(-1)^k \\log k$.\nProblem:\nProve that  \n$$\\sum_{k=1}^n \\binom{n}{k}(-1)^k \\log k = \\log \\log n + \\gamma +\\frac{\\gamma}{\\log n} -\\frac{\\pi^2  + 6 \\gamma^2}{12 \\log^2 n} +O\\left(\\frac1{\\log ^3 n}\\right).$$",
    "Original_Problem": "Assumption: \n$n$ is a positive integer,\nThe summation index $k$ ranges from $1$ to $n$,\nEach term in the sum is $\\binom{n}{k}(-1)^k \\log k$.\nProblem:\nProve that  \n$$\\sum_{k=1}^n \\binom{n}{k}(-1)^k \\log k = \\log \\log n + \\gamma +\\frac{\\gamma}{\\log n} -\\frac{\\pi^2  + 6 \\gamma^2}{12 \\log^2 n} +O\\left(\\frac1{\\log ^3 n}\\right).$$",
    "Original_Problem_with_numerical_assumption": "Assumption:\nAssumption 1: $n$ is a positive integer,\nAssumption 2: The summation index $k$ ranges from $1$ to $n$,\nAssumption 3: Each term in the sum is $\\binom{n}{k}(-1)^k \\log k$.\nProblem:\nProve that  \n$$\\sum_{k=1}^n \\binom{n}{k}(-1)^k \\log k = \\log \\log n + \\gamma +\\frac{\\gamma}{\\log n} -\\frac{\\pi^2  + 6 \\gamma^2}{12 \\log^2 n} +O\\left(\\frac1{\\log ^3 n}\\right).$$",
    "Proof_problem": "Yes",
    "Redundant_assumption": "$$\\int_0^1 \\frac{(1-n^{-x})}{x}dx = \\log \\log n + \\gamma + O\\left(\\frac{1}{n}\\right).$$",
    "Problem_with_redundant_assumption": "Assumption:\nAssumption 1: $n$ is a positive integer,\nAssumption 2: The summation index $k$ ranges from $1$ to $n$,\nAssumption 3: Each term in the sum is $\\binom{n}{k}(-1)^k \\log k$.\nAssumption 4: $$\\int_0^1 \\frac{(1-n^{-x})}{x}dx = \\log \\log n + \\gamma + O\\left(\\frac{1}{n}\\right).$$\nProblem:\nProve that  \n$$\\sum_{k=1}^n \\binom{n}{k}(-1)^k \\log k = \\log \\log n + \\gamma +\\frac{\\gamma}{\\log n} -\\frac{\\pi^2  + 6 \\gamma^2}{12 \\log^2 n} +O\\left(\\frac1{\\log ^3 n}\\right).$$"
}