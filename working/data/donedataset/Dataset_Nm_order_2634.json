{
    "Link_API": "https://api.stackexchange.com/2.3/questions/1069157",
    "Title": "If $p\\equiv 1,9 \\pmod{20}$ is a prime number, then there exist $a,b\\in\\mathbb{Z}$ such that $p=a^{2}+5b^{2}$.",
    "Score": 13,
    "Category": "Chứng minh",
    "Tags": "number-theory, algebraic-number-theory",
    "Link": "https://math.stackexchange.com/questions/1069157/if-p-equiv-1-9-pmod20-is-a-prime-number-then-there-exist-a-b-in-mathbbz",
    "Content": "I have to prove that if $p\\equiv 1,9 \\pmod{20}$ is a prime number then there exist $a,b\\in\\mathbb{Z}$ such that $p=a^{2}+5b^{2}$. I consider the quadratic field $\\mathbb{Q}(\\sqrt{-5})$, with ring of integers $A=\\mathbb{Z}[\\sqrt{-5}]$. It is easy to check that $\\left (- \\dfrac{5}{p} \\right)=1$ if $p\\equiv 1,9 \\pmod {20}$. According to this, $t^{2}+5$ has two different roots in $\\mathbb{F}_{p}$. In consequence, $pA=P_{1}P_{2}$ for certain prime ideals $P_{1}, P_{2}$ with norm $p$. A is not a PID, but if I prove that $P_{1}$ or $P_{2}$ are principal, then I had there exist $\\gamma=a+b\\sqrt{-5}\\in A$ such that: $p=N(P_{i})=N(\\gamma A)=|N_{\\mathbb{Q}(\\sqrt{-5})|\\mathbb{Q}}(\\gamma)|=a^{2}+5b^{2}$, and I would have finished. The problem is that I do not know how to prove this. If there is an easier way, please, let me know.",
    "AcceptedAnswer": "I'm not sure which level to write this at. Here is a completely elementary proof: As you say, if $p \\equiv 1$, $3$, $7$ or $9 \\bmod 20$, then $\\left( \\frac{-5}{p} \\right) = 1$. Let $p$ be in one of these residue classes and let $a$ be a square root of $-5$ modulo $p$. Let $\\Lambda \\subset \\mathbb{Z}^2$ be the lattice of pairs $(x,y)$ such that $x \\equiv ay \\bmod p$. For any $(x,y) \\in \\Lambda$, we have $x^2+5 y^2 \\equiv (ay)^2 + 5 y^2 \\equiv (-5+5) y^2 \\equiv 0 \\bmod p$. Since $\\Lambda$ has index $p$ in $\\mathbb{Z}^2$, the fundamental domain of $\\Lambda$ has area $p$. The ellipse $\\{ (x,y) : x^2+5y^2 < N \\}$ has area $\\pi N/\\sqrt{5}$. \nTherefore, taking $N = (4\\sqrt{5}/\\pi) p \\approx 2.85 p$, Minkowski's theorem shows that $\\Lambda$ contains a point $(x,y)$ with $0 < x^2+5y^2 < 2.85 p$. Since $x^2+5y^2 \\equiv 0 \\bmod p$, we deduce that $x^2+5y^2 = p$ or $2p$. So far, the proof works for all four residue classes $1, 3, 7, 9 \\bmod 20$. Now note that, if $p \\equiv 1$ or $9 \\bmod 20$, the equation $x^2+5y^2 = 2 p$ is impossible modulo $8$. You can tweak this proof to be more or less sophisticated, as you please. More If $\\left( \\frac{-5}{p} \\right)=1$ then the ideal $p$ splits as $\\mathfrak{p} \\bar{\\mathfrak{p}}$ in $\\mathbb{Z}[\\sqrt{-5}]$. From the Minkowski bound , $\\mathfrak{p}$ must have the same ideal class as an ideal of norm $< 4 \\sqrt{5}/\\pi \\approx 2.85$, so either $\\mathfrak{p}$ is principal or else $\\mathfrak{p} \\sim \\langle 2, 1+\\sqrt{5} \\rangle$, in which case $\\mathfrak{p} \\cdot \\langle 2, 1+\\sqrt{5} \\rangle$ is principal. In the former case, we have a solution to $x^2+5y^2=p$; in the latter case, we have a solution to $x^2+5y^2=2p$ which is impossible modulo $8$. It's not a surprise that the same numbers are showing up -- the above proof is simply this one without mentioning ideal classes. Less If you don't want to mention Minkowski's theorem, you can mimic the pigeonhole proof here that any prime which is $1 \\bmod 4$ is the sum of two squares. Consider the numbers $x-ay$ for $0 \\leq x < \\sqrt[4]{5} \\sqrt{p}$ and $0 \\leq y < \\sqrt{p}/\\sqrt[4]{5}$ and proceed as in the link. The inequality isn't as good as you get with Minkowski: You conclude that you can solve $x^2+5y^2 \\equiv 0 \\bmod p$ with $0 < x^2+5y^2 < 2 \\sqrt{5} p \\approx 4.46 p$. But that's good enough, you just get a few more cases. If $x^2+5y^2=p$, you win. If $x^2+5y^2=2p$, you get a contradiction modulo $8$, if $x^2+5y^2 = 3p$, you get a contradiction modulo $4$. If $x^2+5y^2=4p$ then looking modulo $4$ shows that $x$ and $y$ are even, so $(x/2)^2+5(y/2)^2=p$.",
    "llm_answer_create_structured_problem": "###BEGIN_OF_FORMAT###\nAssumption: \n$p$ is a prime number,\n$p \\equiv 1 \\pmod{20}$ or $p \\equiv 9 \\pmod{20}$,\n$a, b$ are integers.\nProblem: \nProve that there exist integers $a, b$ such that $p = a^{2} + 5b^{2}$.\n###END_OF_FORMAT###",
    "reasoning_create_structured_problem": "Okay, let me try to work through this problem step by step. The user wants to prove that if a prime number p is congruent to 1 or 9 modulo 20, then there exist integers a and b such that p can be expressed as a² + 5b². They mentioned using the ring of integers in the quadratic field Q(√-5), which is Z[√-5]. \n\nFirst, the user notes that for primes p ≡ 1,9 mod 20, the Legendre symbol (-5/p) is 1, which implies that the equation t² + 5 splits into linear factors modulo p. Therefore, the ideal pA in the ring A = Z[√-5] factors into two prime ideals P1 and P2 each of norm p. However, since A is not a PID, the user is stuck on proving that either P1 or P2 is principal. If they can show that one of these ideals is principal, then the generator γ = a + b√-5 would have norm a² + 5b² equal to p, solving the problem.\n\nThe challenge here is that even though the ideal splits, the ring isn't a PID, so not all ideals are principal. The user is looking for a way to show that in this specific case, one of the split prime ideals is principal. Alternatively, maybe there's another approach without delving too deep into ideal theory.\n\nLet me recall some algebraic number theory. For quadratic fields, the class number is important. The field Q(√-5) has class number 2, which means its class group (the group of ideals modulo principal ideals) has order 2. This suggests that every ideal squared is principal. But since the prime p splits into two distinct ideals P1 and P2, perhaps their classes in the class group are inverses. If the class group is of order 2, then each non-principal ideal's square is principal. But since p splits, maybe one of P1 or P2 is in the trivial class (i.e., principal) or not? Wait, if the class group has order 2, then each ideal is either principal or belongs to the non-trivial class. If P1 and P2 are inverses in the class group, then if one is non-principal, the other would be its inverse. But in a class group of order 2, the inverse is the same as the ideal itself. Wait, no. If the class group is cyclic of order 2, then the inverse of a non-trivial class is itself. So if P1 is non-principal, then P2 would be in the same class. Then their product pA would be in the class of P1 * P2, which is trivial since pA is principal. So each P1 and P2 are in the same class, and their product is principal. If the class group is order 2, then squaring either P1 or P2 would give a principal ideal. But how does that help here?\n\nAlternatively, maybe the fact that p ≡ 1,9 mod 20 is key. These congruence conditions might relate to the norms of elements. For example, primes that split in Q(√-5) are those where p splits into two ideals, which happens when the Legendre symbol (-5/p) = 1. The primes p ≡ 1,9 mod 20 satisfy this because 20 is related to the discriminant of the field. The discriminant of Q(√-5) is -20, so primes p where -5 is a quadratic residue modulo p split. The conditions for -5 being a quadratic residue modulo p can be determined via quadratic reciprocity. Indeed, (-5/p) = 1 is equivalent to p ≡ 1, 3, 7, 9 mod 20, but the problem states p ≡1,9 mod 20. So perhaps there's a stricter condition here. Maybe the user made a mistake in stating that (-5/p)=1 when p≡1,9 mod 20? Wait, let's check:\n\nQuadratic reciprocity: (-5/p) = (-1/p)(5/p). Then (-1/p) = 1 if p ≡1 mod 4, and (5/p) = (p/5) by quadratic reciprocity since 5 ≡1 mod 4. So (p/5) is 1 if p ≡1 or 4 mod 5. Therefore, combining these, (-5/p)=1 if p ≡1 mod 4 and p≡1,4 mod5. Let me compute this using the Chinese remainder theorem. Let's find p mod 20. Since mod 4 and mod 5.\n\nIf p ≡1 mod 4, then possible residues mod 20 are 1,5,9,13,17. But p must also be ≡1 or 4 mod5. Mod5, 1 mod4 and 1 mod5 gives p≡1 mod20. 1 mod4 and 4 mod5 gives p≡9 mod20 (since 4 mod5 and 1 mod4: 4 +5k. 4 mod5 is 4,9,14,19 mod20. But 4 mod5 and 1 mod4: 9 mod20). Similarly, 5 mod5 is 0, which is not prime except 5 itself. So primes p ≡1,9 mod20 will have (-5/p)=1. So the user is correct in their assertion.\n\nTherefore, for primes p ≡1,9 mod20, the ideal pA splits into two prime ideals P1 and P2. Now, the key is to show that one of these is principal. Since the class number is 2, each ideal class when squared becomes principal. But how does this help? If the class group has order 2, then if P1 is in the non-trivial class, then P1² is principal. But here, P1 * P2 = pA, which is principal. If P1 and P2 are inverses in the class group, then if P1 is non-principal, P2 must be in the inverse class. However, in a class group of order 2, the inverse of a non-principal ideal is itself. Therefore, P1 * P2 would be P1², which is principal. But since P1 * P2 = pA is principal, then if P1 is non-principal, P2 must be equivalent to P1^{-1} which in class group order 2 is P1 itself. So P1 * P1 = pA. But in reality, the norm of P1 is p, so the norm of P1² would be p², but the norm of pA is p². So this checks out. Therefore, if pA splits into P1 and P2, then either P1 is principal or both are non-principal but P1² is principal. However, in this case, since the class group has order 2, the ideals P1 and P2 are in the same class. If the class is principal, then we're done. If not, then their product is principal, but how do we know that in this specific case, they must be principal?\n\nWait, maybe the fact that p ≡1,9 mod20 gives some additional structure. Perhaps there's a connection between the residue class of p mod 20 and the principality of the ideals. For instance, in some quadratic fields, the splitting of primes and their representation by quadratic forms depend on congruence conditions. In this case, the problem states that primes congruent to 1 or 9 mod20 can be expressed as a² +5b², which is equivalent to the norm in Z[√-5]. However, since Z[√-5] is not a UFD, not all norms can be represented by principal ideals. But perhaps under these congruence conditions, the ideals are principal.\n\nAlternatively, maybe there's a different approach using binary quadratic forms. The form a² +5b² is a quadratic form of discriminant -20. The class number for this discriminant is 2, which matches the class number of the ring of integers. Primes represented by this form correspond to certain congruence conditions. Specifically, a prime p can be expressed as a² +5b² if and only if p ≡1 or 9 mod20. This is exactly what the problem is asking. So perhaps the user is being asked to connect the splitting of the prime in the ring of integers to its representation by the quadratic form. \n\nSince the class number is 2, there are two equivalence classes of quadratic forms with discriminant -20. The principal class (a² +5b²) and another class, perhaps 2a² + 2ab + 3b². Then primes that split into principal ideals correspond to the principal form, and those that split into non-principal ideals correspond to the other form. Therefore, if p is congruent to1 or 9 mod20, it is represented by the principal form. The other form might represent primes congruent to 3,7 mod20. \n\nThus, the problem reduces to showing that primes p ≡1,9 mod20 are represented by the principal quadratic form a² +5b². The user's approach using ideals is valid, but since the ring isn't a PID, they need to use the class group structure. Since the class number is 2, and the ideals P1 and P2 are inverses in the class group, but their product is principal, then if the class of P1 is the principal class, we're done. If not, then both are in the non-principal class. But since the class group has order 2, then if the ideal P1 is non-principal, then P1^2 is principal. However, the norm of P1 is p, so P1^2 would have norm p², which is generated by an element of norm p². But we need an element of norm p. Therefore, this line of reasoning might not directly work.\n\nAlternatively, maybe the condition p ≡1,9 mod20 ensures that the ideals P1 or P2 are in the principal class. Since the class group has order 2, the order of each element divides 2. Therefore, if the ideal P1 has order 1 (principal) or order 2. If the ideal is of order 1, then it's principal. If it's of order 2, then P1^2 is principal. But how does the congruence condition affect the order of the ideal in the class group? \n\nPerhaps using genus theory. The discriminant here is -20, which factors as -4*5. The genus field can be determined, and the congruence conditions might correspond to genera. Each genus corresponds to certain congruence classes modulo the discriminant. In this case, since the class number is 2, there are two genera. The principal genus would include the principal form, and the other genus the non-principal form. The primes represented by the principal genus are those where the congruence conditions hold. So primes congruent to 1,9 mod20 would lie in the principal genus and hence can be expressed by the principal form a² +5b².\n\nAlternatively, perhaps using the theorem that a prime p can be expressed by a quadratic form of discriminant D if and only if there exists an ideal in the corresponding ideal class whose norm is p. Since the class number is 2, there are two classes. If p is in the principal class, then it can be expressed as a² +5b². The conditions on p would then correspond to the splitting in the quadratic field and the genus.\n\nAlternatively, consider the Minkowski bound for the field Q(√-5). The Minkowski bound is (4/π)√(20/4) = (4/π)√5 ≈ 2.85. Therefore, all ideals are equivalent to ideals of norm ≤2. Since 2 ramifies in Q(√-5) as (2, 1+√-5)^2. The only primes to consider are 2 and primes less than the Minkowski bound. But since the Minkowski bound is about 2.85, only the prime 2 is relevant. Therefore, the class group is generated by the prime ideal above 2, which is non-principal. Hence, the class group is of order 2. Therefore, any ideal not equivalent to the principal class is equivalent to the ideal (2, 1+√-5). \n\nThus, if the ideal P1 (which has norm p) is in the principal class, then p can be expressed as a² +5b². If not, then it's equivalent to the non-principal class, which would mean it can be expressed as 2a² + 2ab + 3b². But since p ≡1,9 mod20, which are 1 mod4 primes, perhaps they are not represented by the non-principal form which may require p ≡3 mod4. Wait, the non-principal form 2a² +2ab +3b² has discriminant (2)^2 -4*2*3 =4 -24 = -20. The primes represented by this form would satisfy certain conditions. Let's see: \n\nThe non-principal form 2a² +2ab +3b². Let's compute its values modulo 5. The discriminant is -20, so the primes represented must satisfy certain conditions. Alternatively, compute the numbers represented by this form. For example, when a and b are integers, 2a² +2ab +3b² = 2(a² +ab) +3b². If we set a=0, get 3b². If b=0, get 2a². Otherwise, mixing. For primes, if p is represented by this form, then p must be 2,3, or primes where p ≡2,3,7 mod20. For example, primes like 7: 2(1)^2 +2(1)(1) +3(1)^2=2+2+3=7. Similarly, 23=2(2)^2 +2(2)(1) +3(1)^2=8 +4 +3=15, which is not prime. Wait, maybe my examples are off.\n\nAlternatively, since the principal form is a² +5b², which can represent primes like 1 +5*1=6 (not prime), 1 +5*4=21 (not prime), 9 +5*4=29 (prime). 29 mod20 is 9, which matches the problem's condition. Similarly, 29 is represented as 3² +5*2². \n\nOn the other hand, the non-principal form 2a² +2ab +3b² represents primes like 7 (as above), 23 (2(3)^2 +2(3)(1) +3(1)^2=18+6+3=27, not prime). Maybe 3: 2(0)^2 +2*0*1 +3(1)^2=3. So primes like 3,7, etc., which are congruent to 3,7 mod20. \n\nThus, primes p ≡1,9 mod20 are represented by the principal form, and primes p≡3,7 mod20 by the non-principal form. Therefore, the user's problem reduces to showing that primes congruent to1,9 mod20 lie in the principal genus and hence are represented by the principal form. \n\nTherefore, using the theory of quadratic forms, the problem can be answered. However, the user's approach using ideals in the ring Z[√-5] needs to connect to the quadratic form. Since the class group is of order 2, and the ideals P1 and P2 are in the same class (as their product is principal), then if the prime p is in the principal class, the ideals P1 and P2 must be principal. Therefore, for primes p ≡1,9 mod20, which are in the principal genus, the corresponding ideals are principal, hence p =a² +5b².\n\nTherefore, the user needs to link the congruence conditions to the principality of the ideals via the class group structure. Since the class group is of order 2, and the congruence conditions place p in the principal genus, the ideals must be principal, hence the representation exists.\n\nAlternatively, there's an elementary approach without algebraic number theory. For primes p ≡1,9 mod20, we can construct a and b such that p=a² +5b². Maybe using the fact that -5 is a quadratic residue modulo p, so there exists an integer k such that k² ≡ -5 mod p. Then, one can use Thue's lemma to find small integers a and b such that a ≡kb mod p, leading to a² +5b² ≡0 mod p. Then, since a and b are small, a² +5b² =p or multiple of p. But since p is prime, and a² +5b² >0, it must equal p.\n\nThue's lemma states that if n>1 and a is coprime to n, then there exist x,y with 0<|x|, |y| ≤√n such that x ≡ a y mod n. Applying this to n=p and a=k (the solution to k² ≡-5 mod p), then there exist x,y with x ≡ky mod p and |x|, |y| ≤√p. Then x² +5y² ≡(ky)² +5y² ≡y²(k² +5)≡0 mod p. Hence x² +5y² is divisible by p. Since x² +5y² ≤ (√p)^2 +5(√p)^2 =6p. Therefore, x² +5y² =p, 2p, 3p,4p,5p, or6p. But p is prime. If x² +5y² =p, we're done. If it's 2p, then 2p =x² +5y². But 2p is even, so x and y must be both even or both odd. If they're both even, x=2a, y=2b, then 2p=4a² +20b² → p=2a² +10b². But p is odd, so this can't happen. If x and y are both odd, x² ≡1 mod4, y² ≡1 mod4, so x² +5y² ≡1 +5*1=6≡2 mod4. But 2p ≡2 mod4 implies p ≡1 mod2, which is true. However, p is congruent to1 or9 mod20, which is 1 mod4 or 1 mod4. Wait, 9 mod20 is 1 mod4. So p ≡1 mod4. Therefore, 2p ≡2 mod4, but x² +5y² would be 6 mod4=2 mod4, which matches. So 2p =x² +5y². But then p = (x² +5y²)/2. Since x and y are both odd, let x=2a+1, y=2b+1. Plugging in would give complicated expressions, but maybe this path is not helpful.\n\nAlternatively, suppose x² +5y² =2p. Then, since p ≡1 mod4, 2p≡2 mod4. But x and y must both be odd. Let x=2k+1, y=2m+1. Then x²=4k²+4k+1, y²=4m²+4m+1. So x² +5y²=4k²+4k+1 +5(4m²+4m+1)=4k²+4k +1 +20m² +20m +5=4k²+4k +20m² +20m +6. This equals 2p, so 4k²+4k +20m² +20m +6=2p ⇒ 2k²+2k +10m² +10m +3=p. Since p ≡1 mod4, let's see what the right-hand side is mod4. 2k² +2k is even, 10m² +10m is 10*(m² +m). Since m² +m is always even, 10*(even)=20*integer≡0 mod4. So 0 +0 +3=3 mod4. But p ≡1 mod4, so 3≡1 mod4? No. Contradiction. Therefore, x² +5y²=2p is impossible. Hence, x² +5y² must equal p. Therefore, Thue's lemma gives a solution.\n\nTherefore, this provides an elementary proof that if p ≡1,9 mod20, then p can be expressed as a² +5b². This avoids algebraic number theory and uses only Thue's lemma and quadratic reciprocity.\n\nBut the user's original approach using ideals in Z[√-5] is also valid but requires understanding the class group. Since the class group has order 2, and the ideals P1 and P2 multiply to the principal ideal pA, and since p ≡1,9 mod20 places it in the principal genus, P1 and P2 must lie in the principal class. Therefore, they are principal ideals, generated by some a +b√-5, giving p=a² +5b².\n\nSo the answer is to connect the congruence conditions to the principality of the split ideals via the class group, or use an elementary approach with Thue's lemma. The user's original approach is on the right track but needs the class group insight.",
    "Original_Problem": "Assumption: \n$p$ is a prime number,\n$p \\equiv 1 \\pmod{20}$ or $p \\equiv 9 \\pmod{20}$,\n$a, b$ are integers.\nProblem: \nProve that there exist integers $a, b$ such that $p = a^{2} + 5b^{2}$.",
    "Original_Problem_with_numerical_assumption": "Assumption:\nAssumption 1: $p$ is a prime number,\nAssumption 2: $p \\equiv 1 \\pmod{20}$ or $p \\equiv 9 \\pmod{20}$,\nAssumption 3: $a, b$ are integers.\nProblem: \nProve that there exist integers $a, b$ such that $p = a^{2} + 5b^{2}$.",
    "Proof_problem": "Yes",
    "Redundant_assumption": "$\\left( \\frac{-5}{p} \\right) = 1$",
    "Problem_with_redundant_assumption": "Assumption:\nAssumption 1: $p$ is a prime number,\nAssumption 2: $p \\equiv 1 \\pmod{20}$ or $p \\equiv 9 \\pmod{20}$,\nAssumption 3: $a, b$ are integers.\nAssumption 4: $\\left( \\frac{-5}{p} \\right) = 1$\nProblem: \nProve that there exist integers $a, b$ such that $p = a^{2} + 5b^{2}$."
}