{
    "Link_API": "https://api.stackexchange.com/2.3/questions/5058",
    "Title": "Formula for the harmonic series $H_n = \\sum_{k=1}^n 1/k$ due to Gregorio Fontana.",
    "Score": 23,
    "Category": "Chứng minh",
    "Tags": "sequences-and-series, harmonic-numbers",
    "Link": "https://math.stackexchange.com/questions/5058/formula-for-the-harmonic-series-h-n-sum-k-1n-1-k-due-to-gregorio-fontana",
    "Content": "My question was inspired by this stackexchange question. For the last 90 minutes I have been trying to prove this formula due to Gregorio Fontana : $$H_n = \\gamma + \\log n + {1 \\over 2n} - \\sum_{k=2}^\\infty { (k-1)! C_k \\over n(n+1)\\ldots(n+k-1)},\n\\qquad \\textrm{ for } n=1,2,3,\\ldots,$$ where $H_n = \\sum\\limits_{k=1}^n 1/k$ and the coefficients $C_k$ are the Gregory coefficients given by $${ z \\over \\log(1-z)} = \\sum_{n=0}^\\infty C_k z^k \\qquad \\textrm{ for } |z|<1.$$ It's a bit frustrating as it's something I recall proving as a student many years ago. I have a vague recollection that I began with something like: $$H_n = \\int_0^1 {1-(1-x)^n \\over x } \\textrm{d}x,$$ but my attempts to follow on from there have failed. Can you help?",
    "AcceptedAnswer": "Let's rewrite the formula, using $C_1=1/2$ as\n$$S_n=\\gamma+\\log n-H_{n-1}$$\nwhere\n$$S_n=\\sum_{k=1}^\\infty\\frac{(k-1)!C_k}{n(n+1)\\cdots(n+k-1)}.$$\nUse the formula\n$$\\frac{(k-1)!}{n(n+1)\\cdots(n+k-1)}=\\int_0^1 x^{n-1}(1-x)^{k-1}dx$$\nwhich is a special case of the beta integral.\nTherefore\n$$S_n=\\int_0^1x^{n-1}\\sum_{k=1}^\\infty C_k(1-x)^k\ndx=\\int_0^1\\left(\\frac{1}{1-x}+\\frac{1}{\\log x}\\right)x^{n-1}dx.$$\nWhen $n=1$ we get\n$$S_1=\\int_0^1\\left(\\frac{1}{1-x}+\\frac{1}{\\log x}\\right)dx=\\gamma$$\nby a well-known formula which can be derived from the aymptotic\n$$\\int_t^\\infty\\frac{e^{-x}}{x}dx=-\\log t-\\gamma+O(t)$$\nas $t\\to0$, for the exponential integral. By induction it suffices to consider the difference\n$$S_n-S_{n+1}=\\int_0^1\\left(x^{n-1}+\\frac{x^{n-1}-x^n}{\\log x}\\right)dx\n=\\frac1n-\\int_0^\\infty\\frac{e^{-ny}-e^{-(n+1)y}}{y}dy.$$\nUsing the identity\n$$\\int_0^\\infty\\frac{e^{-ay}-e^{-by}}{y}dy=\\log\\frac ba$$\nfor $0 < a < b$ \nwhich follows by integrating $e^{-xy}$ over the region $[a,b]\\times[0,\\infty)$\nwe get\n$$S_n-S_{n+1}=\\frac1n-\\log\\frac{n+1}{n}.$$\nThe desired formula for $S_n$ now follows by induction.",
    "llm_answer_create_structured_problem": "###BEGIN_OF_FORMAT###\nAssumption: \n$H_n = \\sum_{k=1}^n \\frac{1}{k}$,\nThe coefficients $C_k$ are Gregory coefficients defined by $\\frac{z}{\\log(1-z)} = \\sum_{k=0}^\\infty C_k z^k$ for $|z| < 1$,\n$H_n$ can be expressed via the integral $H_n = \\int_0^1 \\frac{1 - (1 - x)^n}{x} dx$,\nThe formula to prove is valid for $n = 1, 2, 3, \\ldots$.\nProblem:\nProve that $$H_n = \\gamma + \\log n + \\frac{1}{2n} - \\sum_{k=2}^\\infty \\frac{(k-1)! C_k}{n(n+1)\\ldots(n+k-1)},$$ where $\\gamma$ is the Euler-Mascheroni constant, and $C_k$ are Gregory coefficients.\n###END_OF_FORMAT###",
    "reasoning_create_structured_problem": "Okay, let me try to work through this problem step by step. The user wants to prove the formula for the harmonic series H_n given by Gregorio Fontana. The formula is:\n\nH_n = γ + log n + 1/(2n) - sum from k=2 to infinity of [( (k-1)! C_k ) / (n(n+1)...(n+k-1)) ]\n\nWhere H_n is the nth harmonic number, γ is the Euler-Mascheroni constant, and C_k are the Gregory coefficients, defined by the generating function z / log(1-z) = sum from k=0 to infinity of C_k z^k for |z| < 1.\n\nFirst, I need to recall some related concepts. The harmonic numbers are indeed connected to integrals, as the user mentioned starting with the integral from 0 to 1 of [1 - (1 - x)^n]/x dx. Let me verify that:\n\nH_n = sum from k=1 to n of 1/k. There's a standard integral representation: H_n = integral from 0 to 1 of (1 - x^n)/(1 - x) dx. Wait, but the user wrote [1 - (1 - x)^n]/x. Let's check if these are equivalent.\n\nWait, (1 - (1 - x)^n)/x. Let me substitute t = 1 - x. Then when x=0, t=1; x=1, t=0. The integral becomes integral from t=1 to 0 of [1 - t^n]/(1 - t) * (-dt) = integral from 0 to 1 of [1 - t^n]/(1 - t) dt, which is the standard integral for H_n. So yes, that integral is correct. Therefore, H_n = integral from 0 to 1 of [1 - (1 - x)^n]/x dx. That's a valid starting point.\n\nNow, the user wants to connect this integral to the given formula involving Gregory coefficients. The Gregory coefficients C_k are also known as the (reciprocal) logarithmic numbers, and they appear in series expansions involving logarithms. Their generating function is z / log(1 - z) = sum from k=0 to infinity C_k z^k. The first few Gregory coefficients can be found, for example, C_0 = 1, C_1 = 1/2, C_2 = -1/12, C_3 = 1/24, etc. Note that the coefficients alternate in sign after C_1.\n\nSo the formula for H_n includes a sum starting from k=2 of terms involving (k-1)! C_k divided by the product n(n+1)...(n+k-1). The challenge is to derive this from the integral representation.\n\nThe user mentioned starting with the integral but getting stuck. Let's think about expanding the integrand. The integrand is [1 - (1 - x)^n]/x. Let me consider expanding (1 - x)^n using the binomial theorem, but that might not directly help. Alternatively, perhaps expand in terms of a series involving x.\n\nWait, another approach could be to express the integral as H_n = integral from 0 to 1 [1 - (1 - x)^n]/x dx. Let me consider expanding (1 - x)^n as a binomial expansion:\n\n(1 - x)^n = sum from m=0 to n of (-1)^m C(n, m) x^m.\n\nTherefore, 1 - (1 - x)^n = sum from m=1 to n of (-1)^{m+1} C(n, m) x^m.\n\nBut dividing by x, we get sum from m=1 to n of (-1)^{m+1} C(n, m) x^{m-1}.\n\nIntegrate term by term from 0 to 1:\n\nH_n = sum from m=1 to n (-1)^{m+1} C(n, m) integral from 0 to 1 x^{m-1} dx = sum from m=1 to n (-1)^{m+1} C(n, m) / m.\n\nBut this gives H_n as a sum involving binomial coefficients and reciprocals of m. However, I'm not sure if this is helpful for connecting to the Gregory coefficients.\n\nAlternatively, perhaps consider expanding the integrand [1 - (1 - x)^n]/x as a series in x, but for the entire interval [0,1]. However, integrating term-by-term might require convergence.\n\nAlternatively, perhaps use the generating function for Gregory coefficients. Since the generating function is z / log(1 - z) = sum from k=0 to infinity C_k z^k, then maybe relate this to some integral or series expansion of H_n.\n\nWait, the formula given includes γ, the Euler-Mascheroni constant, and log n, which suggests that the expansion is related to the asymptotic expansion of H_n. Recall that H_n = γ + log n + 1/(2n) - 1/(12n^2) + ... which is the asymptotic expansion. So the given formula might be an exact expression, not just asymptotic, since it includes a sum from k=2 to infinity, which might converge for each n.\n\nAlternatively, perhaps integrating [1 - (1 - x)^n]/x by expanding (1 - x)^n as a power series and then integrating term by term, leading to an expression involving the Gregory coefficients.\n\nAnother thought: the integral H_n = ∫₀¹ [1 - (1 - x)^n]/x dx. Let's make substitution t = 1 - x, which gives H_n = ∫₀¹ [1 - t^n]/(1 - t) dt, which is the standard integral.\n\nBut how to connect this to the Gregory coefficients? Perhaps expanding 1/(1 - t) as a series? Wait, 1/(1 - t) is the generating function for t^k, sum from k=0 to infinity t^k, but this converges only for |t| < 1. However, integrating over t from 0 to 1, so at t=1, the series doesn't converge. But perhaps integrating term by term gives the divergent harmonic series, which is not helpful.\n\nAlternatively, perhaps use an expansion involving the logarithm. Since log(1/(1 - t)) = sum from k=1 to infinity t^k /k for |t| < 1, which is the Mercator series. Wait, but the generating function for Gregory coefficients is z / log(1 - z). Hmm.\n\nAlternatively, recall that the integral representation of H_n can be related to digamma function, since H_n = ψ(n + 1) + γ, where ψ is the digamma function. The digamma function has a series representation:\n\nψ(z) = ln z - 1/(2z) - sum from k=1 to infinity B_{2k}/(2k z^{2k}), where B_{2k} are Bernoulli numbers. But this seems different from the given formula involving Gregory coefficients.\n\nAlternatively, perhaps using the expansion of the integral involving Gregory coefficients. Let me think.\n\nThe generating function for Gregory coefficients is z / log(1 - z) = sum_{k=0}^∞ C_k z^k. Therefore, we can write 1 / log(1 - z) = sum_{k=0}^∞ C_k z^{k - 1}. But this might not directly help.\n\nAlternatively, consider expanding the integrand [1 - (1 - x)^n]/x as follows:\n\n[1 - (1 - x)^n]/x = sum_{k=1}^n (-1)^{k+1} C(n, k) x^{k - 1}\n\nBut integrating term by term gives sum_{k=1}^n (-1)^{k+1} C(n, k)/k. However, this sum is equal to H_n, which is a known identity. But how does this connect to the formula with Gregory coefficients?\n\nAlternatively, consider expanding (1 - x)^n as a power series and then expanding the entire integrand. But perhaps another approach is needed.\n\nWait, maybe using the concept of partial fractions or expanding 1/(n(n+1)...(n+k-1)). These terms resemble reciprocals of rising factorials. Indeed, n(n+1)...(n+k-1) = (n)_k, the Pochhammer symbol.\n\nThe term (k - 1)! C_k / (n)_k. Since the sum starts at k=2, perhaps integrating term by term after expanding in terms of a series involving 1/(n)_k.\n\nAlternatively, think about expanding [1 - (1 - x)^n]/x as an integral and then expanding in terms of a series that can be integrated to give terms involving 1/(n)_k.\n\nAlternatively, consider expanding (1 - x)^n as a power series and then interchanging the sum and integral. However, the result would be the sum_{m=1}^n (-1)^{m+1} C(n, m)/m, which is H_n, but how does that relate to the Gregory coefficients?\n\nPerhaps another approach: relate the Gregory coefficients to the coefficients in the expansion of H_n. The given formula is H_n = γ + log n + 1/(2n) - sum_{k=2}^∞ [( (k-1)! C_k ) / (n(n+1)...(n+k-1)) ]\n\nThis looks like an expansion in terms of inverse powers of n, similar to an asymptotic expansion. The terms γ + log n + 1/(2n) are part of the expansion of H_n, which is known to be H_n = γ + log n + 1/(2n) - 1/(12n^2) + 1/(120n^4) - ... etc., involving Bernoulli numbers. However, the given formula uses Gregory coefficients instead. So perhaps there is a connection between the Gregory coefficients and the Bernoulli numbers in this context.\n\nAlternatively, maybe using the integral representation and expanding the integrand in a series that can be expressed using the generating function of the Gregory coefficients.\n\nWait, another idea: the integral H_n = ∫₀¹ [1 - (1 - x)^n]/x dx. Let's make a substitution u = -log(1 - x), which transforms the integral. Then x = 1 - e^{-u}, dx = e^{-u} du. The limits become from u=0 (x=0) to u=∞ (x=1). Then the integral becomes ∫₀^∞ [1 - e^{-n u}]/(1 - e^{-u}) e^{-u} du. Simplifying the integrand:\n\n[1 - e^{-n u}]/(1 - e^{-u}) e^{-u} = [1 - e^{-n u}]/(e^{u} - 1) e^{-u} * e^{u} ?\n\nWait, let's compute step by step. The substitution gives x = 1 - e^{-u}, so 1 - x = e^{-u}, and dx = e^{-u} du.\n\nThus, the integrand becomes [1 - (e^{-u})^n]/x * dx = [1 - e^{-n u}]/(1 - e^{-u}) * e^{-u} du.\n\nSimplify the denominator: 1 - e^{-u} = e^{-u/2} (e^{u/2} - e^{-u/2}) = e^{-u/2} * 2 sinh(u/2).\n\nBut perhaps more straightforwardly:\n\n[1 - e^{-n u}]/(1 - e^{-u}) * e^{-u} = [1 - e^{-n u}] * e^{-u} / (1 - e^{-u}) = [1 - e^{-n u}] / (e^{u} - 1).\n\nBut this seems complicated. However, perhaps expand [1 - e^{-n u}]/ (e^{u} - 1) as a series.\n\nNote that 1/(e^u - 1) = sum_{k=0}^∞ B_k u^{k - 1} / k! where B_k are Bernoulli numbers, but this is the generating function for Bernoulli numbers. However, integrating term by term might lead to an expansion involving Bernoulli numbers, but the given formula uses Gregory coefficients.\n\nAlternatively, recall that the generating function for Gregory coefficients is z / log(1 - z) = sum_{k=0}^∞ C_k z^k. If we can relate this to the integral, perhaps through a different substitution or expansion.\n\nAnother idea: express the integral H_n as ∫₀¹ [1 - (1 - x)^n]/x dx. Let's consider expanding (1 - x)^n using a Taylor series around x=0. Wait, but (1 - x)^n is already a polynomial. However, integrating [1 - (1 - x)^n]/x from 0 to 1. Perhaps expanding the numerator as a power series in x and integrating term by term gives a relation to harmonic numbers.\n\nAlternatively, consider expanding [1 - (1 - x)^n]/x as a sum over k, then express each term as a series involving Gregory coefficients. This might require knowledge of the relationship between Gregory coefficients and such integrals.\n\nAlternatively, use the digamma function's series expansion. Since H_n = ψ(n + 1) + γ, and the digamma function has a series representation:\n\nψ(z) = ln z - 1/(2z) - sum_{k=1}^∞ B_{2k}/(2k z^{2k}) for z > 0.\n\nBut in the given formula, the sum is from k=2 to ∞ of terms involving (k-1)! C_k / (n(n+1)...(n+k-1)). Comparing this to the digamma expansion, perhaps there is a transformation between the Bernoulli numbers and Gregory coefficients. However, Gregory coefficients are related to the series expansion of z / log(1 - z), which is different from the generating functions of Bernoulli numbers.\n\nAlternatively, consider integrating [1 - (1 - x)^n]/x by parts. Let me try that.\n\nLet u = 1 - (1 - x)^n, dv = dx/x. Then du = n(1 - x)^{n - 1} dx, and v = log x. Then integration by parts gives:\n\nH_n = uv|₀¹ - ∫₀¹ v du = [ (1 - (1 - 1)^n) log 1 - (1 - (1 - 0)^n) log 0 ] - ∫₀¹ n (1 - x)^{n - 1} log x dx\n\nBut (1 - 0)^n = 1, so the first term becomes (1 - 1) log 1 - (1 - 1) log 0, which is 0 - 0 * (-infty). The second term is -n ∫₀¹ (1 - x)^{n - 1} log x dx. However, log x approaches -infty as x approaches 0, but the integral converges.\n\nThus, H_n = -n ∫₀¹ (1 - x)^{n - 1} log x dx.\n\nBut how does this help? Perhaps expand log x in a series. Alternatively, recall that ∫₀¹ x^{k} log x dx = -1/(k + 1)^2. But integrating (1 - x)^{n - 1} log x might relate to some expansion.\n\nAlternatively, expand (1 - x)^{n - 1} using the binomial theorem:\n\n(1 - x)^{n - 1} = sum_{m=0}^{n - 1} (-1)^m C(n - 1, m) x^m\n\nThus, the integral becomes sum_{m=0}^{n - 1} (-1)^m C(n - 1, m) ∫₀¹ x^m log x dx = sum_{m=0}^{n - 1} (-1)^m C(n - 1, m) (-1)/(m + 1)^2\n\nTherefore, H_n = -n * sum_{m=0}^{n - 1} (-1)^m C(n - 1, m) (-1)/(m + 1)^2 ) = n sum_{m=0}^{n - 1} (-1)^m C(n - 1, m) / (m + 1)^2\n\nBut I'm not sure how this connects to the Gregory coefficients. Perhaps this path is not helpful.\n\nLet me think back to the original formula. The formula is:\n\nH_n = γ + log n + 1/(2n) - sum_{k=2}^∞ [ (k - 1)! C_k / (n(n+1)...(n + k - 1)) ]\n\nThe presence of γ and log n suggests that this is related to the expansion of the digamma function, as mentioned before. The digamma function ψ(n) = H_{n-1} - γ, so ψ(n + 1) = H_n - γ. Therefore, H_n = γ + ψ(n + 1).\n\nThe digamma function has an asymptotic expansion:\n\nψ(z) ~ log z - 1/(2z) - sum_{k=1}^∞ B_{2k}/(2k z^{2k})\n\nBut the given formula has a sum from k=2 to ∞ of terms involving (k - 1)! C_k / (n)_k, where (n)_k is the Pochhammer symbol. The question is how to connect this to the digamma expansion or another expansion.\n\nAlternatively, consider the expansion of H_n using the Euler-Maclaurin formula. The Euler-Maclaurin formula connects sums to integrals and involves Bernoulli numbers. However, the given formula uses Gregory coefficients, which are different.\n\nGregory coefficients are also known as the reciprocal logarithmic numbers and appear in various series expansions related to logarithms. For instance, the expansion of 1 / log(1 + t) can be expressed using Gregory coefficients. \n\nAnother approach: consider the generating function of H_n. The generating function for harmonic numbers is sum_{n=1}^∞ H_n z^n = - log(1 - z) / (1 - z). Maybe relate this to the generating function of Gregory coefficients, which is z / log(1 - z).\n\nBut how? Let's see:\n\nsum_{n=1}^∞ H_n z^n = - log(1 - z) / (1 - z). The generating function for Gregory coefficients is z / log(1 - z) = sum_{k=0}^∞ C_k z^k.\n\nIf we multiply these two generating functions:\n\n(- log(1 - z) / (1 - z)) * (z / log(1 - z)) ) = - z / (1 - z) = sum_{n=1}^∞ (-z) z^{n-1} = - sum_{n=1}^∞ z^n. This doesn't seem helpful.\n\nAlternatively, consider the reciprocal generating function. Since z / log(1 - z) = sum_{k=0}^∞ C_k z^k, then log(1 - z) = z / sum_{k=0}^∞ C_k z^k. Not sure.\n\nAlternatively, use the integral representation of H_n and expand the integrand in terms of a series involving Gregory coefficients.\n\nWait, consider writing [1 - (1 - x)^n]/x as an integral or a series. Let's take x in (0,1), and note that (1 - x)^n = e^{n log(1 - x)}. Then, maybe expand log(1 - x) in a series.\n\nBut log(1 - x) = - sum_{m=1}^\\infty x^m / m for |x| < 1. Therefore, (1 - x)^n = e^{-n sum_{m=1}^\\infty x^m / m}. But expanding this exponential is complicated.\n\nAlternatively, use the expansion of 1 - (1 - x)^n = sum_{k=1}^\\infty (-1)^{k+1} C(n, k) x^k, but this is finite, up to k=n.\n\nAlternatively, use generating functions for the coefficients C_k. Since C_k are defined by z / log(1 - z) = sum_{k=0}^\\infty C_k z^k, then perhaps integrate term by term.\n\nWait, let's consider integrating [1 - (1 - x)^n]/x. Let me write this as integral from 0 to1 [1 - e^{n log(1 - x)}]/x dx. Perhaps expand the exponential as a power series.\n\nBut log(1 - x) = - sum_{m=1}^\\infty x^m / m. So, n log(1 - x) = -n sum_{m=1}^\\infty x^m / m. Then e^{n log(1 - x)} = e^{-n sum_{m=1}^\\infty x^m / m} = product_{m=1}^\\infty e^{-n x^m / m}. This seems too complex.\n\nAnother idea: expand [1 - (1 - x)^n]/x as a power series in x and integrate term by term. Wait, but (1 - x)^n = sum_{k=0}^n C(n, k) (-x)^k, so 1 - (1 - x)^n = - sum_{k=1}^n C(n, k) (-x)^k = sum_{k=1}^n (-1)^{k+1} C(n, k) x^k. Then divide by x to get sum_{k=1}^n (-1)^{k+1} C(n, k) x^{k - 1}. Integrate term by term from 0 to1: sum_{k=1}^n (-1)^{k+1} C(n, k) /k. This gives H_n, which is a known identity. However, this sum is finite, whereas the formula in the question has an infinite series. So perhaps need to relate this finite sum to an infinite series involving Gregory coefficients.\n\nAlternatively, consider expanding the finite sum as an infinite series using some transformation. For example, using generating functions or partial fractions.\n\nAlternatively, consider that Gregory coefficients are related to the series expansion of 1 / log(1 - z). Let me write the generating function again: sum_{k=0}^\\infty C_k z^k = z / log(1 - z). Therefore, 1 / log(1 - z) = sum_{k=0}^\\infty C_k z^{k - 1} for |z| < 1.\n\nIf we integrate this expression or relate it to the integral representation of H_n, maybe we can find a connection.\n\nWait, going back to the integral H_n = ∫₀¹ [1 - (1 - x)^n]/x dx. Let me write this as ∫₀¹ [1 - e^{n log(1 - x)}]/x dx. If we can expand this using the generating function of Gregory coefficients, which involves log(1 - z), maybe there is a way to proceed.\n\nAlternatively, consider expanding the integrand [1 - (1 - x)^n]/x as a series involving terms that can be integrated to give terms like 1/(n(n+1)...(n + k -1)).\n\nNote that 1/(n(n+1)...(n + k -1)) can be expressed as 1/( (n)_k ), where (n)_k is the Pochhammer symbol. There's an identity that 1/(n(n+1)...(n +k -1)) = 1/(k -1)! ) ∫₀¹ x^{n -1} (1 - x)^{k -1} dx, by the beta function. Let me check:\n\nThe beta function B(n, k) = ∫₀¹ x^{n -1} (1 - x)^{k -1} dx = (n -1)! (k -1)! / (n + k -1)! ). Therefore, 1/(n(n+1)...(n +k -1)) = 1/( (n)_k ) = 1/( (n +k -1)! / (n -1)! )) = (n -1)! / (n +k -1)! ). But according to beta function, B(n, k) = (n -1)! (k -1)! / (n +k -1)! ). Therefore, 1/( (n)_k ) = 1/( (n +k -1)! / (n -1)! )) = (n -1)! / (n +k -1)! ) = B(n, k) / (k -1)! )\n\nThus, 1/( (n)_k ) = B(n, k) / (k -1)! ) = [ ∫₀¹ x^{n -1} (1 -x)^{k -1} dx ] / (k -1)! )\n\nTherefore, terms in the sum in the given formula are (k -1)! C_k / (n)_k ) = C_k ∫₀¹ x^{n -1} (1 -x)^{k -1} dx.\n\nTherefore, the sum sum_{k=2}^\\infty [ (k -1)! C_k / (n)_k ] = sum_{k=2}^\\infty C_k ∫₀¹ x^{n -1} (1 -x)^{k -1} dx = ∫₀¹ x^{n -1} sum_{k=2}^\\infty C_k (1 -x)^{k -1} dx.\n\nIf we can interchange the sum and integral, then this becomes ∫₀¹ x^{n -1} sum_{k=2}^\\infty C_k (1 -x)^{k -1} dx.\n\nLet's analyze the sum sum_{k=2}^\\infty C_k (1 -x)^{k -1} = sum_{k=2}^\\infty C_k (1 -x)^{k -1} = (1 -x)^{-1} sum_{k=2}^\\infty C_k (1 -x)^k.\n\nBut the generating function for C_k is sum_{k=0}^\\infty C_k z^k = z / log(1 -z). Therefore, sum_{k=0}^\\infty C_k z^k = z / log(1 -z). Therefore, sum_{k=2}^\\infty C_k z^k = z / log(1 -z) - C_0 - C_1 z.\n\nGiven that C_0 = 1, C_1 = 1/2, so sum_{k=2}^\\infty C_k z^k = z / log(1 -z) -1 - (1/2) z.\n\nTherefore, sum_{k=2}^\\infty C_k (1 -x)^k = (1 -x) / log(1 - (1 -x)) -1 - (1/2)(1 -x) = (1 -x)/log(x) -1 - (1 -x)/2.\n\nBut log(1 - (1 -x)) = log(x). Therefore, the sum becomes:\n\n(1 -x)/log(x) -1 - (1 -x)/2.\n\nThus, the sum inside the integral is:\n\nsum_{k=2}^\\infty C_k (1 -x)^{k -1} = [ (1 -x)/log(x) -1 - (1 -x)/2 ] / (1 -x) )\n\nWait, because earlier we had sum_{k=2}^\\infty C_k (1 -x)^{k -1} = (sum_{k=2}^\\infty C_k (1 -x)^k ) / (1 -x).\n\nBut sum_{k=2}^\\infty C_k (1 -x)^k = (1 -x)/log(x) -1 - (1 -x)/2.\n\nTherefore, dividing by (1 -x), we get:\n\nsum_{k=2}^\\infty C_k (1 -x)^{k -1} = [ (1 -x)/log(x) -1 - (1 -x)/2 ] / (1 -x) = 1/log(x) - [1 + (1 -x)/2 ] / (1 -x)\n\nSimplify the second term:\n\n[1 + (1 -x)/2 ] / (1 -x) = [ (2 + 1 -x ) / 2 ] / (1 -x) = (3 -x)/[2(1 -x)].\n\nSo the sum becomes:\n\n1/log(x) - (3 -x)/[2(1 -x)].\n\nTherefore, the integral becomes:\n\n∫₀¹ x^{n -1} [ 1/log(x) - (3 -x)/(2(1 -x)) ] dx.\n\nBut this seems complicated. However, let's recall that the original sum is part of the expression for H_n:\n\nH_n = γ + log n + 1/(2n) - ∫₀¹ x^{n -1} [ 1/log(x) - (3 -x)/(2(1 -x)) ] dx.\n\nBut how does this relate to the integral representation of H_n?\n\nWait, the original integral for H_n is ∫₀¹ [1 - (1 -x)^n]/x dx. Let's relate this to the expression involving the sum.\n\nPerhaps we need to express H_n as γ + log n + 1/(2n) minus the integral involving the sum over Gregory coefficients. To connect these, maybe consider expanding H_n using its relation to the digamma function and then expanding the digamma function using an appropriate series involving Gregory coefficients.\n\nAlternatively, recall that H_n = γ + ψ(n + 1), and there might be a series expansion of ψ(n + 1) that matches the given formula.\n\nLooking up series expansions for the digamma function, I find that one such expansion is:\n\nψ(z) = log z - 1/(2z) - sum_{k=1}^\\infty B_{2k}/(2k z^{2k}),\n\nwhich is valid for large z. However, the given formula uses Gregory coefficients instead of Bernoulli numbers.\n\nAnother resource mentions that Gregory coefficients appear in the expansion of the reciprocal logarithmic function and in certain integrals related to the digamma function. There's a formula connecting Gregory coefficients to the difference between harmonic numbers and their approximation by log n + γ + 1/(2n).\n\nPerhaps the given formula is an exact expansion rather than an asymptotic one. If so, then integrating term by term and relating to the Gregory coefficients could be the way to go.\n\nGiven that the user mentioned they recall proving this as a student starting with the integral ∫₀¹ [1 - (1 -x)^n]/x dx, perhaps the next step is to expand the integrand in a way that involves the generating function of the Gregory coefficients.\n\nLet me try expanding [1 - (1 -x)^n]/x. Note that (1 -x)^n can be written as e^{n ln(1 -x)}. Then, using the generating function of Gregory coefficients which involves 1/ln(1 -x), perhaps we can express this in terms of C_k.\n\nSpecifically, since z / ln(1 - z) = sum_{k=0}^\\infty C_k z^k, then 1/ln(1 - z) = sum_{k=0}^\\infty C_k z^{k -1}. Therefore, 1/ln(1 -x) = sum_{k=0}^\\infty C_k x^{k -1}.\n\nBut integrating [1 - (1 -x)^n]/x = [1 - e^{n ln(1 -x)}]/x. Expanding e^{n ln(1 -x)} = (1 -x)^n, which is a finite sum, but perhaps expanding it as a power series and then using the generating function for Gregory coefficients.\n\nAlternatively, perhaps use the expansion:\n\n1 - (1 -x)^n = x * sum_{k=1}^\\infty a_k x^{k-1}\n\nBut this seems vague.\n\nAnother approach: let's consider that the given formula is an exact expansion of H_n. To derive it, perhaps start with the integral H_n = ∫₀¹ [1 - (1 -x)^n]/x dx and expand 1/x as a series related to the Gregory coefficients.\n\nWait, we know that 1/x = d/dx (ln x), but not directly helpful. Alternatively, express 1/x in terms of an integral or a series.\n\nAlternatively, consider that the integral H_n = ∫₀¹ [1 - (1 -x)^n]/x dx can be expressed as ∫₀¹ [1 - e^{-n (-ln(1 -x))}]/x dx. Let me substitute t = -ln(1 -x), so x = 1 - e^{-t}, dx = e^{-t} dt. The limits are from t=0 (x=0) to t=∞ (x=1). Then the integral becomes ∫₀^∞ [1 - e^{-n t}]/(1 - e^{-t}) e^{-t} dt.\n\nSimplify the integrand:\n\n[1 - e^{-n t}]/(1 - e^{-t}) e^{-t} = [1 - e^{-n t}] e^{-t} / (1 - e^{-t}) = [1 - e^{-n t}] / (e^{t} - 1).\n\nThis expression is similar to integrals that appear in the study of the Riemann zeta function or in thermal physics. Expanding [1 - e^{-n t}]/(e^{t} - 1) as a sum:\n\n[1 - e^{-n t}]/(e^{t} - 1) = sum_{k=0}^{n-1} e^{-k t}.\n\nBecause 1 - e^{-n t} = sum_{k=0}^{n-1} e^{-k t} - sum_{k=0}^{n-1} e^{-(k+1)t} = sum_{k=0}^{n-1} e^{-k t} (1 - e^{-t}) ), so dividing by (1 - e^{-t}) gives sum_{k=0}^{n-1} e^{-k t}.\n\nWait, this is a geometric series. Indeed, 1 - e^{-n t} = (1 - e^{-t}) sum_{k=0}^{n-1} e^{-k t}, so [1 - e^{-n t}]/(1 - e^{-t}) = sum_{k=0}^{n-1} e^{-k t}.\n\nTherefore, the integral becomes ∫₀^∞ sum_{k=0}^{n-1} e^{-k t} e^{-t} dt = sum_{k=0}^{n-1} ∫₀^∞ e^{-(k +1) t} dt = sum_{k=0}^{n-1} [1/(k +1)] = H_n.\n\nThis is a known representation but how does this help with the Gregory coefficients?\n\nAlternatively, perhaps consider expanding each term e^{-(k +1) t} in a series involving Gregory coefficients. However, this seems unclear.\n\nAlternatively, recall that the integral H_n = ∫₀^∞ [1 - e^{-n t}]/(e^{t} - 1) e^{-t} dt can be related to the digamma function, which has an integral representation:\n\nψ(z) = ln z - ∫₀^∞ e^{-z t}/(1 - e^{-t}) dt.\n\nBut H_n = γ + ψ(n +1), so substituting:\n\nH_n = γ + ln(n +1) - ∫₀^∞ e^{-(n +1) t}/(1 - e^{-t}) dt.\n\nBut this doesn't directly match the given formula.\n\nAlternatively, consider expanding the integral ∫₀^∞ [1 - e^{-n t}]/(e^{t} - 1) e^{-t} dt into a series. For large t, the integrand behaves like e^{-t}, and for small t, expand the exponentials.\n\nExpand [1 - e^{-n t}]/(e^{t} -1) e^{-t} for small t:\n\nUsing Taylor series for small t:\n\ne^{t} ≈ 1 + t + t^2/2 + t^3/6 + ...,\n\nso e^{t} -1 ≈ t + t^2/2 + t^3/6 + ...,\n\n1/(e^{t} -1) ≈ 1/t - 1/2 + t/12 - t^3/720 + ... (this is the expansion of 1/(e^t -1), which is related to Bernoulli numbers).\n\nMultiply by [1 - e^{-n t}]e^{-t} ≈ [1 - (1 -n t + n^2 t^2/2 - ...)]e^{-t} ≈ [n t - n^2 t^2/2 + ...][1 - t + t^2/2 - ...] ≈ n t - (n + n^2/2) t^2 + ... .\n\nMultiplying by the expansion of 1/(e^t -1) ≈ 1/t - 1/2 + t/12 - ... gives:\n\n[n t - ... ] * [1/t - 1/2 + ... ] ≈ n - n/2 t + ... .\n\nBut integrating term by term from 0 to ∞ would require handling the integral's behavior at both limits, which is non-trivial. The original integral converges, but expanding in this way might not capture the entire behavior.\n\nPerhaps another approach is needed. Let's consider the given formula again:\n\nH_n = γ + log n + 1/(2n) - sum_{k=2}^\\infty [ (k -1)! C_k / (n(n+1)...(n +k -1)) ]\n\nAssuming this formula is correct, how can we derive it from the integral H_n = ∫₀¹ [1 - (1 -x)^n]/x dx?\n\nLet's consider expanding the integrand [1 - (1 -x)^n]/x in a series that can be integrated term by term to yield the desired formula.\n\nWe can write [1 - (1 -x)^n]/x = ∫₀¹ [1 - (1 -x)^n]/x dx.\n\nLet me consider the expansion of (1 -x)^n using the binomial theorem:\n\n(1 -x)^n = sum_{m=0}^n (-1)^m C(n, m) x^m.\n\nSo, 1 - (1 -x)^n = sum_{m=1}^n (-1)^{m+1} C(n, m) x^m.\n\nDivided by x: sum_{m=1}^n (-1)^{m+1} C(n, m) x^{m-1}.\n\nIntegrate term by term from 0 to1: sum_{m=1}^n (-1)^{m+1} C(n, m)/m. This sum equals H_n.\n\nBut how to relate this sum to Gregory coefficients? Let's recall that Gregory coefficients C_k appear in the expansion of z / log(1 -z) = sum_{k=0}^\\infty C_k z^k. Perhaps express the sum in terms of residues or another method involving generating functions.\n\nAlternatively, use generating functions to relate the sum sum_{m=1}^n (-1)^{m+1} C(n, m)/m to the Gregory coefficients.\n\nLet me consider the generating function for sum_{m=1}^\\infty (-1)^{m+1} C(n, m) z^m/m.\n\nSum_{m=1}^\\infty (-1)^{m+1} C(n, m) z^m/m = integrate from 0 to z sum_{m=1}^\\infty (-1)^{m+1} C(n, m) t^{m-1} dt.\n\nBut sum_{m=1}^\\infty (-1)^{m+1} C(n, m) t^{m-1} = [sum_{m=1}^\\infty (-1)^{m+1} C(n, m) t^{m}]/t = [ (1 - (1 - t)^n ) ]/t.\n\nTherefore, the generating function becomes ∫₀^z [ (1 - (1 - t)^n ) ]/t dt = H_n when z=1. But how does this connect to Gregory coefficients?\n\nAlternatively, use the integral representation H_n = ∫₀¹ [1 - (1 -x)^n]/x dx and expand 1/x as a power series in x, but this seems redundant.\n\nAlternatively, expand (1 -x)^n using the Gregory coefficients. Since Gregory coefficients are related to the expansion of 1/log(1 -z), perhaps there is a way to express (1 -x)^n in terms of an integral or series involving Gregory coefficients.\n\nAnother thought: express H_n as γ + log n + 1/(2n) - ... and relate the remainder terms to the sum involving Gregory coefficients. Perhaps using the expansion of the digamma function and relating it to the Gregory coefficients.\n\nAlternatively, consider integrating [1 - (1 -x)^n]/x by expanding in terms of asymptotic series for large n, but the formula given is exact for all n.\n\nPerhaps the key is to relate the integral H_n to the Gregory coefficients via their generating function. Let's try substituting the generating function into the integral.\n\nGiven that sum_{k=0}^\\infty C_k z^k = z / log(1 - z), then log(1 - z) = z / sum_{k=0}^\\infty C_k z^k.\n\nBut how to use this in the integral H_n = ∫₀¹ [1 - (1 -x)^n]/x dx.\n\nWait, let's express [1 - (1 -x)^n]/x as an integral. For example, note that [1 - (1 -x)^n] = ∫₀^x n(1 - t)^{n -1} dt. Therefore, [1 - (1 -x)^n]/x = ∫₀^x n(1 - t)^{n -1} dt /x.\n\nThus, H_n = ∫₀¹ [ ∫₀^x n(1 - t)^{n -1} dt /x ] dx = ∫₀¹ ∫₀^x n(1 - t)^{n -1} /x dt dx.\n\nSwap the order of integration: H_n = ∫₀¹ ∫_t^1 n(1 - t)^{n -1} /x dx dt = ∫₀¹ n(1 - t)^{n -1} ∫_t^1 1/x dx dt = ∫₀¹ n(1 - t)^{n -1} (-log t) dt.\n\nThis brings us back to the earlier expression H_n = -n ∫₀¹ (1 -t)^{n -1} log t dt.\n\nNow, expand log t in a series. Recall that log t = ∫_1^t 1/x dx. Not sure.\n\nAlternatively, use the series expansion of log t around t=1. Let u = 1 - t, then log(1 - u) = - sum_{k=1}^\\infty u^k /k for |u| <1.\n\nThus, log t = log(1 - u) = - sum_{k=1}^\\infty u^k /k = - sum_{k=1}^\\infty (1 - t)^k /k.\n\nSubstitute into the integral:\n\nH_n = -n ∫₀¹ (1 -t)^{n -1} [ - sum_{k=1}^\\infty (1 - t)^k /k ] dt = n ∫₀¹ sum_{k=1}^\\infty (1 - t)^{n +k -1} /k dt.\n\nInterchange sum and integral:\n\nH_n = n sum_{k=1}^\\infty [ ∫₀¹ (1 -t)^{n +k -1} dt /k ] = n sum_{k=1}^\\infty [ B(1, n +k ) /k ] = n sum_{k=1}^\\infty [ 1/(n +k) /k ].\n\nBut B(1, n +k ) = ∫₀¹ (1 -t)^{n +k -1} dt = 1/(n +k). Therefore,\n\nH_n = n sum_{k=1}^\\infty 1/(k(n +k)).\n\nThis sum can be written as sum_{k=1}^\\infty 1/(k(n +k)) = sum_{k=1}^\\infty 1/(n k) (1/(1 +k/n)) = 1/n sum_{k=1}^\\infty 1/(k (1 +k/n)).\n\nThis resembles a Riemann sum but perhaps can be related to the digamma function. However, it's unclear how to connect this to Gregory coefficients.\n\nAlternatively, express 1/(k(n +k)) = 1/n (1/k - 1/(n +k)), so sum_{k=1}^\\infty 1/(k(n +k)) = 1/n sum_{k=1}^\\infty (1/k - 1/(n +k)) ) = 1/n [ H_∞ - (H_∞ - H_n) ] = 1/n H_n.\n\nBut this leads to H_n = n * (1/n H_n ) = H_n, which is a tautology. Therefore, this approach isn't helpful.\n\nPerhaps another idea: use the integral representation of 1/(n +k) = ∫₀¹ t^{n +k -1} dt. Then,\n\nsum_{k=1}^\\infty 1/(k(n +k)) = sum_{k=1}^\\infty ∫₀¹ t^{n +k -1} dt /k = ∫₀¹ t^{n -1} sum_{k=1}^\\infty t^k /k dt = ∫₀¹ t^{n -1} (-log(1 -t)) dt.\n\nThus, H_n = n ∫₀¹ t^{n -1} (-log(1 -t)) dt.\n\nBut we also have H_n = γ + log n + 1/(2n) - sum_{k=2}^\\infty [ (k-1)! C_k / (n(n+1)...(n +k -1)) ].\n\nComparing the two expressions for H_n:\n\nγ + log n + 1/(2n) - sum_{k=2}^\\infty [ (k-1)! C_k / (n)_k ] = n ∫₀¹ t^{n -1} (-log(1 -t)) dt.\n\nThus, we need to show that:\n\nn ∫₀¹ t^{n -1} (-log(1 -t)) dt = γ + log n + 1/(2n) - sum_{k=2}^\\infty [ (k-1)! C_k / (n)_k ].\n\nTo proceed, expand -log(1 -t) using its generating function. We know that -log(1 -t) = sum_{m=1}^\\infty t^m /m for |t| <1.\n\nThus, the integral becomes n ∫₀¹ t^{n -1} sum_{m=1}^\\infty t^m /m dt = n sum_{m=1}^\\infty ∫₀¹ t^{n +m -1} /m dt = n sum_{m=1}^\\infty 1/(m(n +m)).\n\nBut this is the same as the earlier expression. So this approach brings us back.\n\nAlternatively, use the generating function of Gregory coefficients in the integral. Let me write -log(1 -t) = sum_{m=1}^\\infty t^m/m, and we have the generating function for Gregory coefficients as sum_{k=0}^\\infty C_k z^k = z / log(1 -z).\n\nBut how to relate these two?\n\nNote that from the generating function:\n\nsum_{k=0}^\\infty C_k z^k = z / log(1 -z) => log(1 -z) = z / sum_{k=0}^\\infty C_k z^k.\n\nBut then, -log(1 -z) = - z / sum_{k=0}^\\infty C_k z^k.\n\nExpressing this as a power series might allow us to relate the integral to the Gregory coefficients.\n\nLet me attempt to write:\n\nsum_{m=1}^\\infty t^m/m = -log(1 -t) = t / sum_{k=0}^\\infty C_k t^k.\n\nThen, sum_{m=1}^\\infty t^m/m = t / (C_0 + C_1 t + C_2 t^2 + ...).\n\nGiven that C_0 =1, C_1 =1/2, C_2 =-1/12, etc.\n\nThus, 1 / (sum_{k=0}^\\infty C_k t^k) = (sum_{m=1}^\\infty t^m/m )^{-1} * t.\n\nBut this seems complicated. Alternatively, express the reciprocal of the series:\n\nsum_{k=0}^\\infty C_k t^k = t / sum_{m=1}^\\infty t^m/m.\n\nTherefore,\n\nsum_{k=0}^\\infty C_k t^k = t / ( -log(1 -t) ).\n\nBut this is the original generating function.\n\nPerhaps use a series reversion or other techniques to express the coefficients C_k in terms of the coefficients of log(1 -t).\n\nAlternatively, use the fact that the generating function of C_k is the exponential generating function for some combinatorial structure, but I'm not sure.\n\nAnother approach: consider expanding the integral n ∫₀¹ t^{n -1} (-log(1 -t)) dt using integration by parts. Let u = -log(1 -t), dv = n t^{n -1} dt. Then du = 1/(1 -t) dt, v = t^n. Thus,\n\nIntegration by parts gives uv|₀¹ - ∫₀¹ v du = [ -log(1 -1) *1^n - (-log(1 -0) *0^n ) ] - ∫₀¹ t^n * 1/(1 -t) dt.\n\nThe first term is 0 - 0 = 0. The integral becomes - ∫₀¹ t^n/(1 -t) dt.\n\nBut t^n/(1 -t) = -t^n sum_{k=0}^\\infty t^k for |t| <1. Integrating from 0 to1:\n\n- ∫₀¹ - sum_{k=0}^\\infty t^{n +k} dt = sum_{k=0}^\\infty ∫₀¹ t^{n +k} dt = sum_{k=0}^\\infty 1/(n +k +1) = sum_{m=n +1}^\\infty 1/m = H_∞ - H_n.\n\nBut H_∞ diverges, which suggests that this approach is invalid. However, we know that H_n = γ + log n + 1/(2n) - ... via the asymptotic expansion, which converges for large n. But the original problem states the formula is exact for n=1,2,3,..., so there must be an exact expression involving the convergent sum.\n\nGiven the time I've spent and the various approaches I've tried without success, I think it's time to look for a different strategy, possibly referencing known expansions involving Gregory coefficients.\n\nUpon researching, I find that the formula in question is indeed related to an expansion of the harmonic numbers using Gregory coefficients. The key lies in the generating function of the Gregory coefficients and their relation to the reciprocals of logarithmic functions.\n\nHere's a step-by-step explanation:\n\n1. Start with the integral representation of H_n:\n   H_n = ∫₀¹ [1 - (1 -x)^n]/x dx.\n\n2. Expand [1 - (1 -x)^n]/x using the generating function of Gregory coefficients. Recall that z / log(1 -z) = sum_{k=0}^∞ C_k z^k.\n\n3. Use the substitution z =1 - x to relate the integral to the generating function.\n\n4. Expand the integrand in",
    "Original_Problem": "Assumption: \n$H_n = \\sum_{k=1}^n \\frac{1}{k}$,\nThe coefficients $C_k$ are Gregory coefficients defined by $\\frac{z}{\\log(1-z)} = \\sum_{k=0}^\\infty C_k z^k$ for $|z| < 1$,\n$H_n$ can be expressed via the integral $H_n = \\int_0^1 \\frac{1 - (1 - x)^n}{x} dx$,\nThe formula to prove is valid for $n = 1, 2, 3, \\ldots$.\nProblem:\nProve that $$H_n = \\gamma + \\log n + \\frac{1}{2n} - \\sum_{k=2}^\\infty \\frac{(k-1)! C_k}{n(n+1)\\ldots(n+k-1)},$$ where $\\gamma$ is the Euler-Mascheroni constant, and $C_k$ are Gregory coefficients.",
    "Original_Problem_with_numerical_assumption": "Assumption:\nAssumption 1: $H_n = \\sum_{k=1}^n \\frac{1}{k}$,\nAssumption 2: The coefficients $C_k$ are Gregory coefficients defined by $\\frac{z}{\\log(1-z)} = \\sum_{k=0}^\\infty C_k z^k$ for $|z| < 1$,\nAssumption 3: $H_n$ can be expressed via the integral $H_n = \\int_0^1 \\frac{1 - (1 - x)^n}{x} dx$,\nAssumption 4: The formula to prove is valid for $n = 1, 2, 3, \\ldots$.\nProblem:\nProve that $$H_n = \\gamma + \\log n + \\frac{1}{2n} - \\sum_{k=2}^\\infty \\frac{(k-1)! C_k}{n(n+1)\\ldots(n+k-1)},$$ where $\\gamma$ is the Euler-Mascheroni constant, and $C_k$ are Gregory coefficients.",
    "Proof_problem": "Yes",
    "Redundant_assumption": "$$S_1=\\int_0^1\\left(\\frac{1}{1-x}+\\frac{1}{\\log x}\\right)dx=\\gamma$$",
    "Problem_with_redundant_assumption": "Assumption:\nAssumption 1: $H_n = \\sum_{k=1}^n \\frac{1}{k}$,\nAssumption 2: The coefficients $C_k$ are Gregory coefficients defined by $\\frac{z}{\\log(1-z)} = \\sum_{k=0}^\\infty C_k z^k$ for $|z| < 1$,\nAssumption 3: $H_n$ can be expressed via the integral $H_n = \\int_0^1 \\frac{1 - (1 - x)^n}{x} dx$,\nAssumption 4: The formula to prove is valid for $n = 1, 2, 3, \\ldots$.\nAssumption 5: $$S_1=\\int_0^1\\left(\\frac{1}{1-x}+\\frac{1}{\\log x}\\right)dx=\\gamma$$\nProblem:\nProve that $$H_n = \\gamma + \\log n + \\frac{1}{2n} - \\sum_{k=2}^\\infty \\frac{(k-1)! C_k}{n(n+1)\\ldots(n+k-1)},$$ where $\\gamma$ is the Euler-Mascheroni constant, and $C_k$ are Gregory coefficients."
}