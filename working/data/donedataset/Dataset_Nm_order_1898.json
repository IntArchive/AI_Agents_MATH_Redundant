{
    "Link_API": "https://api.stackexchange.com/2.3/questions/1320363",
    "Title": "Orthogonal Projection of $ z $ onto the Affine set $ \\left\\{ x \\mid A x = b \\right\\} $",
    "Score": 17,
    "Category": "Chá»©ng minh",
    "Tags": "linear-algebra, convex-optimization, inner-products, least-squares",
    "Link": "https://math.stackexchange.com/questions/1320363/orthogonal-projection-of-z-onto-the-affine-set-left-x-mid-a-x-b-rig",
    "Content": "Suppose $A$ is fat (number of columns > number of rows) and full row rank . The projection of $z$ onto $\\{x\\mid Ax = b\\}$ is (affine) $$P(z) = z - A^T(AA^T)^{-1}(Az-b)$$ How to show this? Note:  $A^T(AA^T)^{-1}$ is the pseudo-inverse of $A$ What I am thinking is from: Least square problem:  $$\\text{min $\\left\\|\\: Ax-b \\,\\right\\|_2$}$$ The solution for this is $\\hat{x} = A^T(AA^T)^{-1}b$. It seems $(Az - b )$ above is the role of $b$ here. Vector projection of $x$ onto $y$:    $$p = \\frac{x^Ty}{y^Ty}y$$ But I still cannot figure out how to prove the above result.",
    "AcceptedAnswer": "The projection of $z$ onto the set $\\{x:\\  Ax=b\\}$ is given by the solution of\n$$\n\\min \\frac12\\|x-z\\|^2 \\quad \\text{ subject to } Ax=b.\n$$\nThe KKT system is a necessary (since constraints are linear) and sufficient (since this is a convex problem):\n$$\nAx=b, \\quad x-z +A^T\\lambda = 0.\n$$\nMultiply the second equation by $A$, solve for $\\lambda$: $\\lambda=(AA^T)^{-1}(Az-b)$, plug this again into the second equation to obtain\n$$\nx = z - A^T\\lambda =z-A^T (AA^T)^{-1}(Az-b)\n$$",
    "llm_answer_create_structured_problem": "###BEGIN_OF_FORMAT###\nAssumption: \n$A$ is a fat matrix (number of columns > number of rows),\n$A$ has full row rank.\nProblem: \nShow that the orthogonal projection of $z$ onto the affine set $\\{x \\mid A x = b\\}$ is $$P(z) = z - A^T(AA^T)^{-1}(Az - b).$$\n###",
    "reasoning_create_structured_problem": "Okay, so I need to structure this problem according to the given format. Let me read through the original question carefully.\n\nThe user is asking about the orthogonal projection of a vector z onto the affine set {x | Ax = b}. They provided the formula for P(z) and mentioned that A is a fat matrix (more columns than rows) and full row rank. They also connected it to the least squares problem and the pseudo-inverse. \n\nFirst, I need to list all the assumptions. The problem states that A is fat, which means the number of columns is greater than the number of rows. Also, A has full row rank, meaning all its rows are linearly independent. The affine set is defined by Ax = b. The projection P(z) is given as z - A^T(AA^T)^{-1}(Az - b). \n\nSo the assumptions should be each on a separate line, each addressing one property of an object. Let's break them down:\n\n1. A is a fat matrix (columns > rows).\n2. A has full row rank.\n3. The set {x | Ax = b} is affine.\n4. The projection is orthogonal.\n\nWait, but the problem is to show that P(z) as given is the orthogonal projection. So maybe some of these are part of the problem statement rather than assumptions. Wait, the original problem says \"Suppose A is fat and full row rank. The projection of z onto {x | Ax = b} is (affine) P(z) = ... How to show this?\" So the assumptions here are that A is fat, full row rank, and we need to prove that P(z) is the orthogonal projection. So the affine set is given by Ax = b, which is part of the problem statement. \n\nSo the assumptions would be:\n\n- A is a matrix with more columns than rows (fat).\n- A has full row rank.\n- The set {x | Ax = b} is non-empty (since it's affine and projection exists).\n- The projection is orthogonal (since we're dealing with Euclidean projection).\n\nWait, but maybe some of these are given. Let me check again. The user states \"Suppose A is fat (number of columns > number of rows) and full row rank.\" So those are the two main assumptions. The problem is to show that the projection P(z) is given by that formula. The affine set is part of the problem, not an assumption. \n\nSo the Assumption section should list each condition. So:\n\nAssumption:\nA is a fat matrix (number of columns > number of rows),\nA has full row rank.\n\nProblem: Show that the orthogonal projection of z onto the affine set {x | Ax = b} is given by P(z) = z - A^T(AA^T)^{-1}(Az - b).\n\nWait, the original problem says \"How to show this?\" So the problem is to prove that the projection is as given. So I need to structure that. The example provided earlier had assumptions like n is an integer and n divisible by 7, but in this case, the assumptions are about A's properties. \n\nTherefore, the correct Assumption lines are:\n\nA is a fat matrix (number of columns > number of rows),\nA has full row rank.\n\nThe problem is to show the projection formula. The rest, like the affine set {x | Ax = b}, is part of the problem statement. \n\nI should also check if the affine set is non-empty. However, since A has full row rank, Ax = b is consistent (because full row rank implies that the system Ax = b has at least one solution for any b, right? Wait, no. Full row rank means that the rows are linearly independent, so if A is m x n with m < n and rank m, then Ax = b is consistent for any b in R^m. So maybe that's an implicit assumption here. But the user didn't mention that. So maybe the assumptions are just about A's properties.\n\nTherefore, the formatted problem should be:\n\nAssumption:\nA is a fat matrix (number of columns > number of rows),\nA has full row rank.\n\nProblem: Show that the orthogonal projection of z onto the affine set {x | Ax = b} is given by P(z) = z - A^T(AA^T)^{-1}(Az - b).\n\nWait, but in the example, the assumption included conditions on n. Here, the conditions are on A. Each assumption is a single line. So \"A is a fat matrix...\" and \"A has full row rank\" are two separate assumptions.\n\nYes, that seems right.",
    "Original_Problem": "Assumption: \n$A$ is a fat matrix (number of columns > number of rows),\n$A$ has full row rank.\nProblem: \nShow that the orthogonal projection of $z$ onto the affine set $\\{x \\mid A x = b\\}$ is $$P(z) = z - A^T(AA^T)^{-1}(Az - b).$$",
    "Original_Problem_with_numerical_assumption": "Assumption:\nAssumption 1: $A$ is a fat matrix (number of columns > number of rows),\nAssumption 2: $A$ has full row rank.\nProblem: \nShow that the orthogonal projection of $z$ onto the affine set $\\{x \\mid A x = b\\}$ is $$P(z) = z - A^T(AA^T)^{-1}(Az - b).$$",
    "Proof_problem": "Yes",
    "Redundant_assumption": "$$\nx = z - A^T\\lambda =z-A^T (AA^T)^{-1}(Az-b)\n$$",
    "Problem_with_redundant_assumption": "Assumption:\nAssumption 1: $A$ is a fat matrix (number of columns > number of rows),\nAssumption 2: $A$ has full row rank.\nAssumption 3: $$\nx = z - A^T\\lambda =z-A^T (AA^T)^{-1}(Az-b)\n$$\nProblem: \nShow that the orthogonal projection of $z$ onto the affine set $\\{x \\mid A x = b\\}$ is $$P(z) = z - A^T(AA^T)^{-1}(Az - b).$$"
}